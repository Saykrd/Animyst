{"version":3,"sources":["animyst.min.js","Animyst.ts","_core/Application.ts","_core/AppScope.ts","_core/AppState.ts","_core/Database.ts","_core/DataLoad.ts","_core/Environment.ts","_core/Item.ts","_core/Log.ts","_core/SignalBinding.ts","_core/Signal.ts","_core/System.ts","_core/Window.ts","audio/Sound.ts","display/PIXITexture.ts","display/SpriteSheetTexture.ts","display/View3D.ts","input/Input.ts","input/InputData.ts","spritesheet/SpriteSheetAnimation.ts","spritesheet/SpriteSheetData.ts","states/CoreProcess.ts","utils/ArrayUtil.ts","utils/MathUtil.ts","utils/ObjectUtil.ts"],"names":["__extends","this","extendStatics","Object","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","Animyst","LOGGING","DEBUG","MAJOR","MINOR","BUILD","DATA","VERSION","Application","argument","_lastFrame","_framerate","_framecount","_timestep","runtime","_appStateList","_appStateLib","appScope","AppScope","initSignal","Signal","defineProperty","get","enumerable","configurable","set","v","startup","params","_this","Log","output","Environment","browserName","browserVersion","platformName","_startParams","DataLoad","loadAsset","id","src","type","evt","onLoading","FILE_LOADED","item","config","getAsset","loadFromManifest","assets","strings","listAssets","manifest","initialLoad","LOAD_COMPLETE","init","settings","logging","debug","window","isCocoonJS","_stats","domElement","style","position","left","top","document","body","appendChild","GUI","coreprocess","CoreProcess","ID","run","timestep","setInterval","fixedUpdate","onFrame","frameUpdate","bind","initFrame","dispatch","requestAnimationFrame","appState","push","setScope","framerate","setup","start","halt","appStateID","pause","resume","end","kill","i","length","state","splice","endAll","k","event","delta","time","Date","now","begin","update","databases","addDatabase","database","getDatabase","AppState","_systemList","_systemLib","_id","clearScope","active","stop","system","shutdown","framecount","paused","started","restart","addSystem","getSystem","console","error","Database","_itemCount","_items","_itemList","_categoryLists","_categoryChecks","signal","addCategory","name","check","cls","context","traverse","list","hasCategory","data","call","ArrayUtil","include","unlist","itemID","remove","getItemsInCategory","category","items","getItem","isInCategory","indexOf","command","ADDED","REMOVED","removeAll","clear","destroy","_loadQueue","createjs","LoadQueue","_loadSignal","queue","on","handleFileLoaded","handleLoadComplete","handleFileError","handleLoaderError","handleFileStart","handleLoadInitialize","handleLoadStart","handleFileProgress","handleOverallProgress","_fileStartedSignal","_fileProgressSignal","_fileLoadedSignal","_fileErrorSignal","_queueStartedSignal","_queueProgressSignal","_queueLoadedSignal","_queueErrorSignal","assetList","_assetList","value","loadHandler","persistant","addLoadHandler","_busy","loadManifest","loadFile","getResult","getData","handler","_weakHandlers","add","removeLoadHandler","h","removeWeakHandlers","handlers","shift","addCommand","commandID","addOnce","LOAD_STARTED","FILE_STARTED","LOAD_PROGRESS","FILE_PROGRESS","LOAD_ERROR","FILE_ERROR","removeCommand","loadSignal","LOAD_INITIALIZE","handlersToRemove","concat","_setup","_checkBrowser","_checkPlatform","_checkDevice","userAgent","navigator","test","isLinux","isAndroid","isChromeOS","isIOS","isMacOS","isWindows","isDesktop","isWebApp","isMobile","pixelRatio","devicePixelRatio","colorDepth","screen","screenWidth","width","screenHeight","height","isSafari","substring","isChrome","isFirefox","isIE","isEdge","url","location","href","queryString","search","host","hostname","path","pathname","port","details","split","browserDetails","major","parseInt","minor","build","revision","getURLParameterByName","escapeSpaces","match","RegExp","exec","decodeURIComponent","replace","Item","startParams","reset","args","_i","arguments","logData","log","apply","SignalBinding","listener","isOnce","listenerContext","priority","_listener","_isOnce","_signal","execute","paramsArr","handlerReturn","detach","isBound","getListener","getSignal","_destroy","toString","_bindings","_prevParams","memorize","_shouldPropagate","validateListener","fnName","Error","_registerListener","binding","prevIndex","_indexOfListener","_addBinding","n","cur","has","getNumListeners","bindings","slice","forget","dispose","System","_paused","_started","_startupParams","Window","orientation","innerWidth","innerHeight","documentElement","clientWidth","clientHeight","_onResize","resizeSignal","_onWindowLoad","addEventListener","Sound","PIXITexture","_super","stage","renderer","view","_init","image","graphics","PIXI","Graphics","lineStyle","beginFill","drawCircle","endFill","texture","Texture","fromCanvas","sprite","Sprite","addChild","invalidate","shouldUpdate","render","needsUpdate","THREE","SpriteSheetTexture","atlas","playTime","currentFrame","currentFrameID","renderWidth","renderHeight","sourceFile","timePassed","addSheet","_initSprite","startFrame","Container","autoDetectRenderer","transparent","fromFrame","frames","frame","w","showFrame","thisFrame","setTexture","play","loop","playing","animate","Math","round","View3D","initDisplay","viewAngle","near","far","_resize","resize","_scene","Scene","_renderer","WebGLRenderer","_camera","PerspectiveCamera","aspect","lookAt","container","getElementById","x","cameraX","y","cameraY","z","cameraZ","setClearColor","rendererColor","setSize","addAxis","axis","AxisHelper","debugControls","OrbitControls","displayControls","addFolder","c_folder","listen","onResize","_view","createElement","_context2d","getContext","append","containerID","Input","inputData","element","tool","keyboardSettings","onKeyUp","onKeyDown","onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onTouchStart","onTouchMove","onTouchRelease","onTouchEnter","onTouchLeave","onMouseEnter","onMouseLeave","onTick","handleTouchInput","TOUCH_START","TOUCH_MOVE","TOUCH_RELEASE","TOUCH_ENTER","TOUCH_LEAVE","onClick","handleMouseInput","MOUSE_CLICK","MOUSE_DOWN","MOUSE_DRAG","MOUSE_MOVE","MOUSE_UP","MOUSE_ENTER","MOUSE_LEAVE","key","InputData","KEY_NAMES","keyCode","allowDefault","preventDefault","handleKeyInput","KEY_UP","KEY_CODES","KEY_DOWN","down","setMouseInput","setKeyInput","addTouches","changedTouches","removeTouches","touches","updateTouches","map","touchHistory","mouse","mouseHistory","totalTouchCount","__KEY_NAMES","ObjectUtil","invert","clickTime","touchData","isKeyDown","keyName","evtType","KEY_ACTIVE","lastInput","endTime","duration","startTime","KEY_INACTIVE","KEY","lastClick","clickStart","MOUSE_PROPERTIES","MOUSE","getTouches","touch","isNew","j","identifier","startData","TOUCH_PROPERTIES","timestamp","uid","TOUCH","TOUCH_ADDED","isGone","unshift","TOUCH_HISTORY_LIMIT","pop","TOUCH_REMOVED","pageX","pageY","screenX","screenY","force","webkitForce","TOUCH_UPDATED","backspace","tab","enter","ctrl","alt","capslock","numlock","esc","pageup","pagedown","home","leftarrow","uparrow","rightarrow","downarrow","insert","delete","0","1","2","3","4","5","6","7","8","9","a","c","e","f","g","l","m","o","q","r","s","t","u","numpad0","numpad1","numpad2","numpad3","numpad4","numpad5","numpad6","numpad7","numpad8","numpad9","multiply","plus","minus","dot","divide","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","=",",",".","/","backslash",";","'","[","]","-","space","~","SpriteSheetAnimation","animations","spritesheets","sheetData","getSheet","sheetID","addAnimation","prefix","anim","spritesheet","useFrames","getFrames","currentFrameIndex","totalFrames","repeat","elapsed","getAnimation","currentAnim","setIdle","SpriteSheetData","parse","addFrame","frameID","FrameData","getFrame","framePrefix","ctx","sort","_sortCaseInsensitive","toLowerCase","rotated","trimmed","spriteSourceSize","sourceSize","pivot","_inputData","input","keyboard","INPUT","property","array","obj","searchAll","index","startIndex","inc","MathUtil","loopSum","max","min","result","abs","constrain","findClosestDivisable","divisor","findNextDivisable","interpolate","percent","object","copy","target","isArray"],"mappings":"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","file":"animyst.min.js","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar Animyst;\n(function (Animyst) {\n    Animyst.LOGGING = true;\n    Animyst.DEBUG = true;\n    Animyst.MAJOR = 0;\n    Animyst.MINOR = 0;\n    Animyst.BUILD = 0;\n    Animyst.DATA = \"\";\n    Animyst.VERSION = Animyst.MAJOR + \".\" + Animyst.MINOR + \".\" + Animyst.BUILD;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Application = (function () {\n        function Application(argument) {\n            this._lastFrame = 0;\n            this._framerate = 60;\n            this._framecount = 0;\n            this._timestep = 1000 / this._framerate;\n            this.runtime = 0;\n            this._appStateList = [];\n            this._appStateLib = {};\n            this.appScope = new Animyst.AppScope();\n            this.initSignal = new Animyst.Signal();\n        }\n        Object.defineProperty(Application.prototype, \"framerate\", {\n            get: function () { return this._framerate; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Application.prototype, \"framecount\", {\n            get: function () { return this._framecount; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Application.prototype, \"timestep\", {\n            get: function () { return this._timestep; },\n            set: function (v) { this._timestep = v; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        ;\n        Application.prototype.startup = function (params) {\n            var _this = this;\n            Animyst.Log.output(\"===================================================\");\n            Animyst.Log.output(\"   ----- AnimystJS: (v \" + Animyst.VERSION + \") by ~Saykrd -----   \");\n            Animyst.Log.output(\"===================================================\");\n            Animyst.Log.output(\"Browser:\", Animyst.Environment.browserName);\n            Animyst.Log.output(\"Version:\", Animyst.Environment.browserVersion);\n            Animyst.Log.output(\"Platform:\", Animyst.Environment.platformName);\n            Animyst.Log.output(\"===================================================\");\n            this._startParams = params;\n            // Load all configuration files and and assets first\n            Animyst.DataLoad.startup({});\n            Animyst.DataLoad.loadAsset({ \"id\": \"config\", \"src\": \"config.json\" }, function (type, evt) { return _this.onLoading(type, evt); });\n        };\n        Application.prototype.onLoading = function (type, evt) {\n            if (type == Animyst.DataLoad.FILE_LOADED) {\n                switch (evt.item.id) {\n                    case \"config\":\n                        Animyst.Log.output(\"[Application] Config json loaded\");\n                        this.config = Animyst.DataLoad.getAsset(\"config\");\n                        this.appScope.config = this.config;\n                        Animyst.DataLoad.loadFromManifest([\n                            { \"id\": \"assets\", \"src\": this.config.assets },\n                            { \"id\": \"strings\", \"src\": this.config.strings }\n                        ]);\n                        break;\n                    case \"assets\":\n                        Animyst.Log.output(\"[Application] Assets json loaded\");\n                        var assets = Animyst.DataLoad.getAsset(\"assets\");\n                        Animyst.DataLoad.listAssets(assets.manifest);\n                        //Log.output(DataLoad._assetList);\n                        if (assets.initialLoad) {\n                            Animyst.DataLoad.loadFromManifest(assets.initialLoad);\n                        }\n                        break;\n                    case \"strings\":\n                        Animyst.Log.output(\"[Application] Strings json loaded\");\n                        break;\n                }\n            }\n            else if (type == Animyst.DataLoad.LOAD_COMPLETE) {\n                //DataLoad.removeLoadHandler(this._load);\n                this.init();\n            }\n        };\n        Application.prototype.init = function () {\n            var _this = this;\n            var params = this._startParams;\n            Animyst.LOGGING = this.config.settings.logging || Animyst.LOGGING;\n            Animyst.DEBUG = this.config.settings.debug || Animyst.DEBUG;\n            //window[\"Paper\"] = {};\n            //paper.install(window[\"Paper\"]);\n            Animyst.Log.output(\"[Application] Application Started\");\n            if (this.config.settings.debug) {\n                if (window[\"Stats\"] && !Animyst.Environment.isCocoonJS) {\n                    this._stats = new window[\"Stats\"]();\n                    this._stats.domElement.style.position = 'absolute';\n                    this._stats.domElement.style.left = '0px';\n                    this._stats.domElement.style.top = '0px';\n                    document.body.appendChild(this._stats.domElement);\n                    Animyst.Log.output(\"[Application] Stats Enabled\");\n                }\n                if (window[\"dat\"] && !Animyst.Environment.isCocoonJS) {\n                    Animyst.GUI = new window[\"dat\"].GUI();\n                }\n            }\n            var coreprocess = new Animyst.CoreProcess(Animyst.CoreProcess.ID);\n            this.run(coreprocess);\n            this.timestep = this.config.settings.timestep || this.timestep;\n            setInterval(function () { return _this.fixedUpdate; }, this.timestep);\n            if (window[\"view\"]) {\n                window[\"view\"].onFrame = this.frameUpdate.bind(this);\n            }\n            else {\n                this.initFrame();\n            }\n            this.initSignal.dispatch();\n        };\n        Application.prototype.initFrame = function () {\n            var _this = this;\n            requestAnimationFrame(function () { return _this.initFrame(); });\n            this.frameUpdate();\n        };\n        Application.prototype.run = function (appState) {\n            if (!this._appStateLib[appState.id]) {\n                this._appStateLib[appState.id] = appState;\n                this._appStateList.push(appState);\n                appState.setScope(this.appScope);\n                appState.framerate = this.framerate;\n                appState.timestep = this.timestep;\n                appState.setup();\n                appState.start();\n            }\n        };\n        Application.prototype.halt = function (appStateID) {\n            if (!this._appStateLib[appStateID]) {\n                this._appStateLib[appStateID].pause();\n            }\n        };\n        Application.prototype.resume = function (appStateID) {\n            if (!this._appStateLib[appStateID]) {\n                this._appStateLib[appStateID].resume();\n            }\n        };\n        Application.prototype.end = function (appStateID) {\n            if (!this._appStateLib[appStateID]) {\n                var appState = this._appStateLib[appStateID];\n                appState.kill();\n                this._appStateLib[appState.id] = null;\n                for (var i = 0; i < this._appStateList.length; i++) {\n                    var state = this._appStateList[i];\n                    if (state.id == appState.id) {\n                        this._appStateList.splice(i, 1);\n                        break;\n                    }\n                }\n            }\n        };\n        Application.prototype.endAll = function () {\n            for (var k in this._appStateLib) {\n                this.end(k);\n            }\n        };\n        Application.prototype.fixedUpdate = function () {\n            this.runtime += this.timestep;\n            for (var i = 0; i < this._appStateList.length; i++) {\n                var state = this._appStateList[i];\n                state.fixedUpdate(this.timestep, this.runtime);\n            }\n        };\n        Application.prototype.frameUpdate = function (event) {\n            // Calculate time intervals\n            var delta = 0;\n            var time = 0;\n            if (event) {\n                delta = event.delta;\n                time = event.time;\n            }\n            else {\n                time = Date.now();\n                delta = time - (this._lastFrame || Date.now());\n                this._lastFrame = time;\n            }\n            if (this._stats) {\n                this._stats.begin();\n            }\n            for (var i = 0; i < this._appStateList.length; i++) {\n                var state = this._appStateList[i];\n                state.update(delta, this._framecount);\n            }\n            this._framecount++;\n            if (this._stats) {\n                this._stats.end();\n            }\n        };\n        return Application;\n    }());\n    Animyst.Application = Application;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var AppScope = (function () {\n        function AppScope() {\n            this.databases = {};\n            // code...\n        }\n        AppScope.prototype.addDatabase = function (id, database) {\n            this.databases[id] = database;\n        };\n        AppScope.prototype.getDatabase = function (id) {\n            return this.databases[id];\n        };\n        return AppScope;\n    }());\n    Animyst.AppScope = AppScope;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var AppState = (function () {\n        function AppState(id) {\n            this._systemList = [];\n            this._systemLib = [];\n            this._framerate = 60;\n            this._timestep = 1000 / this.framerate;\n            this._id = id;\n        }\n        Object.defineProperty(AppState.prototype, \"id\", {\n            get: function () { return this._id; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(AppState.prototype, \"framerate\", {\n            get: function () { return this._framerate; },\n            set: function (v) { this._framerate = v; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        ;\n        Object.defineProperty(AppState.prototype, \"timestep\", {\n            get: function () { return this._timestep; },\n            set: function (v) { this._timestep = v; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        ;\n        AppState.prototype.setScope = function (appScope) {\n            this.appScope = appScope;\n        };\n        AppState.prototype.clearScope = function () {\n            this.appScope = null;\n        };\n        AppState.prototype.setup = function () {\n        };\n        AppState.prototype.start = function () {\n            this.active = true;\n        };\n        AppState.prototype.stop = function () {\n            this.active = false;\n            for (var i = 0; i < this._systemList.length; i++) {\n                var system = this._systemList[i];\n                system.shutdown();\n            }\n        };\n        AppState.prototype.update = function (delta, framecount) {\n            //console.log(\"[AppState] Updating...\", this);\n            if (this.active && !this.paused) {\n                for (var i = 0; i < this._systemList.length; i++) {\n                    var system = this._systemList[i];\n                    if (system.started && !system.paused) {\n                        system.update(delta, framecount);\n                    }\n                }\n            }\n        };\n        AppState.prototype.fixedUpdate = function (timestep, time) {\n            //console.log(\"[AppState] Updating...\", this);\n            if (this.active && !this.paused) {\n                for (var i = 0; i < this._systemList.length; i++) {\n                    var system = this._systemList[i];\n                    if (system.started && !system.paused) {\n                        system.fixedUpdate(timestep, time);\n                    }\n                }\n            }\n        };\n        AppState.prototype.pause = function () {\n            this.paused = true;\n        };\n        AppState.prototype.resume = function () {\n            this.paused = false;\n        };\n        AppState.prototype.kill = function () {\n            this.stop();\n            this.clearScope();\n            this._systemList = null;\n            this._systemLib = null;\n        };\n        AppState.prototype.restart = function () {\n        };\n        AppState.prototype.addSystem = function (id, system) {\n            if (!this._systemList[id]) {\n                this._systemLib[id] = system;\n                this._systemList.push(system);\n            }\n        };\n        AppState.prototype.getSystem = function (id) {\n            if (!this._systemList[id]) {\n                return this._systemLib[id];\n            }\n            console.error(\"[AppState] !! No system found with ID: \" + id);\n        };\n        return AppState;\n    }());\n    Animyst.AppState = AppState;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Database = (function () {\n        function Database() {\n            this._itemCount = 0;\n            this._items = {};\n            this._itemList = [];\n            this._categoryLists = {};\n            this._categoryChecks = {};\n            this.signal = new Animyst.Signal();\n            // code...\n        }\n        /**\n         * Adds an item category list to keep track of specific items\n         * @param {string} name    Name of category\n         * @param {function} check   A function evaluating the item. Ex: \"function (item) { if(shouldBeInList) return true; return false}\"\n         * @param {class} cls     The class type the item should belong to\n         * @param {ctx} context The 'this' variable to be used with the check\n         */\n        Database.prototype.addCategory = function (name, check, cls, context) {\n            this._categoryLists[name] = [];\n            this._categoryChecks[name] = { check: check, context: context, cls: cls };\n            this.traverse(this.list, this);\n        };\n        ;\n        /**\n         * Checks if a category exists\n         * @param {string} name [description]\n         */\n        Database.prototype.hasCategory = function (name) {\n            return this._categoryLists[name] != null;\n        };\n        ;\n        /**\n         * Adds item into all category lists that it belongs to\n         * @param {Item} item [description]\n         */\n        Database.prototype.list = function (item) {\n            for (var k in this._categoryLists) {\n                var data = this._categoryChecks[k];\n                if (item instanceof data.cls && data.check.call(data.context, item)) {\n                    Animyst.ArrayUtil.include(item.id, this._categoryLists[k]);\n                }\n            }\n        };\n        ;\n        /**\n         * Removes item from all categories\n         * @param {string} itemID [description]\n         */\n        Database.prototype.unlist = function (itemID) {\n            for (var k in this._categoryLists) {\n                for (var i = 0; i < this._categoryLists[k].length; i++) {\n                    Animyst.ArrayUtil.remove(itemID, this._categoryLists[k]);\n                }\n            }\n        };\n        ;\n        /**\n         * Returns the list of item ID's in a given category\n         * @param {string} category [description]\n         */\n        Database.prototype.getItemsInCategory = function (category) {\n            var items = this._categoryLists[category] || [];\n            for (var i = items.length - 1; i >= 0 && items.length > 0; i--) {\n                var item = this.getItem(items[i]);\n                if (!item) {\n                    items.splice(i, 1);\n                }\n            }\n            return items;\n        };\n        ;\n        /**\n         * Evaluates whether an item is listed in a specific category\n         * @param  {string}  itemID   [description]\n         * @param  {string}  category [description]\n         */\n        Database.prototype.isInCategory = function (itemID, category) {\n            var list = this._categoryLists[category];\n            return list.indexOf(itemID) > -1;\n        };\n        ;\n        /**\n         * Traverses a category of items or all items in this database and executes a command on all of them\n         * @param  {function} command  Command to execute on all items (\"function(item){//...}\")\n         * @param  {object} context  'this' variable for the command\n         * @param  {string} category Category to traverse. Traverses entire database if no category is specified\n         */\n        Database.prototype.traverse = function (command, context, category) {\n            if (category === void 0) { category = null; }\n            var list = this._categoryLists[category] || this._itemList;\n            for (var i = 0; i < list.length; i++) {\n                var item = this.getItem(list[i]);\n                if (item) {\n                    command.call(context, item);\n                }\n                else {\n                    list.splice(i, 1);\n                    i--;\n                    continue;\n                }\n            }\n        };\n        ;\n        /**\n         * Creates an item and adds it to the database\n         * @param {object} cls   Class of the item\n         * @param {string} id     Item ID\n         * @param {object} params Params to initialize the item\n         * @return {object} Returns the item that was added\n         */\n        Database.prototype.create = function (cls, id, params) {\n            if (!id) {\n                id = \"item\" + this._itemCount;\n            }\n            if (this._items[id]) {\n                id = id + this._itemCount;\n            }\n            var item = new cls(id, params);\n            item.id = id;\n            this._items[id] = item;\n            this._itemList.push(item.id);\n            this.list(item);\n            this._itemCount++;\n            item.signal = this.signal;\n            this.signal.dispatch(Database.ADDED, item.id);\n            return item;\n        };\n        ;\n        /**\n         * Removes item from database\n         * @param {string} itemID [description]\n         */\n        Database.prototype.remove = function (itemID) {\n            if (!this._items[itemID])\n                return;\n            var item = this.getItem(itemID);\n            this.unlist(itemID);\n            delete this._items[itemID];\n            this.signal.dispatch(Database.REMOVED, itemID);\n        };\n        ;\n        /**\n         * Removes all items in database\n         */\n        Database.prototype.removeAll = function () {\n            this.traverse(function (item) { this.remove(item.id); }, this);\n        };\n        ;\n        /**\n         * Returns item in database\n         * @param {string} itemID [description]\n         */\n        Database.prototype.getItem = function (itemID) {\n            return this._items[itemID];\n        };\n        ;\n        Database.prototype.clear = function () {\n        };\n        Database.prototype.destroy = function () {\n        };\n        return Database;\n    }());\n    Database.ADDED = 'added';\n    Database.REMOVED = 'removed';\n    Animyst.Database = Database;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var DataLoad = (function () {\n        function DataLoad(argument) {\n            // code...\n        }\n        DataLoad.startup = function (params) {\n            DataLoad._loadQueue = new createjs.LoadQueue(true);\n            DataLoad._loadSignal = new Animyst.Signal();\n            var queue = DataLoad._loadQueue;\n            queue.on(\"fileload\", DataLoad.handleFileLoaded);\n            queue.on(\"complete\", DataLoad.handleLoadComplete);\n            queue.on(\"fileerror\", DataLoad.handleFileError);\n            queue.on(\"error\", DataLoad.handleLoaderError);\n            queue.on(\"filestart\", DataLoad.handleFileStart);\n            queue.on(\"initialize\", DataLoad.handleLoadInitialize);\n            queue.on(\"loadstart\", DataLoad.handleLoadStart);\n            queue.on(\"fileprogress\", DataLoad.handleFileProgress);\n            queue.on(\"progress\", DataLoad.handleOverallProgress);\n            DataLoad._fileStartedSignal = new Animyst.Signal();\n            ;\n            DataLoad._fileProgressSignal = new Animyst.Signal();\n            ;\n            DataLoad._fileLoadedSignal = new Animyst.Signal();\n            ;\n            DataLoad._fileErrorSignal = new Animyst.Signal();\n            ;\n            DataLoad._queueStartedSignal = new Animyst.Signal();\n            ;\n            DataLoad._queueProgressSignal = new Animyst.Signal();\n            ;\n            DataLoad._queueLoadedSignal = new Animyst.Signal();\n            ;\n            DataLoad._queueErrorSignal = new Animyst.Signal();\n            ;\n            if (params.manifest != null) {\n                //DataLoad.loadManifest(params.manifest, params.callback)\n            }\n        };\n        DataLoad.listAssets = function (manifest) {\n            var assetList = DataLoad._assetList;\n            for (var i = 0; i < manifest.length; i++) {\n                var item = manifest[i];\n                assetList[item.id] = item;\n            }\n        };\n        DataLoad.loadFromManifest = function (value, loadHandler, persistant) {\n            if (persistant === void 0) { persistant = false; }\n            var queue = DataLoad._loadQueue;\n            var manifest = [];\n            for (var i = 0; i < value.length; i++) {\n                var v = value[i];\n                var item;\n                if (typeof v == \"string\") {\n                    item = { \"id\": v, \"src\": v };\n                }\n                else {\n                    item = { \"id\": v.id, \"src\": v.src };\n                }\n                if (!DataLoad._assetList[item.id]) {\n                    DataLoad._assetList[item.id] = item;\n                }\n                manifest.push(DataLoad._assetList[item.id]);\n            }\n            DataLoad.addLoadHandler(loadHandler, persistant);\n            DataLoad._busy = true;\n            queue.loadManifest(manifest);\n        };\n        DataLoad.loadAsset = function (value, loadHandler, persistant) {\n            if (persistant === void 0) { persistant = false; }\n            var queue = DataLoad._loadQueue;\n            var item;\n            if (typeof value == \"string\") {\n                item = { \"id\": value, \"src\": value };\n            }\n            else {\n                item = { \"id\": value.id, \"src\": value.src };\n            }\n            if (!DataLoad._assetList[item.id]) {\n                DataLoad._assetList[item.id] = item;\n            }\n            DataLoad.addLoadHandler(loadHandler, persistant);\n            DataLoad._busy = true;\n            queue.loadFile(DataLoad._assetList[item.id]);\n        };\n        DataLoad.getAsset = function (id) {\n            return DataLoad._loadQueue.getResult(id);\n        };\n        DataLoad.getData = function (id) {\n            return DataLoad._assetList[id];\n        };\n        //=========== HANDLER MANAGEMENT =========\n        DataLoad.addLoadHandler = function (handler, persistant) {\n            if (persistant === void 0) { persistant = false; }\n            if (!handler)\n                return;\n            if (!persistant) {\n                DataLoad._weakHandlers.push(handler);\n            }\n            DataLoad._loadSignal.add(handler);\n        };\n        DataLoad.removeLoadHandler = function (handler) {\n            for (var i = DataLoad._weakHandlers.length - 1; i >= 0 && DataLoad._weakHandlers.length > 0; i--) {\n                var h = DataLoad._weakHandlers[i];\n                if (h == handler) {\n                    DataLoad._weakHandlers.splice(i, 1);\n                    break;\n                }\n            }\n            DataLoad._loadSignal.remove(handler);\n        };\n        DataLoad.removeWeakHandlers = function (handlers) {\n            var loadSignal = DataLoad._loadSignal;\n            while (handlers.length > 0) {\n                var handler = handlers.shift();\n                DataLoad.removeLoadHandler(handler);\n            }\n        };\n        DataLoad.addCommand = function (commandID, command, addOnce) {\n            if (addOnce === void 0) { addOnce = false; }\n            var signal;\n            switch (commandID) {\n                case DataLoad.LOAD_STARTED:\n                    signal = DataLoad._queueStartedSignal;\n                    break;\n                case DataLoad.FILE_STARTED:\n                    signal = DataLoad._fileStartedSignal;\n                    break;\n                case DataLoad.LOAD_PROGRESS:\n                    signal = DataLoad._queueProgressSignal;\n                    break;\n                case DataLoad.FILE_PROGRESS:\n                    signal = DataLoad._fileProgressSignal;\n                    break;\n                case DataLoad.LOAD_COMPLETE:\n                    signal = DataLoad._queueLoadedSignal;\n                    break;\n                case DataLoad.FILE_LOADED:\n                    signal = DataLoad._fileLoadedSignal;\n                    break;\n                case DataLoad.LOAD_ERROR:\n                    signal = DataLoad._queueErrorSignal;\n                    break;\n                case DataLoad.FILE_ERROR:\n                    signal = DataLoad._fileErrorSignal;\n                    break;\n            }\n            if (addOnce) {\n                signal.addOnce(command);\n            }\n            else {\n                signal.add(command);\n            }\n        };\n        DataLoad.removeCommand = function (commandID, command) {\n            var signal;\n            switch (commandID) {\n                case DataLoad.LOAD_STARTED:\n                    signal = DataLoad._queueStartedSignal;\n                    break;\n                case DataLoad.FILE_STARTED:\n                    signal = DataLoad._fileStartedSignal;\n                    break;\n                case DataLoad.LOAD_PROGRESS:\n                    signal = DataLoad._queueProgressSignal;\n                    break;\n                case DataLoad.FILE_PROGRESS:\n                    signal = DataLoad._fileProgressSignal;\n                    break;\n                case DataLoad.LOAD_COMPLETE:\n                    signal = DataLoad._queueLoadedSignal;\n                    break;\n                case DataLoad.FILE_LOADED:\n                    signal = DataLoad._fileLoadedSignal;\n                    break;\n                case DataLoad.LOAD_ERROR:\n                    signal = DataLoad._queueErrorSignal;\n                    break;\n                case DataLoad.FILE_ERROR:\n                    signal = DataLoad._fileErrorSignal;\n                    break;\n            }\n            signal.remove(command);\n        };\n        //=========== LOAD EVENTS =========\n        DataLoad.handleLoadInitialize = function (event) {\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.LOAD_INITIALIZE, event);\n        };\n        DataLoad.handleLoadStart = function (event) {\n            Animyst.Log.output(\"[DataLoad] Load Started!\");\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.LOAD_STARTED, event);\n            DataLoad._queueStartedSignal.dispatch(event);\n        };\n        DataLoad.handleFileStart = function (event) {\n            Animyst.Log.output(\"[DataLoad] Loading File:\", event.item.id, \"from:\", event.item.src);\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.FILE_STARTED, event);\n            DataLoad._fileStartedSignal.dispatch(event);\n        };\n        DataLoad.handleFileLoaded = function (event) {\n            Animyst.Log.output(\"[DataLoad] File Loaded:\", event.item.id, \"from:\", event.item.src);\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.FILE_LOADED, event);\n            DataLoad._fileLoadedSignal.dispatch(event);\n        };\n        DataLoad.handleLoadComplete = function (event) {\n            Animyst.Log.output(\"[DataLoad] Load Completed!\");\n            var loadSignal = DataLoad._loadSignal;\n            var handlersToRemove = DataLoad._weakHandlers.concat();\n            loadSignal.dispatch(DataLoad.LOAD_COMPLETE, event);\n            DataLoad._queueLoadedSignal.dispatch(event);\n            DataLoad.removeWeakHandlers(handlersToRemove);\n        };\n        DataLoad.handleFileProgress = function (event) {\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.FILE_PROGRESS, event);\n            DataLoad._fileProgressSignal.dispatch(event);\n        };\n        DataLoad.handleOverallProgress = function (event) {\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.LOAD_PROGRESS, event);\n            DataLoad._queueProgressSignal.dispatch(event);\n        };\n        DataLoad.handleFileError = function (event) {\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.FILE_ERROR, event);\n            DataLoad._fileErrorSignal.dispatch(event);\n        };\n        DataLoad.handleLoaderError = function (event) {\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.LOAD_ERROR, event);\n            DataLoad._queueErrorSignal.dispatch(event);\n        };\n        return DataLoad;\n    }());\n    DataLoad.LOAD_INITIALIZE = 0;\n    DataLoad.LOAD_STARTED = 1;\n    DataLoad.LOAD_PROGRESS = 2;\n    DataLoad.LOAD_COMPLETE = 3;\n    DataLoad.LOAD_ERROR = 4;\n    DataLoad.FILE_STARTED = 5;\n    DataLoad.FILE_PROGRESS = 6;\n    DataLoad.FILE_LOADED = 7;\n    DataLoad.FILE_ERROR = 9;\n    DataLoad._assetList = {};\n    DataLoad._weakHandlers = []; // List of handlers to remove once the load is completed\n    DataLoad._loadQueue = null; // CreateJS load queue\n    DataLoad._loadSignal = null;\n    DataLoad._fileStartedSignal = null;\n    DataLoad._fileProgressSignal = null;\n    DataLoad._fileLoadedSignal = null;\n    DataLoad._fileErrorSignal = null;\n    DataLoad._queueStartedSignal = null;\n    DataLoad._queueProgressSignal = null;\n    DataLoad._queueLoadedSignal = null;\n    DataLoad._queueErrorSignal = null;\n    DataLoad._busy = false;\n    Animyst.DataLoad = DataLoad;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Environment = (function () {\n        function Environment(argument) {\n            // code...\n        }\n        //========================================\n        Environment._setup = function () {\n            Environment._checkBrowser();\n            Environment._checkPlatform();\n            Environment._checkDevice();\n        };\n        Environment._checkPlatform = function () {\n            var userAgent = navigator.userAgent;\n            if (/Linux/.test(userAgent)) {\n                Environment.platformName = \"Linux\";\n                Environment.isLinux = true;\n            }\n            if (/Android/.test(userAgent)) {\n                Environment.platformName = \"Android\";\n                Environment.isAndroid = true;\n            }\n            if (/CrOS/.test(userAgent)) {\n                Environment.platformName = \"ChromeOS\";\n                Environment.isChromeOS = true;\n            }\n            if (/iP[ao]d|iPhone/i.test(userAgent)) {\n                Environment.platformName = \"iOS\";\n                Environment.isIOS = true;\n            }\n            if (/Mac OS/.test(userAgent)) {\n                Environment.platformName = \"Mac\";\n                Environment.isMacOS = true;\n            }\n            if (/Windows/.test(userAgent)) {\n                Environment.platformName = \"Windows\";\n                Environment.isWindows = true;\n            }\n            if (Environment.isWindows || Environment.isMacOS || Environment.isLinux) {\n                Environment.isDesktop = true;\n            }\n            if (Environment.isAndroid || Environment.isIOS || Environment.isWebApp) {\n                Environment.isMobile = true;\n            }\n        };\n        Environment._checkDevice = function () {\n            Environment.pixelRatio = window.devicePixelRatio || 1;\n            Environment.colorDepth = window.screen.colorDepth;\n            if (Environment.isMobile) {\n                Environment.screenWidth = window.screen.width * Environment.pixelRatio;\n                Environment.screenHeight = window.screen.height * Environment.pixelRatio;\n            }\n            else {\n                Environment.screenWidth = window.screen.width;\n                Environment.screenHeight = window.screen.height;\n            }\n        };\n        Environment._checkBrowser = function () {\n            var userAgent = navigator.userAgent;\n            if (/Safari/.test(userAgent)) {\n                Environment.browserName = \"Safari\";\n                Environment.isSafari = true;\n                Environment.browserVersion = (userAgent.indexOf(\"Version\") != -1) ? userAgent.substring(userAgent.indexOf(\"Version\") + 8) : userAgent.substring(userAgent.indexOf(\"Safari\") + 7);\n            }\n            if (/Mobile(.*)Safari/.test(userAgent)) {\n                Environment.browserName = \"MobileSafari\";\n                Environment.isSafari = true;\n                Environment.browserVersion = (userAgent.indexOf(\"Version\") != -1) ? userAgent.substring(userAgent.indexOf(\"Version\") + 8) : userAgent.substring(userAgent.indexOf(\"Safari\") + 7);\n            }\n            if (/Chrome/.test(userAgent)) {\n                Environment.browserName = \"Chrome\";\n                Environment.isChrome = true;\n                Environment.browserVersion = userAgent.substring(userAgent.indexOf(\"Chrome\") + 7, userAgent.indexOf(\" Safari\") || null);\n            }\n            if (/Firefox/.test(userAgent)) {\n                Environment.browserName = \"Firefox\";\n                Environment.isFirefox = true;\n                Environment.browserVersion = userAgent.substring(userAgent.indexOf(\"Firefox\") + 8);\n            }\n            if (/MSIE (\\d+\\.\\d+);/.test(userAgent)) {\n                Environment.browserName = \"MSIE\";\n                Environment.isIE = true;\n                Environment.browserVersion = userAgent.substring(userAgent.indexOf(\"MSIE\") + 5);\n            }\n            if (/Edge/.test(userAgent)) {\n                Environment.browserName = \"MSEdge\";\n                Environment.isEdge = true;\n                Environment.browserVersion = userAgent.substring(userAgent.indexOf(\"Edge\") + 5);\n            }\n            if (navigator['standalone']) {\n                Environment.browserName = \"WebApp\";\n                Environment.isWebApp = true;\n            }\n            if (navigator['isCocoonJS']) {\n                Environment.browserName = \"CocoonJS\";\n                Environment.isCocoonJS = true;\n            }\n            Environment.url = window.location.href;\n            Environment.queryString = window.location.search;\n            Environment.host = window.location.hostname;\n            Environment.path = window.location.pathname;\n            Environment.port = window.location.port;\n            var details = Environment.browserVersion.split(\".\");\n            switch (details.length) {\n                case 1:\n                    Environment.browserDetails.major = parseInt(details[0]);\n                    break;\n                case 2:\n                    Environment.browserDetails.major = parseInt(details[0]);\n                    Environment.browserDetails.minor = parseInt(details[1]);\n                    break;\n                case 3:\n                    Environment.browserDetails.major = parseInt(details[0]);\n                    Environment.browserDetails.minor = parseInt(details[1]);\n                    Environment.browserDetails.build = parseInt(details[2]);\n                    break;\n                case 4:\n                    Environment.browserDetails.major = parseInt(details[0]);\n                    Environment.browserDetails.minor = parseInt(details[1]);\n                    Environment.browserDetails.build = parseInt(details[2]);\n                    Environment.browserDetails.revision = parseInt(details[3]);\n                    break;\n            }\n        };\n        Environment.getURLParameterByName = function (name, escapeSpaces) {\n            if (escapeSpaces === void 0) { escapeSpaces = false; }\n            if (escapeSpaces === null)\n                escapeSpaces = true;\n            var match = new RegExp('[?&]' + name + '=([^&]*)').exec(Environment.queryString);\n            return (escapeSpaces) ? match && decodeURIComponent(match[1].replace(/\\/+/g, '')) : match && decodeURIComponent(match[1]);\n        };\n        return Environment;\n    }());\n    //========================================\n    //------------- Platform -----------------\n    //========================================\n    Environment.isDesktop = false;\n    Environment.isMobile = false;\n    Environment.isIOS = false;\n    Environment.isAndroid = false;\n    Environment.isChromeOS = false;\n    Environment.isMacOS = false;\n    Environment.isWindows = false;\n    Environment.isLinux = false;\n    Environment.platformName = \"\";\n    //========================================\n    //------------- Device -------------------\n    //========================================\n    Environment.pixelRatio = 1;\n    Environment.colorDepth = -1;\n    Environment.screenWidth = -1;\n    Environment.screenHeight = -1;\n    //========================================\n    //------------- Browser ------------------\n    //========================================\n    Environment.isChrome = false;\n    Environment.isFirefox = false;\n    Environment.isIE = false;\n    Environment.isEdge = false;\n    Environment.isSafari = false;\n    Environment.isWebApp = false;\n    Environment.isCocoonJS = false;\n    Environment.browserVersion = \"\";\n    Environment.browserName = \"\";\n    Environment.browserDetails = {};\n    Environment.url = \"\";\n    Environment.host = \"\";\n    Environment.path = \"\";\n    Environment.port = \"\";\n    Environment.queryString = \"\";\n    Animyst.Environment = Environment;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Item = (function () {\n        function Item(id, params) {\n            // code...\n            this.id = id;\n            this.startParams = params;\n            this.setup(params);\n        }\n        Item.prototype.setup = function (params) {\n        };\n        Item.prototype.reset = function () {\n            this.setup(this.startParams);\n        };\n        Item.prototype.destroy = function () {\n            this.startParams = null;\n        };\n        return Item;\n    }());\n    Animyst.Item = Item;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Log = (function () {\n        function Log() {\n        }\n        Log.output = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            if (!Animyst.LOGGING)\n                return;\n            var logData = [];\n            logData.push(\":[LOG]:\");\n            for (var i = 0; i < args.length; i++) {\n                logData.push(args[i]);\n            }\n            console.log.apply(console, logData);\n        };\n        Log.error = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            if (!Animyst.LOGGING)\n                return;\n            var logData = [];\n            logData.push(\":[ERROR]:\");\n            for (var i = 0; i < args.length; i++) {\n                logData.push(args[i]);\n            }\n            console.error.apply(console, logData);\n        };\n        return Log;\n    }());\n    Animyst.Log = Log;\n})(Animyst || (Animyst = {}));\n/// <reference path=\"Signal.ts\" />\n/*\n*\t@desc   \tAn object that represents a binding between a Signal and a listener function.\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.kiwijs.org\n*\n*/\nvar Animyst;\n/// <reference path=\"Signal.ts\" />\n/*\n*\t@desc   \tAn object that represents a binding between a Signal and a listener function.\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.kiwijs.org\n*\n*/\n(function (Animyst) {\n    var SignalBinding = (function () {\n        /**\n        * Object that represents a binding between a Signal and a listener function.\n        * <br />- <strong>This is an internal constructor and shouldn't be called by regular users.</strong>\n        * <br />- inspired by Joa Ebert AS3 SignalBinding and Robert Penner's Slot classes.\n        * @author Miller Medeiros\n        * @constructor\n        * @internal\n        * @name SignalBinding\n        * @param {Signal} signal Reference to Signal object that listener is currently bound to.\n        * @param {Function} listener Handler function bound to the signal.\n        * @param {boolean} isOnce If binding should be executed just once.\n        * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n        * @param {Number} [priority] The priority level of the event listener. (default = 0).\n        */\n        function SignalBinding(signal, listener, isOnce, listenerContext, priority) {\n            if (priority === void 0) { priority = 0; }\n            /**\n            * If binding is active and should be executed.\n            * @type boolean\n            */\n            this.active = true;\n            /**\n            * Default parameters passed to listener during `Signal.dispatch` and `SignalBinding.execute`. (curried parameters)\n            * @type Array|null\n            */\n            this.params = null;\n            this._listener = listener;\n            this._isOnce = isOnce;\n            this.context = listenerContext;\n            this._signal = signal;\n            this.priority = priority || 0;\n        }\n        /**\n        * Call listener passing arbitrary parameters.\n        * <p>If binding was added using `Signal.addOnce()` it will be automatically removed from signal dispatch queue, this method is used internally for the signal dispatch.</p>\n        * @param {Array} [paramsArr] Array of parameters that should be passed to the listener\n        * @return {*} Value returned by the listener.\n        */\n        SignalBinding.prototype.execute = function (paramsArr) {\n            var handlerReturn;\n            var params;\n            if (this.active && !!this._listener) {\n                params = this.params ? this.params.concat(paramsArr) : paramsArr;\n                handlerReturn = this._listener.apply(this.context, params);\n                if (this._isOnce) {\n                    this.detach();\n                }\n            }\n            return handlerReturn;\n        };\n        /**\n        * Detach binding from signal.\n        * - alias to:mySignal.remove(myBinding.getListener());\n        * @return {Function|null} Handler function bound to the signal or `null` if binding was previously detached.\n        */\n        SignalBinding.prototype.detach = function () {\n            return this.isBound() ? this._signal.remove(this._listener, this.context) : null;\n        };\n        /**\n        * @return {Boolean} `true` if binding is still bound to the signal and have a listener.\n        */\n        SignalBinding.prototype.isBound = function () {\n            return (!!this._signal && !!this._listener);\n        };\n        /**\n        * @return {boolean} If SignalBinding will only be executed once.\n        */\n        SignalBinding.prototype.isOnce = function () {\n            return this._isOnce;\n        };\n        /**\n        * @return {Function} Handler function bound to the signal.\n        */\n        SignalBinding.prototype.getListener = function () {\n            return this._listener;\n        };\n        /**\n        * @return {Signal} Signal that listener is currently bound to.\n        */\n        SignalBinding.prototype.getSignal = function () {\n            return this._signal;\n        };\n        /**\n        * Delete instance properties\n        * @private\n        */\n        SignalBinding.prototype._destroy = function () {\n            delete this._signal;\n            delete this._listener;\n            delete this.context;\n        };\n        /**\n        * @return {string} String representation of the object.\n        */\n        SignalBinding.prototype.toString = function () {\n            return '[SignalBinding isOnce:' + this._isOnce + ', isBound:' + this.isBound() + ', active:' + this.active + ']';\n        };\n        return SignalBinding;\n    }());\n    Animyst.SignalBinding = SignalBinding;\n})(Animyst || (Animyst = {}));\n/// <reference path=\"SignalBinding.ts\" />\n/**\n*\t@desc       A TypeScript conversion of JS Signals by Miller Medeiros\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.photonstorm.com\n*/\n/**\n* Custom event broadcaster\n* <br />- inspired by Robert Penner's AS3 Signals.\n* @name Signal\n* @author Miller Medeiros\n* @constructor\n*/\nvar Animyst;\n/// <reference path=\"SignalBinding.ts\" />\n/**\n*\t@desc       A TypeScript conversion of JS Signals by Miller Medeiros\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.photonstorm.com\n*/\n/**\n* Custom event broadcaster\n* <br />- inspired by Robert Penner's AS3 Signals.\n* @name Signal\n* @author Miller Medeiros\n* @constructor\n*/\n(function (Animyst) {\n    var Signal = (function () {\n        function Signal() {\n            /**\n            * @property _bindings\n            * @type Array\n            * @private\n            */\n            this._bindings = [];\n            /**\n            * @property _prevParams\n            * @type Any\n            * @private\n            */\n            this._prevParams = null;\n            /**\n            * If Signal should keep record of previously dispatched parameters and\n            * automatically execute listener during `add()`/`addOnce()` if Signal was\n            * already dispatched before.\n            * @type boolean\n            */\n            this.memorize = false;\n            /**\n            * @type boolean\n            * @private\n            */\n            this._shouldPropagate = true;\n            /**\n            * If Signal is active and should broadcast events.\n            * <p><strong>IMPORTANT:</strong> Setting this property during a dispatch will only affect the next dispatch, if you want to stop the propagation of a signal use `halt()` instead.</p>\n            * @type boolean\n            */\n            this.active = true;\n        }\n        /**\n        * @method validateListener\n        * @param {Any} listener\n        * @param {Any} fnName\n        */\n        Signal.prototype.validateListener = function (listener, fnName) {\n            if (typeof listener !== 'function') {\n                throw new Error('listener is a required param of {fn}() and should be a Function.'.replace('{fn}', fnName));\n            }\n        };\n        /**\n        * @param {Function} listener\n        * @param {boolean} isOnce\n        * @param {Object} [listenerContext]\n        * @param {Number} [priority]\n        * @return {SignalBinding}\n        * @private\n        */\n        Signal.prototype._registerListener = function (listener, isOnce, listenerContext, priority) {\n            var prevIndex = this._indexOfListener(listener, listenerContext);\n            var binding;\n            if (prevIndex !== -1) {\n                binding = this._bindings[prevIndex];\n                if (binding.isOnce() !== isOnce) {\n                    throw new Error('You cannot add' + (isOnce ? '' : 'Once') + '() then add' + (!isOnce ? '' : 'Once') + '() the same listener without removing the relationship first.');\n                }\n            }\n            else {\n                binding = new Animyst.SignalBinding(this, listener, isOnce, listenerContext, priority);\n                this._addBinding(binding);\n            }\n            if (this.memorize && this._prevParams) {\n                binding.execute(this._prevParams);\n            }\n            return binding;\n        };\n        /**\n        * @method _addBinding\n        * @param {SignalBinding} binding\n        * @private\n        */\n        Signal.prototype._addBinding = function (binding) {\n            //simplified insertion sort\n            var n = this._bindings.length;\n            do {\n                --n;\n            } while (this._bindings[n] && binding.priority <= this._bindings[n].priority);\n            this._bindings.splice(n + 1, 0, binding);\n        };\n        /**\n        * @method _indexOfListener\n        * @param {Function} listener\n        * @return {number}\n        * @private\n        */\n        Signal.prototype._indexOfListener = function (listener, context) {\n            var n = this._bindings.length;\n            var cur;\n            while (n--) {\n                cur = this._bindings[n];\n                if (cur.getListener() === listener && cur.context === context) {\n                    return n;\n                }\n            }\n            return -1;\n        };\n        /**\n        * Check if listener was attached to Signal.\n        * @param {Function} listener\n        * @param {Object} [context]\n        * @return {boolean} if Signal has the specified listener.\n        */\n        Signal.prototype.has = function (listener, context) {\n            return this._indexOfListener(listener, context) !== -1;\n        };\n        /**\n        * Add a listener to the signal.\n        * @param {Function} listener Signal handler function.\n        * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n        * @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n        * @return {SignalBinding} An Object representing the binding between the Signal and listener.\n        */\n        Signal.prototype.add = function (listener, listenerContext, priority) {\n            if (priority === void 0) { priority = 0; }\n            this.validateListener(listener, 'add');\n            return this._registerListener(listener, false, listenerContext, priority);\n        };\n        /**\n        * Add listener to the signal that should be removed after first execution (will be executed only once).\n        * @param {Function} listener Signal handler function.\n        * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n        * @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n        * @return {SignalBinding} An Object representing the binding between the Signal and listener.\n        */\n        Signal.prototype.addOnce = function (listener, listenerContext, priority) {\n            if (priority === void 0) { priority = 0; }\n            this.validateListener(listener, 'addOnce');\n            return this._registerListener(listener, true, listenerContext, priority);\n        };\n        /**\n        * Remove a single listener from the dispatch queue.\n        * @param {Function} listener Handler function that should be removed.\n        * @param {Object} [context] Execution context (since you can add the same handler multiple times if executing in a different context).\n        * @return {Function} Listener handler function.\n        */\n        Signal.prototype.remove = function (listener, context) {\n            this.validateListener(listener, 'remove');\n            var i = this._indexOfListener(listener, context);\n            if (i !== -1) {\n                this._bindings[i]._destroy(); //no reason to a SignalBinding exist if it isn't attached to a signal\n                this._bindings.splice(i, 1);\n            }\n            return listener;\n        };\n        /**\n        * Remove all listeners from the Signal.\n        */\n        Signal.prototype.removeAll = function () {\n            var n = this._bindings.length;\n            while (n--) {\n                this._bindings[n]._destroy();\n            }\n            this._bindings.length = 0;\n        };\n        /**\n        * @return {number} Number of listeners attached to the Signal.\n        */\n        Signal.prototype.getNumListeners = function () {\n            return this._bindings.length;\n        };\n        /**\n        * Stop propagation of the event, blocking the dispatch to next listeners on the queue.\n        * <p><strong>IMPORTANT:</strong> should be called only during signal dispatch, calling it before/after dispatch won't affect signal broadcast.</p>\n        * @see Signal.prototype.disable\n        */\n        Signal.prototype.halt = function () {\n            this._shouldPropagate = false;\n        };\n        /**\n        * Dispatch/Broadcast Signal to all listeners added to the queue.\n        * @param {...*} [params] Parameters that should be passed to each handler.\n        */\n        Signal.prototype.dispatch = function () {\n            var paramsArr = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                paramsArr[_i] = arguments[_i];\n            }\n            if (!this.active) {\n                return;\n            }\n            var n = this._bindings.length;\n            var bindings;\n            if (this.memorize) {\n                this._prevParams = paramsArr;\n            }\n            if (!n) {\n                //should come after memorize\n                return;\n            }\n            bindings = this._bindings.slice(0); //clone array in case add/remove items during dispatch\n            this._shouldPropagate = true; //in case `halt` was called before dispatch or during the previous dispatch.\n            //execute all callbacks until end of the list or until a callback returns `false` or stops propagation\n            //reverse loop since listeners with higher priority will be added at the end of the list\n            do {\n                n--;\n            } while (bindings[n] && this._shouldPropagate && bindings[n].execute(paramsArr) !== false);\n        };\n        /**\n        * Forget memorized arguments.\n        * @see Signal.memorize\n        */\n        Signal.prototype.forget = function () {\n            this._prevParams = null;\n        };\n        /**\n        * Remove all bindings from signal and destroy any reference to external objects (destroy Signal object).\n        * <p><strong>IMPORTANT:</strong> calling any method on the signal instance after calling dispose will throw errors.</p>\n        */\n        Signal.prototype.dispose = function () {\n            this.removeAll();\n            delete this._bindings;\n            delete this._prevParams;\n        };\n        /**\n        * @return {string} String representation of the object.\n        */\n        Signal.prototype.toString = function () {\n            return '[Signal active:' + this.active + ' numListeners:' + this.getNumListeners() + ']';\n        };\n        return Signal;\n    }());\n    /**\n    * Signals Version Number\n    * @property VERSION\n    * @type String\n    * @const\n    */\n    Signal.VERSION = '1.0.0';\n    Animyst.Signal = Signal;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var System = (function () {\n        function System() {\n        }\n        Object.defineProperty(System.prototype, \"paused\", {\n            get: function () { return this._paused; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(System.prototype, \"started\", {\n            get: function () { return this._started; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        System.prototype.startup = function (params) {\n            this._started = true;\n            this._startupParams = params;\n        };\n        System.prototype.shutdown = function () {\n            this._started = false;\n        };\n        System.prototype.update = function (delta, framecount) {\n        };\n        System.prototype.fixedUpdate = function (timestep, time) {\n        };\n        return System;\n    }());\n    Animyst.System = System;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Window = (function () {\n        function Window() {\n        }\n        Object.defineProperty(Window, \"orientation\", {\n            get: function () { return window.orientation; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Window, \"isLandscape\", {\n            get: function () { return window.innerWidth > window.innerHeight; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Window, \"isPortrait\", {\n            get: function () { return window.innerHeight > window.innerWidth; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Window, \"width\", {\n            get: function () { return document.documentElement.clientWidth; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Window, \"height\", {\n            get: function () { return document.documentElement.clientHeight; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Window._onResize = function (evt) {\n            Animyst.Log.output(\"[Window] onResize!\");\n            Window.resizeSignal.dispatch(evt);\n        };\n        Window._onWindowLoad = function (evt) {\n            Animyst.Log.output(\"[Window] Window loaded:\", \"w:\", Window.width, \"h:\", Window.height);\n        };\n        Window._setup = function () {\n            window.addEventListener(\"resize\", Window._onResize);\n            window.addEventListener(\"load\", Window._onWindowLoad);\n        };\n        return Window;\n    }());\n    Window.resizeSignal = new Animyst.Signal();\n    Animyst.Window = Window;\n})(Animyst || (Animyst = {}));\nAnimyst.Window._setup();\nvar Animyst;\n(function (Animyst) {\n    var Sound = (function () {\n        function Sound() {\n        }\n        return Sound;\n    }());\n    Animyst.Sound = Sound;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var PIXITexture = (function (_super) {\n        __extends(PIXITexture, _super);\n        function PIXITexture(stage, renderer) {\n            var _this = _super.call(this) || this;\n            _this.stage = stage;\n            _this.renderer = renderer;\n            _this.width = renderer.view.width;\n            _this.height = renderer.view.height;\n            _this._init();\n            return _this;\n        }\n        PIXITexture.prototype._init = function () {\n            this.image = this.renderer.view;\n            var graphics = new PIXI.Graphics();\n            graphics.lineStyle(2, 0xFF00FF, 1);\n            graphics.beginFill(0xFF00BB, 0.25);\n            graphics.drawCircle(this.width / 2, this.height / 2, 100);\n            graphics.endFill();\n            var texture = PIXI.Texture.fromCanvas(Animyst.DataLoad.getAsset('samusftilt'));\n            var sprite = new PIXI.Sprite(texture);\n            this.stage.addChild(sprite);\n            this.stage.addChild(graphics);\n            this.invalidate();\n            this.update();\n        };\n        PIXITexture.prototype.invalidate = function () {\n            this.shouldUpdate = true;\n        };\n        ;\n        PIXITexture.prototype.update = function () {\n            if (this.shouldUpdate) {\n                this.renderer.render(this.stage);\n                this.needsUpdate = true;\n                this.shouldUpdate = false;\n            }\n        };\n        ;\n        return PIXITexture;\n    }(THREE.Texture));\n    Animyst.PIXITexture = PIXITexture;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var SpriteSheetTexture = (function (_super) {\n        __extends(SpriteSheetTexture, _super);\n        function SpriteSheetTexture(atlas) {\n            var _this = _super.call(this) || this;\n            _this.playTime = 0;\n            _this.time = 0;\n            _this.currentFrame = 0;\n            _this.currentFrameID = \"\";\n            _this.sprite = null;\n            _this.renderWidth = 0;\n            _this.renderHeight = 0;\n            _this.sourceFile = \"\";\n            _this.timePassed = 0;\n            _this.addSheet(atlas);\n            return _this;\n        }\n        SpriteSheetTexture.prototype._initSprite = function (startFrame) {\n            this.stage = new PIXI.Container();\n            this.renderer = PIXI.autoDetectRenderer(256, 256, { transparent: true });\n            this.sprite = new PIXI.Sprite(PIXI.Texture.fromFrame(startFrame));\n            this.image = this.renderer.view;\n            this.stage.addChild(this.sprite);\n            this.renderer.render(this.stage);\n            this.needsUpdate = true;\n        };\n        SpriteSheetTexture.prototype.addSheet = function (atlas) {\n            this.atlas = atlas;\n            this.frames = [];\n            for (var k in atlas.frames) {\n                var frame = atlas.frames[k];\n                if (frame.frame.w > this.renderWidth) {\n                    this.renderWidth = frame.frame.w % 2 == 0 ? frame.frame.w : frame.frame.w + 1;\n                }\n                if (frame.frame.h > this.renderHeight) {\n                    this.renderHeight = frame.frame.h % 2 == 0 ? frame.frame.h : frame.frame.h + 1;\n                }\n                this.frames.push(k);\n            }\n            if (!this.sprite) {\n                this._initSprite(this.frames[0]);\n                this.currentFrameID = this.frames[0];\n                this.currentFrame = 0;\n            }\n        };\n        SpriteSheetTexture.prototype.showFrame = function (frame) {\n            if (this.frames.length <= 0)\n                return;\n            if (!frame)\n                frame = this.currentFrame || 0;\n            var thisFrame;\n            if (typeof frame == \"string\") {\n                thisFrame = frame;\n            }\n            else if (typeof frame == \"number\") {\n                thisFrame = this.frames[frame];\n            }\n            this.sprite.setTexture(PIXI.Texture.fromFrame(thisFrame));\n            this.renderer.render(this.stage);\n            this.needsUpdate = true;\n        };\n        SpriteSheetTexture.prototype.play = function (time, loop) {\n            if (this.frames.length <= 0)\n                return;\n            this.playing = true;\n            this.loop = loop;\n            this.playTime = time;\n            this.time = 0;\n        };\n        SpriteSheetTexture.prototype.stop = function () {\n            this.playing = false;\n            this.timePassed = 0;\n        };\n        SpriteSheetTexture.prototype.animate = function (delta, runtime) {\n            if (this.playing) {\n                //console.log(delta, time, this.time, this.playTime, this.currentFrame, this.sourceFile)\n                if (this.time >= this.playTime) {\n                    if (this.loop) {\n                        this.time = 0;\n                    }\n                    else {\n                        this.playing = false;\n                    }\n                }\n                else {\n                    this.time += delta;\n                    this.currentFrame = Math.round((this.time / this.playTime) * (this.frames.length - 1));\n                    if (this.currentFrame >= this.frames.length)\n                        this.currentFrame = this.frames.length - 1;\n                    this.showFrame();\n                }\n            }\n        };\n        return SpriteSheetTexture;\n    }(THREE.Texture));\n    Animyst.SpriteSheetTexture = SpriteSheetTexture;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var View3D = (function (_super) {\n        __extends(View3D, _super);\n        function View3D() {\n            return _super.call(this) || this;\n        }\n        Object.defineProperty(View3D.prototype, \"aspect\", {\n            get: function () { return this.width / this.height; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        View3D.prototype.clear = function () {\n            Animyst.Database.prototype.clear.call(this);\n        };\n        View3D.prototype.destroy = function () {\n            Animyst.Database.prototype.destroy.call(this);\n        };\n        View3D.prototype.initDisplay = function (params) {\n            if (!params) {\n                Animyst.Log.error(\"[View3D] No initialization params specified\");\n                return;\n            }\n            this.viewAngle = params.viewAngle || this.viewAngle;\n            this.near = params.near || this.near;\n            this.far = params.far || this.far;\n            this._resize = params.resize;\n            this._scene = this._scene || new THREE.Scene();\n            this._renderer = new THREE.WebGLRenderer();\n            this._camera = new THREE.PerspectiveCamera(this.viewAngle, this.aspect, this.near, this.far);\n            this._scene.add(this._camera);\n            this._camera.lookAt(this._scene.position);\n            if (params.container) {\n                var container = document.getElementById(params.container);\n                if (container) {\n                    container.appendChild(this._renderer.domElement);\n                }\n                else {\n                    Animyst.Log.error(\"[View3D] Container ID\", params.container, \"doesn't exist\");\n                }\n            }\n            this._camera.position.x = params.cameraX || 500;\n            this._camera.position.y = params.cameraY || 500;\n            this._camera.position.z = params.cameraZ || 500;\n            this._camera.lookAt(this._scene.position);\n            this._renderer.setClearColor(params.rendererColor || 0x888888);\n            this._renderer.setSize(this.width, this.height);\n            //this._renderer.shadowMapEnabled = false;\n            /*var geom = new THREE.PlaneGeometry(this.width, this.height, 32 );\n            var texture = new PIXITexture(new PIXI.Stage(0xFFFFFF), new PIXI.WebGLRenderer(this.width, this.height, {transparent : true}));\n            var matr = new THREE.MeshBasicMaterial({map:texture, side:THREE.DoubleSide});\n            matr.transparent = true;\n            this.ui = new THREE.Mesh( geom, matr);\n\n            let vFOV = this.camera.fov * (Math.PI / 180);\n            let distance =  this.height / (2 * Math.tan(vFOV / 2));\n\n            this.ui.position.set(0,0, -distance);\n            this.scene.add(this.ui);\n\n            this.camera.add(this.ui);*/\n            /*this.stage    = new PIXI.Stage(0xFFFFFF);\n            this.uiRenderer = new PIXI.WebGLRenderer(this.width, this.height, {transparent : true});\n\n            this.image = this.renderer.view;\n\n            let graphics = new PIXI.Graphics();\n            graphics.lineStyle(2, 0xFF00FF, 1);\n            graphics.beginFill(0xFF00BB, 0.25);\n            graphics.drawCircle(this.width/2, this.height/2, 100, 100);\n            graphics.endFill();\n\n            let texture = PIXI.Texture.fromCanvas(DataLoad.getAsset('samusftilt'));\n            let sprite = new PIXI.Sprite(texture);\n            this.stage.addChild(sprite);\n\n            this.stage.addChild(graphics);\n\n            this.uiRenderer.render(this.stage);*/\n            if (params.addAxis) {\n                var axis = new THREE.AxisHelper(20);\n                this._scene.add(axis);\n            }\n            if (params.debugControls) {\n                var controls = new THREE.OrbitControls(this._camera);\n                if (Animyst.GUI) {\n                    var displayControls = Animyst.GUI.addFolder(\"Viewport3D\");\n                    var c_folder = displayControls.addFolder(\"camera\");\n                    c_folder.add(this._camera.position, \"x\", -1000, 1000).listen();\n                    c_folder.add(this._camera.position, \"y\", -1000, 1000).listen();\n                    c_folder.add(this._camera.position, \"z\", -1000, 1000).listen();\n                }\n            }\n            if (params.resize) {\n                Animyst.Window.resizeSignal.add(this.onResize, this);\n            }\n            this._view = document.createElement('canvas');\n            this._view.width = this.width;\n            this._view.height = this.height;\n            this._context2d = this._view.getContext('2d');\n        };\n        View3D.prototype.append = function (containerID) {\n            if (!containerID) {\n                document.body.appendChild(this._renderer.domElement);\n                //document.body.appendChild(this.view);\n            }\n            else {\n                var container = document.getElementById(containerID);\n                if (container) {\n                    container.appendChild(this._renderer.domElement);\n                    //container.appendChild(this.view);\n                }\n                else {\n                    Animyst.Log.error(\"[Viewport3D] Container ID\", containerID, \"doesn't exist\");\n                }\n            }\n        };\n        View3D.prototype.render = function () {\n            this._renderer.render(this._scene, this._camera);\n            //this.context2d.clearRect(0,0, this.view.width, this.view.height);\n            //this.context2d.drawImage(this.renderer.domElement, 0, 0);\n            //this.context2d.drawImage(this.uiRenderer.view, 0, 0);\n        };\n        View3D.prototype.update = function () {\n        };\n        View3D.prototype.onResize = function () {\n            //this.renderer.setSize(Animyst.)\n        };\n        return View3D;\n    }(Animyst.Database));\n    Animyst.View3D = View3D;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Input = (function (_super) {\n        __extends(Input, _super);\n        function Input(inputData) {\n            var _this = _super.call(this) || this;\n            _this.inputData = inputData;\n            return _this;\n        }\n        Input.prototype.startup = function (params) {\n            var element = params.element;\n            var tool = params.tool;\n            this.keyboardSettings = params.keyboardSettings;\n            if (tool) {\n                tool.onKeyUp = this.onKeyUp.bind(this);\n                tool.onKeyDown = this.onKeyDown.bind(this);\n                tool.onMouseDown = this.onMouseDown.bind(this);\n                tool.onMouseUp = this.onMouseUp.bind(this);\n                tool.onMouseDrag = this.onMouseDrag.bind(this);\n                tool.onMouseMove = this.onMouseMove.bind(this);\n            }\n            if (element) {\n                element.addEventListener('touchstart', this.onTouchStart.bind(this));\n                element.addEventListener('touchmove', this.onTouchMove.bind(this));\n                element.addEventListener('touchend', this.onTouchRelease.bind(this));\n                element.addEventListener('touchenter', this.onTouchEnter.bind(this));\n                element.addEventListener('touchleave', this.onTouchLeave.bind(this));\n                element.addEventListener('mousedown', this.onMouseDown.bind(this));\n                element.addEventListener('mouseup', this.onMouseUp.bind(this));\n                element.addEventListener('mousemove', this.onMouseMove.bind(this));\n                element.addEventListener('mouseenter', this.onMouseEnter.bind(this));\n                element.addEventListener('mouseleave', this.onMouseLeave.bind(this));\n                element.addEventListener('keydown', this.onKeyDown.bind(this));\n                element.addEventListener('keyup', this.onKeyUp.bind(this));\n            }\n            Animyst.System.prototype.startup.call(this, params);\n        };\n        Input.prototype.shutdown = function () {\n            this.inputData = null;\n            Animyst.System.prototype.shutdown.call(this);\n        };\n        Input.prototype.update = function (delta, runtime) {\n            this.inputData.onTick(delta);\n        };\n        //=============== TOUCH EVENTS ======================//\n        Input.prototype.onTouchStart = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Touch Start!\");\n            this.handleTouchInput(Input.TOUCH_START, evt);\n        };\n        Input.prototype.onTouchMove = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Touch Move!\");\n            this.handleTouchInput(Input.TOUCH_MOVE, evt);\n        };\n        Input.prototype.onTouchRelease = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Touch Release!\");\n            this.handleTouchInput(Input.TOUCH_RELEASE, evt);\n        };\n        Input.prototype.onTouchEnter = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Touch Enter!\");\n            this.handleTouchInput(Input.TOUCH_ENTER, evt);\n        };\n        Input.prototype.onTouchLeave = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Touch Leave!\");\n            this.handleTouchInput(Input.TOUCH_LEAVE, evt);\n        };\n        //================= MOUSE EVENTS =====================//\n        Input.prototype.onClick = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Click!\");\n            this.handleMouseInput(Input.MOUSE_CLICK, evt);\n        };\n        Input.prototype.onMouseDown = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Down!\");\n            this.handleMouseInput(Input.MOUSE_DOWN, evt);\n        };\n        Input.prototype.onMouseDrag = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Drag!\");\n            this.handleMouseInput(Input.MOUSE_DRAG, evt);\n        };\n        Input.prototype.onMouseMove = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Move!\");\n            this.handleMouseInput(Input.MOUSE_MOVE, evt);\n        };\n        Input.prototype.onMouseUp = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Up!\");\n            this.handleMouseInput(Input.MOUSE_UP, evt);\n        };\n        Input.prototype.onMouseEnter = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Enter!\");\n            this.handleMouseInput(Input.MOUSE_ENTER, evt);\n        };\n        Input.prototype.onMouseLeave = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Leave!\");\n            this.handleMouseInput(Input.MOUSE_LEAVE, evt);\n        };\n        //================ KEYBOARD EVENTS ===================//\n        Input.prototype.onKeyUp = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Released Key:\", evt.key || Animyst.InputData.KEY_NAMES[evt.keyCode]);\n            if (!this.keyboardSettings.allowDefault[evt.key || Animyst.InputData.KEY_NAMES[evt.keyCode]]) {\n                evt.preventDefault();\n            }\n            this.handleKeyInput(Input.KEY_UP, evt.keyCode || Animyst.InputData.KEY_CODES[evt.key]);\n        };\n        Input.prototype.onKeyDown = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Pressed Key:\", evt.key || Animyst.InputData.KEY_NAMES[evt.keyCode]);\n            if (!this.keyboardSettings.allowDefault[evt.key || Animyst.InputData.KEY_NAMES[evt.keyCode]]) {\n                evt.preventDefault();\n            }\n            this.handleKeyInput(Input.KEY_DOWN, evt.keyCode || Animyst.InputData.KEY_CODES[evt.key]);\n        };\n        //====================================================//\n        Input.prototype.handleMouseInput = function (type, evt) {\n            //console.log(evt);\n            var down;\n            if (type == Input.MOUSE_DOWN || type == Input.MOUSE_DRAG) {\n                down = true;\n            }\n            if (type == Input.MOUSE_UP || type == Input.MOUSE_LEAVE) {\n                down = false;\n            }\n            this.inputData.setMouseInput(evt, down);\n        };\n        Input.prototype.handleKeyInput = function (type, keyCode) {\n            this.inputData.setKeyInput(keyCode, type == Input.KEY_DOWN);\n        };\n        Input.prototype.handleTouchInput = function (type, evt) {\n            switch (type) {\n                case Input.TOUCH_START:\n                    this.inputData.addTouches(evt.changedTouches);\n                    break;\n                case Input.TOUCH_MOVE:\n                    break;\n                case Input.TOUCH_RELEASE:\n                    this.inputData.removeTouches(evt.touches);\n                    break;\n                case Input.TOUCH_ENTER:\n                    break;\n                case Input.TOUCH_LEAVE:\n                    break;\n            }\n            this.inputData.updateTouches(evt.changedTouches);\n        };\n        return Input;\n    }(Animyst.System));\n    Input.KEY_DOWN = 0;\n    Input.KEY_UP = 1;\n    Input.TOUCH_START = 0;\n    Input.TOUCH_MOVE = 1;\n    Input.TOUCH_RELEASE = 2;\n    Input.TOUCH_ENTER = 3;\n    Input.TOUCH_LEAVE = 4;\n    Input.MOUSE_DOWN = 5;\n    Input.MOUSE_UP = 6;\n    Input.MOUSE_DRAG = 7;\n    Input.MOUSE_MOVE = 8;\n    Input.MOUSE_ENTER = 9;\n    Input.MOUSE_LEAVE = 10;\n    Input.MOUSE_CLICK = 11;\n    Animyst.Input = Input;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var InputData = (function (_super) {\n        __extends(InputData, _super);\n        function InputData() {\n            var _this = _super.call(this) || this;\n            _this.map = {};\n            _this.touches = [];\n            _this.touchHistory = [];\n            _this.mouse = {};\n            _this.mouseHistory = [];\n            _this.totalTouchCount = 0;\n            _this.time = 0;\n            return _this;\n        }\n        Object.defineProperty(InputData, \"KEY_NAMES\", {\n            get: function () {\n                if (!InputData.__KEY_NAMES) {\n                    InputData.__KEY_NAMES = Animyst.ObjectUtil.invert(InputData.KEY_CODES);\n                }\n                return InputData.__KEY_NAMES;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        InputData.prototype.clear = function () {\n            this.map = {};\n            this.touches = [];\n            this.touchHistory = [];\n            this.totalTouchCount = 0;\n            _super.prototype.clear.call(this);\n        };\n        InputData.prototype.destroy = function () {\n            this.map = null;\n            this.touches = null;\n            this.touchHistory = null;\n            this.totalTouchCount = 0;\n            _super.prototype.destroy.call(this);\n        };\n        InputData.prototype.onTick = function (delta) {\n            this.time += delta;\n            if (this.mouse.down) {\n                this.mouse.clickTime += delta;\n            }\n            for (var k in this.map) {\n                var data = this.map[k];\n                if (data.active) {\n                    data.time = (data.time || 0) + delta;\n                }\n            }\n            for (var i = 0; i < this.touches.length; i++) {\n                var touchData = this.touches[i];\n                touchData.time += delta;\n            }\n        };\n        InputData.prototype.isKeyDown = function (keyName) {\n            var keyCode = InputData.KEY_CODES[keyName];\n            return (this.map[keyCode] && this.map[keyCode].active) ? true : false;\n        };\n        InputData.prototype.setKeyInput = function (keyCode, active) {\n            var data = this.map[keyCode] || {};\n            var evtType;\n            if (active && !data.active) {\n                data.time = 0;\n                evtType = InputData.KEY_ACTIVE;\n            }\n            if (!active && data.active) {\n                data.lastInput = {};\n                data.lastInput.endTime = this.time;\n                data.lastInput.duration = data.time;\n                data.lastInput.startTime = this.time - data.time;\n                data.time = 0;\n                evtType = InputData.KEY_INACTIVE;\n            }\n            data.active = active === true;\n            if (!this.map[keyCode]) {\n                this.map[keyCode] = data;\n            }\n            if (evtType)\n                this.signal.dispatch(InputData.KEY, evtType, data);\n        };\n        InputData.prototype.setMouseInput = function (evt, down) {\n            if (this.touches.length > 0 && down)\n                down = false;\n            if (typeof (down) != \"boolean\")\n                down = this.mouse.down;\n            var lastClick = this.mouse.down && !down ? this.mouse.lastClick || {} : null;\n            var clickStart = !this.mouse.down && down ? {} : null;\n            var evtType = InputData.MOUSE_MOVE;\n            for (var i = 0; i < InputData.MOUSE_PROPERTIES.length; i++) {\n                var k = InputData.MOUSE_PROPERTIES[i];\n                if (evt[k]) {\n                    this.mouse[k] = evt[k];\n                    if (lastClick)\n                        lastClick[k] = evt[k];\n                    if (clickStart)\n                        clickStart[k] = evt[k];\n                }\n            }\n            if (clickStart) {\n                if (Animyst.LOGGING)\n                    console.log(\"[InputData] Click Start!\");\n                this.mouse.clickStart = clickStart;\n                this.mouse.clickTime = 0;\n                evtType = InputData.MOUSE_DOWN;\n            }\n            if (lastClick) {\n                if (Animyst.LOGGING)\n                    console.log(\"[InputData] Click Ended!\", this.mouse.clickTime);\n                lastClick.clickStart = this.mouse.clickStart;\n                lastClick.clickTime = this.mouse.clickTime;\n                this.mouse.clickStart = null;\n                this.mouse.lastClick = lastClick;\n                evtType = InputData.MOUSE_UP;\n            }\n            this.mouse.down = down;\n            this.signal.dispatch(InputData.MOUSE, evtType, this.mouse);\n        };\n        InputData.prototype.getTouches = function () {\n            return this.touches.concat();\n        };\n        InputData.prototype.addTouches = function (touches) {\n            for (var i = 0; i < touches.length; i++) {\n                var touch = touches[i];\n                var isNew = true;\n                for (var j = 0; j < this.touches.length; j++) {\n                    if (this.touches[j].identifier == touch.identifier) {\n                        isNew = false;\n                        break;\n                    }\n                }\n                if (isNew) {\n                    var data = {};\n                    var startData = {};\n                    for (var j = 0; j < InputData.TOUCH_PROPERTIES.length; j++) {\n                        var k = InputData.TOUCH_PROPERTIES[j];\n                        data[k] = (typeof touch[k] != \"object\" || k == \"target\") ? touch[k] : null;\n                        startData[k] = (typeof touch[k] != \"object\") ? touch[k] : null;\n                    }\n                    data.time = 0; //Time Counter\n                    data.timestamp = this.time; //When the touch began\n                    data.startData = startData; //Data assosiated with the start of the touch\n                    data.uid = data.identifier + \"\" + this.totalTouchCount; //Unique identifier for this touch that seperates it from past touches\n                    this.touches.push(data);\n                    this.totalTouchCount++;\n                    if (Animyst.LOGGING)\n                        console.log(\"[InputData] Adding Touch:\", data.uid);\n                    this.signal.dispatch(InputData.TOUCH, InputData.TOUCH_ADDED, data);\n                }\n            }\n        };\n        InputData.prototype.removeTouches = function (touches) {\n            for (var i = this.touches.length - 1; i > -1 && this.touches.length > 0; i--) {\n                var touchData = this.touches[i];\n                var isGone = true;\n                for (var j = 0; j < touches.length; j++) {\n                    if (touches[j].identifier == touchData.identifier) {\n                        isGone = false;\n                        break;\n                    }\n                }\n                if (isGone) {\n                    if (Animyst.LOGGING)\n                        console.log(\"[InputData] Removing Touch:\", touchData.uid);\n                    this.touchHistory.unshift(touchData);\n                    this.touches.splice(i, 1);\n                    if (this.touchHistory.length > InputData.TOUCH_HISTORY_LIMIT) {\n                        this.touchHistory.pop();\n                    }\n                    this.signal.dispatch(InputData.TOUCH, InputData.TOUCH_REMOVED, touchData);\n                }\n            }\n        };\n        InputData.prototype.updateTouches = function (touches) {\n            for (var i = 0; i < touches.length; i++) {\n                var touch = touches[i];\n                var data;\n                for (var j = 0; j < this.touches.length; j++) {\n                    if (this.touches[j].identifier == touch.identifier) {\n                        data = this.touches[j];\n                        break;\n                    }\n                }\n                if (data) {\n                    for (var j = 0; j < InputData.TOUCH_PROPERTIES.length; j++) {\n                        var k = InputData.TOUCH_PROPERTIES[j];\n                        data[k] = touch[k];\n                    }\n                    if (Animyst.LOGGING)\n                        console.log(\"[InputData] Updated Touch:\", data.uid, Math.round(data.pageX), Math.round(data.pageY), Math.round(data.screenX), Math.round(data.screenY), data.force || data.webkitForce);\n                    this.signal.dispatch(InputData.TOUCH, InputData.TOUCH_UPDATED, data);\n                }\n            }\n        };\n        return InputData;\n    }(Animyst.Database));\n    InputData.TOUCH_HISTORY_LIMIT = 12;\n    InputData.TOUCH_PROPERTIES = [\"identifier\", \"screenX\", \"screenY\", \"clientX\", \"clientY\",\n        \"pageX\", \"pageY\", \"radiusX\", \"radiusY\", \"rotationAngle\",\n        \"force\", \"webkitForce\", \"target\"];\n    InputData.MOUSE_PROPERTIES = [\"clientX\", \"clientY\", \"screenX\", \"screenY\", \"type\", \"point\",\n        \"lastPoint\", \"downPoint\", \"middlePoint\", \"count\", \"item\", \"modifiers\"];\n    InputData.KEY_CODES = {\n        'backspace': 8,\n        'tab': 9,\n        'enter': 13,\n        'shift': 16,\n        'ctrl': 17,\n        'alt': 18,\n        'pause': 19,\n        'capslock': 20,\n        'numlock': 144,\n        'esc': 27,\n        'pageup': 33,\n        'pagedown': 34,\n        'end': 35,\n        'home': 36,\n        'leftarrow': 37,\n        'uparrow': 38,\n        'rightarrow': 39,\n        'downarrow': 40,\n        'insert': 45,\n        'delete': 46,\n        'clear': 12,\n        '0': 48,\n        '1': 49,\n        '2': 50,\n        '3': 51,\n        '4': 52,\n        '5': 53,\n        '6': 54,\n        '7': 55,\n        '8': 56,\n        '9': 57,\n        'a': 65,\n        'b': 66,\n        'c': 67,\n        'd': 68,\n        'e': 69,\n        'f': 70,\n        'g': 71,\n        'h': 72,\n        'i': 73,\n        'j': 74,\n        'k': 75,\n        'l': 76,\n        'm': 77,\n        'n': 78,\n        'o': 79,\n        'p': 80,\n        'q': 81,\n        'r': 82,\n        's': 83,\n        't': 84,\n        'u': 85,\n        'v': 86,\n        'w': 87,\n        'x': 88,\n        'y': 89,\n        'z': 90,\n        'numpad0': 96,\n        'numpad1': 97,\n        'numpad2': 98,\n        'numpad3': 99,\n        'numpad4': 100,\n        'numpad5': 101,\n        'numpad6': 102,\n        'numpad7': 103,\n        'numpad8': 104,\n        'numpad9': 105,\n        'multiply': 106,\n        'plus': 107,\n        'minus': 109,\n        'dot': 110,\n        'divide': 111,\n        'f1': 112,\n        'f2': 113,\n        'f3': 114,\n        'f4': 115,\n        'f5': 116,\n        'f6': 117,\n        'f7': 118,\n        'f8': 119,\n        'f9': 120,\n        'f10': 121,\n        'f11': 122,\n        'f12': 123,\n        '=': 187,\n        ',': 188,\n        '.': 190,\n        '/': 191,\n        'backslash': 220,\n        \";\": 186,\n        \"'\": 222,\n        \"[\": 219,\n        \"]\": 221,\n        \"-\": 189,\n        \"space\": 32,\n        \"~\": 192\n    };\n    InputData.MOUSE = 0;\n    InputData.TOUCH = 1;\n    InputData.KEY = 2;\n    InputData.TOUCH_ADDED = 0;\n    InputData.TOUCH_REMOVED = 1;\n    InputData.TOUCH_UPDATED = 2;\n    InputData.MOUSE_DOWN = 0;\n    InputData.MOUSE_UP = 1;\n    InputData.MOUSE_MOVE = 2;\n    InputData.KEY_ACTIVE = 0;\n    InputData.KEY_INACTIVE = 1;\n    Animyst.InputData = InputData;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var SpriteSheetAnimation = (function () {\n        function SpriteSheetAnimation(id, framerate) {\n            if (framerate === void 0) { framerate = 60; }\n            this.time = 0;\n            this.playTime = 0;\n            this.currentFrame = 0;\n            this.id = id;\n            this.animations = {};\n            this.spritesheets = {};\n            this.framerate = framerate;\n        }\n        SpriteSheetAnimation.prototype.addSheet = function (sheetData) {\n            this.spritesheets[sheetData.name] = sheetData;\n        };\n        SpriteSheetAnimation.prototype.getSheet = function (sheetID) {\n            return this.spritesheets[sheetID];\n        };\n        ;\n        SpriteSheetAnimation.prototype.addAnimation = function (name, prefix, sheetID, params) {\n            if (params === void 0) { params = {}; }\n            var anim = {};\n            var spritesheet = this.getSheet(sheetID);\n            anim.name = name;\n            anim.prefix = prefix;\n            anim.sheetID = sheetID;\n            anim.useFrames = params.useFrames || false;\n            anim.frames = spritesheet.getFrames(anim.prefix);\n            anim.currentFrameIndex = 0;\n            anim.totalFrames = anim.frames.length;\n            anim.duration = params.duration || anim.useFrames ? anim.totalFrames * (this.framerate / 60) : 1000 / this.framerate * anim.totalFrames;\n            anim.loop = params.loop || false;\n            anim.repeat = params.repeat || 0;\n            anim.elapsed = 0;\n            anim.framecount = 0;\n            this.animations[anim.name] = anim;\n        };\n        SpriteSheetAnimation.prototype.getAnimation = function (name) {\n            return this.animations[name];\n        };\n        ;\n        SpriteSheetAnimation.prototype.play = function (name) {\n            if (this.currentAnim == name)\n                return;\n            var anim = this.getAnimation(name);\n            this.currentAnim = name;\n            this.playing = true;\n        };\n        ;\n        SpriteSheetAnimation.prototype.stop = function () {\n        };\n        SpriteSheetAnimation.prototype.pause = function () {\n        };\n        SpriteSheetAnimation.prototype.resume = function () {\n        };\n        SpriteSheetAnimation.prototype.setIdle = function (name) {\n            // body...  \n        };\n        ;\n        SpriteSheetAnimation.prototype.animate = function (delta) {\n            if (delta === void 0) { delta = 0; }\n            if (this.playing) {\n                //console.log(delta, time, this.time, this.playTime, this.currentFrame, this.sourceFile)\n                var anim = this.getAnimation(this.currentAnim);\n                if (anim.useFrames) {\n                }\n                else {\n                }\n                //TODO: Finish...\n                /*if(this.time >= this.playTime){\n\n                    if(this.loop){\n                        this.time = 0;\n                    } else {\n                        this.playing = false;\n                    }\n                } else {\n\n                    this.time += delta;\n                    this.currentFrame = Math.round((this.time / this.playTime) * (this.frames.length - 1))\n                    if(this.currentFrame >= this.frames.length) this.currentFrame = this.frames.length - 1;\n                }*/\n            }\n        };\n        ;\n        return SpriteSheetAnimation;\n    }());\n    Animyst.SpriteSheetAnimation = SpriteSheetAnimation;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var SpriteSheetData = (function (_super) {\n        __extends(SpriteSheetData, _super);\n        function SpriteSheetData(name, data) {\n            var _this = _super.call(this) || this;\n            _this.name = name;\n            _this.data = data;\n            _this.parse();\n            return _this;\n        }\n        SpriteSheetData.prototype.parse = function () {\n            for (var k in this.data.frames) {\n                this.addFrame(k, this.data.frames[k]);\n            }\n        };\n        SpriteSheetData.prototype.addFrame = function (frameID, data) {\n            var frame = new FrameData(frameID, data);\n            this.create(frame, frameID, data);\n        };\n        SpriteSheetData.prototype.getFrame = function (frameID) {\n            return this.getItem(frameID);\n        };\n        SpriteSheetData.prototype.getFrames = function (framePrefix) {\n            if (!this.hasCategory(framePrefix)) {\n                var ctx = {};\n                ctx.framePrefix = framePrefix;\n                this.addCategory(framePrefix, function (frame) {\n                    return frame.id.indexOf(this.framePrefix) == 0;\n                }, FrameData, ctx);\n            }\n            var frames = this.getItemsInCategory(framePrefix);\n            frames.sort(this._sortCaseInsensitive);\n            return frames;\n        };\n        SpriteSheetData.prototype._sortCaseInsensitive = function (a, b) {\n            if (a.toLowerCase() < b.toLowerCase())\n                return -1;\n            if (a.toLowerCase() > b.toLowerCase())\n                return 1;\n            return 0;\n        };\n        return SpriteSheetData;\n    }(Animyst.Database));\n    Animyst.SpriteSheetData = SpriteSheetData;\n    var FrameData = (function (_super) {\n        __extends(FrameData, _super);\n        function FrameData(id, params) {\n            return _super.call(this, id, params) || this;\n        }\n        FrameData.prototype.setup = function (params) {\n            this.frame = params.frame;\n            this.rotated = params.rotated;\n            this.trimmed = params.trimmed;\n            this.spriteSourceSize = params.spriteSourceSize;\n            this.sourceSize = params.sourceSize;\n            this.pivot = params.pivot;\n            _super.prototype.setup.call(this, params);\n        };\n        ;\n        return FrameData;\n    }(Animyst.Item));\n    Animyst.FrameData = FrameData;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var CoreProcess = (function (_super) {\n        __extends(CoreProcess, _super);\n        function CoreProcess(id) {\n            return _super.call(this, id) || this;\n        }\n        CoreProcess.prototype.setup = function () {\n            Animyst.Log.output(\"[CoreProcess] Core Process Initialize\");\n            _super.prototype.setup.call(this);\n            this._inputData = new Animyst.InputData();\n            var config = this.appScope.config;\n            var input = new Animyst.Input(this._inputData);\n            input.startup({ element: document.body, keyboardSettings: config.settings.keyboard });\n            this.addSystem(\"input\", input);\n            this.appScope.addDatabase(CoreProcess.INPUT, this._inputData);\n        };\n        CoreProcess.prototype.start = function () {\n            Animyst.Log.output(\"[CoreProcess] Start\");\n            _super.prototype.start.call(this);\n        };\n        CoreProcess.prototype.update = function (delta, time) {\n            //console.log(\"[Game] Updating...\")\n            _super.prototype.update.call(this, delta, time);\n        };\n        CoreProcess.prototype.pause = function () {\n            _super.prototype.pause.call(this);\n        };\n        CoreProcess.prototype.resume = function () {\n            _super.prototype.resume.call(this);\n        };\n        CoreProcess.prototype.kill = function () {\n            _super.prototype.kill.call(this);\n        };\n        CoreProcess.prototype.restart = function () {\n            _super.prototype.restart.call(this);\n        };\n        return CoreProcess;\n    }(Animyst.AppState));\n    CoreProcess.ID = \"core\";\n    CoreProcess.INPUT = \"input\";\n    Animyst.CoreProcess = CoreProcess;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var ArrayUtil = (function () {\n        function ArrayUtil(argument) {\n            // code...\n        }\n        /**\n        * Searches through any array for an element with a specific property\n        * @param  {any} property Property to check\n        * @param  {any} value    Value of the property\n        * @param  {any} array    Array of elements\n        * @return {any}          First element found with given property value. Returns null if nothing is found\n        */\n        ArrayUtil.search = function (property, value, array) {\n            for (var i = 0; i < array.length; i++) {\n                var obj = array[i];\n                if (obj[property] && obj[property] === value) {\n                    return obj;\n                }\n            }\n            return null;\n        };\n        /**\n        * Searches through any array for all elements with a specific property\n        * @param  {any} property Property to check\n        * @param  {any} value    Value of the property\n        * @param  {any} array    Array of elements\n        * @return {any}          First element found with given property value. Returns null if nothing is found\n        */\n        ArrayUtil.searchAll = function (property, value, array, output) {\n            if (output === void 0) { output = []; }\n            for (var i = 0; i < array.length; i++) {\n                var obj = array[i];\n                if (obj[property] && obj[property] === value) {\n                    output.push(obj);\n                }\n            }\n            return output;\n        };\n        /**\n        * Pushes an element to an array as long as it is not already included in the array\n        * @param {any}   element [description]\n        * @param {any[]} array   [description]\n        */\n        ArrayUtil.include = function (element, array) {\n            if (array.indexOf(element) == -1)\n                array.push(element);\n        };\n        /**\n        * Splices an element out of an array\n        * @param {any}   element [description]\n        * @param {any[]} array   [description]\n        */\n        ArrayUtil.remove = function (element, array) {\n            var index = array.indexOf(element);\n            if (index >= 0)\n                array.splice(index, 1);\n        };\n        /**\n        * Traverses array and executes a call on each element\n        * @param {any[]}     array   [description]\n        * @param {any}       command [description]\n        * @param {number =       0}           startIndex [description]\n        * @param {number =       1}           inc        [description]\n        * @param {any}       ctx     [description]\n        */\n        ArrayUtil.traverse = function (array, command, startIndex, inc, ctx) {\n            if (startIndex === void 0) { startIndex = 0; }\n            if (inc === void 0) { inc = 1; }\n            if (ctx === void 0) { ctx = null; }\n            for (var i = startIndex; i < array.length; i += inc) {\n                command.call(ctx, array[i]);\n            }\n        };\n        return ArrayUtil;\n    }());\n    Animyst.ArrayUtil = ArrayUtil;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var MathUtil = (function () {\n        function MathUtil() {\n        }\n        MathUtil.loopSum = function (v, inc, max, min) {\n            if (min === void 0) { min = 0; }\n            var result = (v + inc) % (max + 1) + min;\n            if (result < min)\n                result = (max + 1) - Math.abs(result - min);\n            return result;\n        };\n        MathUtil.constrain = function (v, min, max) {\n            return Math.max(min, Math.min(v, max));\n        };\n        MathUtil.findClosestDivisable = function (value, divisor) {\n            if (value <= divisor)\n                return divisor;\n            if (value % divisor > divisor / 2) {\n                return value + (divisor - (value % divisor));\n            }\n            else {\n                return value - (value % divisor);\n            }\n        };\n        MathUtil.findNextDivisable = function (value, divisor) {\n            if (value <= divisor)\n                return divisor;\n            return value + (divisor - (value % divisor));\n        };\n        MathUtil.interpolate = function (a, b, percent) {\n            return a + (b - a) * percent;\n        };\n        return MathUtil;\n    }());\n    Animyst.MathUtil = MathUtil;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var ObjectUtil = (function () {\n        function ObjectUtil() {\n        }\n        /**\n         * Inverts the properties and keys of an object\n         * @param  {any} object Object to invert\n         * @return {any}        Inverted copy of object\n         */\n        ObjectUtil.invert = function (object) {\n            var obj = {};\n            for (var k in object) {\n                obj[object[k]] = k;\n            }\n            return obj;\n        };\n        /**\n         * Returns copy of an object\n         * @param  {any} obj    Object to copy\n         * @param  {any} target Target object to copy to\n         * @return {any}        [description]\n         */\n        ObjectUtil.copy = function (obj, target) {\n            target = target || {};\n            for (var k in obj) {\n                if (obj[k] instanceof Object) {\n                    if (Array.isArray(obj[k])) {\n                        target[k] = obj[k].concat();\n                    }\n                    else {\n                        target[k] = ObjectUtil.copy(obj[k]);\n                    }\n                }\n                else {\n                    target[k] = obj[k];\n                }\n            }\n            return target;\n        };\n        return ObjectUtil;\n    }());\n    Animyst.ObjectUtil = ObjectUtil;\n})(Animyst || (Animyst = {}));\n","module Animyst {\n\texport var LOGGING:boolean = true;\n\texport var DEBUG:boolean = true;\n\texport var GUI:any;\n\n\texport var MAJOR:number = 0;\n\texport var MINOR:number = 0;\n\texport var BUILD:number = 0;\n\texport var DATA:string = \"\";\n\n\texport var VERSION:string = MAJOR + \".\" + MINOR + \".\" + BUILD;\n}","module Animyst {\n    export class Application {\n\n    \tprivate _appStateList:any[];\n    \tprivate _appStateLib:any;\n    \tprivate _stats:any;\n    \tprivate _startParams:any;\n\n    \tprivate _lastFrame:number = 0;\n    \tprivate _framerate:number = 60;\n    \tpublic get framerate():number { return this._framerate;};\n    \t\n    \tprivate _framecount:number = 0;\n    \tpublic get framecount():number{return this._framecount};\n\n    \tprivate _timestep:number = 1000 / this._framerate;\n    \tpublic get timestep():number { return this._timestep;};\n    \tpublic set timestep(v:number) { this._timestep = v;};\n\n    \tpublic appScope:AppScope;\n    \tpublic initSignal:any;\n    \tpublic config:any;\n    \tpublic runtime:number = 0;\n    \t\n    \tconstructor(argument) {\n    \t\tthis._appStateList  = [];\n\t\t\tthis._appStateLib   = {};\n\n\t\t\tthis.appScope = new AppScope();\n\n\t\t\tthis.initSignal = new Signal();\n    \t}\n\n    \tpublic startup(params:any):void{\n    \t\tLog.output(\"===================================================\");\n\t\t\tLog.output(\"   ----- AnimystJS: (v \" + VERSION + \") by ~Saykrd -----   \");\n\t\t\tLog.output(\"===================================================\");\n\t\t\tLog.output(\"Browser:\", Environment.browserName);\n\t\t\tLog.output(\"Version:\", Environment.browserVersion);\n\t\t\tLog.output(\"Platform:\", Environment.platformName);\n\t\t\tLog.output(\"===================================================\");\n\n\t\t\tthis._startParams = params;\n\n\t\t\t// Load all configuration files and and assets first\n\t\t\tDataLoad.startup({});\n\t\t\tDataLoad.loadAsset({\"id\" : \"config\", \"src\" : \"config.json\"}, (type, evt) => this.onLoading(type, evt));\n    \t}\n\n\n    \tprivate onLoading(type:number, evt:any):void{\n    \t\tif(type == DataLoad.FILE_LOADED){\n\n\t\t\t\tswitch(evt.item.id){\n\t\t\t\t\tcase \"config\":\n\t\t\t\t\t\tLog.output(\"[Application] Config json loaded\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.config = DataLoad.getAsset(\"config\");\n\t\t\t\t\t\tthis.appScope.config = this.config;\n\n\t\t\t\t\t\tDataLoad.loadFromManifest([\n\t\t\t\t\t\t\t{\"id\" : \"assets\", \"src\" : this.config.assets}, \n\t\t\t\t\t\t\t{\"id\" : \"strings\", \"src\" : this.config.strings}\n\t\t\t\t\t\t]);\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"assets\":\n\t\t\t\t\t\tLog.output(\"[Application] Assets json loaded\");\n\t\t\t\t\t\tvar assets = DataLoad.getAsset(\"assets\");\n\t\t\t\t\t\tDataLoad.listAssets(assets.manifest);\n\t\t\t\t\t\t//Log.output(DataLoad._assetList);\n\n\t\t\t\t\t\tif(assets.initialLoad){\n\t\t\t\t\t\t\tDataLoad.loadFromManifest(assets.initialLoad);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"strings\":\n\t\t\t\t\t\tLog.output(\"[Application] Strings json loaded\");\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t} else if(type == DataLoad.LOAD_COMPLETE){\n\t\t\t\t//DataLoad.removeLoadHandler(this._load);\n\t\t\t\tthis.init();\n\t\t\t}\n    \t}\n\n    \tprivate init():void{\n    \t\tvar params = this._startParams;\n\n\t\t\tLOGGING = this.config.settings.logging || LOGGING;\n\t\t\tDEBUG   = this.config.settings.debug   || DEBUG;\n\n\t\t\t//window[\"Paper\"] = {};\n\t\t\t//paper.install(window[\"Paper\"]);\n\n\t\t\tLog.output(\"[Application] Application Started\")\n\n\t\t\tif(this.config.settings.debug){\n\t\t\t\tif(window[\"Stats\"] && !Environment.isCocoonJS){\n\t\t\t\t\tthis._stats = new window[\"Stats\"]();\n\t\t\t\t\tthis._stats.domElement.style.position = 'absolute';\n\t\t\t\t\tthis._stats.domElement.style.left = '0px';\n\t\t\t\t\tthis._stats.domElement.style.top = '0px';\n\n\t\t\t\t\tdocument.body.appendChild( this._stats.domElement );\n\t\t\t\t\tLog.output(\"[Application] Stats Enabled\");\n\t\t\t\t}\n\n\t\t\t\tif(window[\"dat\"] && !Environment.isCocoonJS){\n\t\t\t\t\tAnimyst.GUI = new window[\"dat\"].GUI();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t\n\n\t\t\tvar coreprocess = new CoreProcess(CoreProcess.ID);\n\t\t\tthis.run(coreprocess);\n\n\t\t\tthis.timestep = this.config.settings.timestep || this.timestep;\n\n\n\t\t\tsetInterval(() => this.fixedUpdate, this.timestep);\n\n\t\t\tif(window[\"view\"]){\n\t\t\t\twindow[\"view\"].onFrame = this.frameUpdate.bind(this);\t\n\t\t\t} else {\n\t\t\t\tthis.initFrame();\n\t\t\t}\n\t\t\t\n\n\t\t\t\n\t\t\tthis.initSignal.dispatch();\n    \t}\n\n    \tprivate initFrame():void{\n    \t\trequestAnimationFrame(() => this.initFrame());\n\t\t\tthis.frameUpdate();\n    \t}\n\n    \tpublic run(appState:AppState):void{\n    \t\tif(!this._appStateLib[appState.id]){\n\t\t\t\tthis._appStateLib[appState.id] = appState;\n\n\t\t\t\tthis._appStateList.push(appState);\n\n\t\t\t\tappState.setScope(this.appScope);\n\t\t\t\tappState.framerate = this.framerate;\n\t\t\t\tappState.timestep = this.timestep;\n\t\t\t\tappState.setup();\n\t\t\t\tappState.start();\n\t\t\t}\n    \t}\n\n\n    \tpublic halt(appStateID:string):void{\n    \t\tif(!this._appStateLib[appStateID]){\n\t\t\t\tthis._appStateLib[appStateID].pause();\n\t\t\t}\n    \t}\n\n    \tpublic resume(appStateID:string):void{\n    \t\tif(!this._appStateLib[appStateID]){\n\t\t\t\tthis._appStateLib[appStateID].resume();\n\t\t\t}\n    \t}\n\n    \tpublic end(appStateID):void{\n    \t\tif(!this._appStateLib[appStateID]){\n\t\t\t\tvar appState = this._appStateLib[appStateID]\n\n\t\t\t\tappState.kill();\n\n\t\t\t\tthis._appStateLib[appState.id] = null;\n\n\n\t\t\t\tfor(var i = 0; i < this._appStateList.length; i++){\n\t\t\t\t\tvar state = this._appStateList[i];\n\t\t\t\t\tif(state.id == appState.id){\n\t\t\t\t\t\tthis._appStateList.splice(i,1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n    \t}\n\n    \tpublic endAll():void{\n    \t\tfor(var k in this._appStateLib){\n\t\t\t\tthis.end(k)\n\t\t\t}\n    \t}\n\n    \tpublic fixedUpdate():void{\n    \t\tthis.runtime += this.timestep;\n\n\t\t\tfor(var i = 0; i < this._appStateList.length; i++){\n\t\t\t\tvar state:AppState = this._appStateList[i];\n\t\t\t\tstate.fixedUpdate(this.timestep, this.runtime);\n\t\t\t}\n    \t}\n\n    \tpublic frameUpdate(event?:any):void{\n    \t\t// Calculate time intervals\n\t\t\tvar delta = 0;\n\t\t\tvar time  = 0;\n\n\t\t\tif(event){\n\t\t\t\tdelta = event.delta;\n\t\t\t\ttime  = event.time;\n\t\t\t} else {\n\t\t\t\ttime  = Date.now();\n\t\t\t\tdelta = time - (this._lastFrame || Date.now());\n\t\t\t\tthis._lastFrame = time;\n\t\t\t}\n\n\t\t\tif(this._stats){\n\t\t\t\tthis._stats.begin();\n\t\t\t}\n\n\t\t\tfor(var i = 0; i < this._appStateList.length; i++){\n\t\t\t\tvar state:AppState = this._appStateList[i];\n\t\t\t\tstate.update(delta, this._framecount);\n\t\t\t}\n\n\t\t\tthis._framecount++;\n\n\t\t\tif(this._stats){\n\t\t\t\tthis._stats.end();\n\t\t\t}\n    \t}\n    }\n}","module Animyst {\n    export class AppScope {\n\n\t\tpublic databases:any = {};\n\t\tpublic config:any;\n\n\n    \tconstructor() {\n    \t\t// code...\n    \t}\n\n    \tpublic addDatabase (id:string, database:Database):void{\n\t\t\tthis.databases[id] = database;\n\t\t}\n\n\t\tpublic getDatabase (id:string):Database{\n\t\t\treturn this.databases[id];\n\t\t}\n    }\n}","module Animyst {\n    export class AppState {\n    \t\n\n    \tprivate _id:string;\n    \tpublic get id():string{return this._id};\n\n    \tprivate _systemList:any[] = [];\n    \tprivate _systemLib:any = [];\n\n    \tpublic active:boolean;\n    \tpublic paused:boolean;\n    \tpublic appScope:AppScope;\n    \tprivate _framerate:number = 60;\n    \tpublic get framerate():number { return this._framerate};\n    \tpublic set framerate(v:number){this._framerate = v};\n\n    \tpublic _timestep:number = 1000/this.framerate;\n    \tpublic get timestep():number { return this._timestep};\n    \tpublic set timestep(v:number){this._timestep = v};\n\n\t\tpublic setScope (appScope):void{\n\t\t\tthis.appScope = appScope;\n\t\t}\n\n\n\t\tpublic clearScope ():void{\n\t\t\tthis.appScope = null;\n\t\t}\n\n\n\t\tpublic setup ():void{\n\n\t\t}\n\n\t\tpublic start ():void{\n\t\t\tthis.active = true;\n\t\t}\n\n\t\tpublic stop ():void{\n\t\t\tthis.active = false;\n\t\t\tfor(var i = 0 ; i < this._systemList.length; i++){\n\t\t\t\tvar system = this._systemList[i];\n\t\t\t\tsystem.shutdown();\t\n\t\t\t}\n\t\t}\n\n\t\tpublic update (delta:number, framecount:number):void{\n\t\t\t//console.log(\"[AppState] Updating...\", this);\n\t\t\tif(this.active && !this.paused){\n\t\t\t\tfor(var i = 0 ; i < this._systemList.length; i++){\n\t\t\t\t\tvar system = this._systemList[i];\n\t\t\t\t\tif(system.started && !system.paused){\n\t\t\t\t\t\tsystem.update(delta, framecount);\t\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tpublic fixedUpdate (timestep:number, time:number):void{\n\t\t\t//console.log(\"[AppState] Updating...\", this);\n\t\t\tif(this.active && !this.paused){\n\t\t\t\tfor(var i = 0 ; i < this._systemList.length; i++){\n\t\t\t\t\tvar system = this._systemList[i];\n\t\t\t\t\tif(system.started && !system.paused){\n\t\t\t\t\t\tsystem.fixedUpdate(timestep, time);\t\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tpublic pause ():void{\n\t\t\tthis.paused = true;\n\t\t}\n\n\t\tpublic resume ():void{\n\t\t\tthis.paused = false;\n\t\t}\n\n\t\tpublic kill ():void{\n\t\t\tthis.stop();\n\t\t\tthis.clearScope();\n\t\t\t\n\t\t\tthis._systemList = null;\n\t\t\tthis._systemLib  = null;\n\t\t}\n\n\t\tpublic restart ():void{\n\n\t\t}\n\n\t\tpublic addSystem (id, system):void{\n\t\t\tif(!this._systemList[id]){\n\t\t\t\tthis._systemLib[id] = system;\n\t\t\t\tthis._systemList.push(system);\n\t\t\t}\n\t\t}\n\n\t\tpublic getSystem (id):void{\n\t\t\tif(!this._systemList[id]){\n\t\t\t\treturn this._systemLib[id];\n\t\t\t}\n\n\t\t\tconsole.error(\"[AppState] !! No system found with ID: \" + id);\n\t\t}\n\n\n\n\n\n\n    \tconstructor(id:string) {\n    \t\tthis._id = id;\n    \t}\n    }\n}","module Animyst {\n    export class Database {\n\n    \tstatic ADDED:string   = 'added';\n\t\tstatic REMOVED:string = 'removed';\n\n\t\tprivate _itemCount = 0;\n\t\tprivate _items = {};\n\t\tprivate _itemList = [];\n\t\tprivate _categoryLists  = {};\n\t\tprivate _categoryChecks = {};\n\n\t\tpublic signal = new Signal();\n    \t\n    \tconstructor() {\n    \t\t// code...\n    \t}\n\n    \t/**\n\t\t * Adds an item category list to keep track of specific items\n\t\t * @param {string} name    Name of category\n\t\t * @param {function} check   A function evaluating the item. Ex: \"function (item) { if(shouldBeInList) return true; return false}\"\n\t\t * @param {class} cls     The class type the item should belong to\n\t\t * @param {ctx} context The 'this' variable to be used with the check\n\t\t */\n\t\tpublic addCategory (name:string, check:any, cls?:any, context?:any){\n\t\t\tthis._categoryLists[name] = [];\n\t\t\tthis._categoryChecks[name] = { check: check, context: context, cls: cls};\n\n\t\t\tthis.traverse(this.list, this);\n\t\t};\n\n\t\t/**\n\t\t * Checks if a category exists\n\t\t * @param {string} name [description]\n\t\t */\n\t\tpublic hasCategory (name:string){\n\t\t\treturn this._categoryLists[name] != null;\n\t\t};\n\n\t\t/**\n\t\t * Adds item into all category lists that it belongs to\n\t\t * @param {Item} item [description]\n\t\t */\n\t\tpublic list (item:Item){\n\t\t\tfor (var k in this._categoryLists) {\n\t\t\t\tvar data = this._categoryChecks[k];\n\t\t\t\tif (item instanceof data.cls && data.check.call(data.context, item)) {\n\t\t\t\t\tArrayUtil.include(item.id, this._categoryLists[k]);\n\t\t\t\t}\n\t\t\t}  \n\t\t};\n\n\t\t/**\n\t\t * Removes item from all categories \n\t\t * @param {string} itemID [description]\n\t\t */\n\t\tpublic unlist (itemID:string){\n\t\t\tfor (var k in this._categoryLists) {\n\t\t\t\tfor (var i = 0; i < this._categoryLists[k].length; i++) {\n\t\t\t\t\tArrayUtil.remove(itemID, this._categoryLists[k]);\n\t\t\t\t}\n\t\t\t} \n\t\t};\n\n\t\t/**\n\t\t * Returns the list of item ID's in a given category\n\t\t * @param {string} category [description]\n\t\t */\n\t\tpublic getItemsInCategory (category:string){\n\t\t\tvar items = this._categoryLists[category] || [];\n\n\t\t\tfor (var i = items.length - 1; i >= 0 && items.length > 0; i--) {\n\t\t\t\tvar item = this.getItem(items[i]);\n\t\t\t\tif (!item) {\n\t\t\t\t\titems.splice(i, 1);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn items; \n\t\t};\n\n\t\t/**\n\t\t * Evaluates whether an item is listed in a specific category\n\t\t * @param  {string}  itemID   [description]\n\t\t * @param  {string}  category [description]\n\t\t */\n\t\tpublic isInCategory (itemID:string, category:string){\n\t\t\tvar list = this._categoryLists[category];\n\t\t\treturn list.indexOf(itemID) > -1;  \n\t\t};\n\n\t\t/**\n\t\t * Traverses a category of items or all items in this database and executes a command on all of them\n\t\t * @param  {function} command  Command to execute on all items (\"function(item){//...}\")\n\t\t * @param  {object} context  'this' variable for the command\n\t\t * @param  {string} category Category to traverse. Traverses entire database if no category is specified\n\t\t */\n\t\tpublic traverse (command:any, context:any, category:string = null){\n\t\t\tvar list = this._categoryLists[category] || this._itemList;\n\n\t\t\tfor (var i = 0; i < list.length; i++) {\n\t\t\t\tvar item = this.getItem(list[i]);\n\n\t\t\t\tif (item) {\n\t\t\t\t\tcommand.call(context, item);\n\t\t\t\t} else {\n\t\t\t\t\tlist.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\n\t\t/**\n\t\t * Creates an item and adds it to the database\n\t\t * @param {object} cls   Class of the item\n\t\t * @param {string} id     Item ID\n\t\t * @param {object} params Params to initialize the item\n\t\t * @return {object} Returns the item that was added\n\t\t */\n\t\tpublic create (cls:any, id:string, params?:any):Item{\n\t\t \tif(!id){\n\t\t \t\tid = \"item\" + this._itemCount  \n\t\t \t}\n\n\t\t\tif(this._items[id]){\n\t\t\t\tid = id + this._itemCount;\n\t\t\t}\n\n\t\t\tvar item = new cls(id, params);\n\n\t\t\titem.id = id;\n\n\t\t\tthis._items[id] = item;\n\t\t\tthis._itemList.push(item.id);\n\n\t\t\tthis.list(item);\n\n\t\t\tthis._itemCount++;\n\n\t\t\titem.signal = this.signal;\n\n\t\t\tthis.signal.dispatch(Database.ADDED, item.id);\n\t\t\treturn item; \n\t\t};\n\n\t\t/**\n\t\t * Removes item from database\n\t\t * @param {string} itemID [description]\n\t\t */\n\t\tpublic remove (itemID:string){\n\t\t\tif (!this._items[itemID]) return;\n\t\t\tvar item = this.getItem(itemID);\n\t\t\t\n\t\t\tthis.unlist(itemID);\n\t\t\tdelete this._items[itemID]\n\t\t\tthis.signal.dispatch(Database.REMOVED, itemID);  \n\t\t};\n\n\n\t\t/**\n\t\t * Removes all items in database\n\t\t */\n\t\tpublic removeAll (){\n\t\t\tthis.traverse(function(item) { this.remove(item.id) }, this);\n\t\t};\n\n\t\t\n\t\t/**\n\t\t * Returns item in database\n\t\t * @param {string} itemID [description]\n\t\t */\n\t\tpublic getItem (itemID:string){\n\t\t\treturn this._items[itemID];\n\t\t};\n\n\t\tpublic clear (){\n\n\t\t}\n\n\t\tpublic destroy (){\n\n\t\t}\n    }\n}\t\t\t","module Animyst {\n    export class DataLoad {\n\n    \tstatic LOAD_INITIALIZE:number = 0;\n\t\tstatic LOAD_STARTED:number    = 1;\n\t\tstatic LOAD_PROGRESS:number   = 2;\n\t\tstatic LOAD_COMPLETE:number   = 3;\n\t\tstatic LOAD_ERROR:number      = 4;\n\t\tstatic FILE_STARTED:number    = 5;\n\t\tstatic FILE_PROGRESS:number   = 6;\n\t\tstatic FILE_LOADED:number     = 7;\n\t\tstatic FILE_ERROR:number      = 9;\n\n\n    \tstatic _assetList:any  = {};\n\t\tstatic _weakHandlers:any[] = []; // List of handlers to remove once the load is completed\n\t\tstatic _loadQueue:createjs.LoadQueue  = null;   // CreateJS load queue\n\t\tstatic _loadSignal:Signal = null;\n\n\t\tstatic _fileStartedSignal:Signal  = null;\n\t\tstatic _fileProgressSignal:Signal = null;\n\t\tstatic _fileLoadedSignal:Signal   = null;\n\t\tstatic _fileErrorSignal:Signal    = null;\n\n\t\tstatic _queueStartedSignal:Signal  = null;\n\t\tstatic _queueProgressSignal:Signal = null;\n\t\tstatic _queueLoadedSignal:Signal   = null;\n\t\tstatic _queueErrorSignal:Signal    = null;\n\n\t\tstatic _busy:boolean = false;\n\n\t\tstatic LoadQueue:any;\n\n\t\tstatic startup(params):void{\n\t\t\tDataLoad._loadQueue  = new createjs.LoadQueue(true);\n\t\t\tDataLoad._loadSignal = new Signal();\n\n\t\t\tvar queue = DataLoad._loadQueue;\n\n\t\t\tqueue.on(\"fileload\",     DataLoad.handleFileLoaded);\n\t\t\tqueue.on(\"complete\",     DataLoad.handleLoadComplete);\n\t\t\tqueue.on(\"fileerror\",    DataLoad.handleFileError);\n\t\t\tqueue.on(\"error\",        DataLoad.handleLoaderError);\n\t\t\tqueue.on(\"filestart\",    DataLoad.handleFileStart);\n\t\t\tqueue.on(\"initialize\",   DataLoad.handleLoadInitialize);\n\t\t\tqueue.on(\"loadstart\",    DataLoad.handleLoadStart);\n\t\t\tqueue.on(\"fileprogress\", DataLoad.handleFileProgress);\n\t\t\tqueue.on(\"progress\",     DataLoad.handleOverallProgress);\n\n\t\t\tDataLoad._fileStartedSignal  = new Signal();;\n\t\t\tDataLoad._fileProgressSignal = new Signal();;\n\t\t\tDataLoad._fileLoadedSignal   = new Signal();;\n\t\t\tDataLoad._fileErrorSignal    = new Signal();;\n\n\t\t\tDataLoad._queueStartedSignal  = new Signal();;\n\t\t\tDataLoad._queueProgressSignal = new Signal();;\n\t\t\tDataLoad._queueLoadedSignal   = new Signal();;\n\t\t\tDataLoad._queueErrorSignal    = new Signal();;\n\n\n\t\t\tif(params.manifest != null){\n\t\t\t\t//DataLoad.loadManifest(params.manifest, params.callback)\n\t\t\t}\n\t\t}\n\n\t\tstatic listAssets(manifest):void{\n\t\t\tvar assetList = DataLoad._assetList;\n\t\t\tfor(var i = 0; i < manifest.length; i++){\n\t\t\t\tvar item = manifest[i];\n\t\t\t\tassetList[item.id] = item;\n\t\t\t}\n\t\t}\n\n\t\tstatic loadFromManifest(value:any, loadHandler?:any, persistant:boolean = false):void{\n\t\t\tvar queue     = DataLoad._loadQueue;\n\t\t\tvar manifest  = [];\n\t\t\tfor(var i = 0; i < value.length; i++){\n\t\t\t\tvar v = value[i];\n\t\t\t\tvar item;\n\n\t\t\t\tif(typeof v == \"string\"){\n\t\t\t\t\titem = {\"id\" : v, \"src\" : v};\n\t\t\t\t} else {\n\t\t\t\t\titem = {\"id\" : v.id, \"src\" :  v.src};\n\t\t\t\t}\n\n\t\t\t\tif(!DataLoad._assetList[item.id]){\n\t\t\t\t\tDataLoad._assetList[item.id] = item\n\t\t\t\t}\n\n\t\t\t\tmanifest.push(DataLoad._assetList[item.id]);\n\t\t\t}\n\n\t\t\tDataLoad.addLoadHandler(loadHandler, persistant);\n\t\t\tDataLoad._busy = true;\n\t\t\tqueue.loadManifest(manifest)\n\t\t\t\n\t\t}\n\n\t\tstatic loadAsset(value:any, loadHandler?:any, persistant:boolean = false):void{\n\t\t\tvar queue = DataLoad._loadQueue;\n\t\t\tvar item; \n\n\t\t\tif(typeof value == \"string\"){\n\t\t\t\titem = {\"id\" : value, \"src\" : value};\n\t\t\t} else {\n\t\t\t\titem = {\"id\" : value.id, \"src\" : value.src};\n\t\t\t}\n\n\t\t\tif(!DataLoad._assetList[item.id]){\n\t\t\t\tDataLoad._assetList[item.id] = item\n\t\t\t}\n\n\t\t\tDataLoad.addLoadHandler(loadHandler, persistant);\n\t\t\tDataLoad._busy = true;\n\t\t\tqueue.loadFile(DataLoad._assetList[item.id]);\n\t\t}\n\n\t\tstatic getAsset(id):any{\n\t\t\treturn DataLoad._loadQueue.getResult(id);\n\t\t}\n\n\t\tstatic getData(id):any{\n\t\t\treturn DataLoad._assetList[id];\n\t\t}\n\n\n//=========== HANDLER MANAGEMENT =========\n\t\t\n\t\tstatic addLoadHandler(handler:any, persistant:boolean = false):void{\n\t\t\tif(!handler) return;\n\t\t\tif(!persistant){\n\t\t\t\tDataLoad._weakHandlers.push(handler);\n\t\t\t}\n\n\t\t\tDataLoad._loadSignal.add(handler);\n\t\t}\n\n\t\tstatic removeLoadHandler(handler:any):void{\n\t\t\tfor(var i = DataLoad._weakHandlers.length - 1; i >= 0 && DataLoad._weakHandlers.length > 0; i--){\n\t\t\t\tvar h = DataLoad._weakHandlers[i];\n\t\t\t\tif(h == handler){\n\t\t\t\t\tDataLoad._weakHandlers.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tDataLoad._loadSignal.remove(handler);\t\n\t\t}\n\n\t\tstatic removeWeakHandlers(handlers:any[]):void{\n\t\t\tvar loadSignal = DataLoad._loadSignal;\n\t\t\twhile(handlers.length > 0){\n\t\t\t\tvar handler = handlers.shift();\n\t\t\t\tDataLoad.removeLoadHandler(handler);\n\t\t\t}\n\t\t}\n\n\t\tstatic addCommand(commandID:number, command:any, addOnce:boolean = false):void{\n\t\t\tvar signal;\n\t\t\tswitch(commandID){\n\t\t\t\tcase DataLoad.LOAD_STARTED:\n\t\t\t\t\tsignal = DataLoad._queueStartedSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.FILE_STARTED:\n\t\t\t\t\tsignal = DataLoad._fileStartedSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.LOAD_PROGRESS:\n\t\t\t\t\tsignal = DataLoad._queueProgressSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.FILE_PROGRESS:\n\t\t\t\t\tsignal = DataLoad._fileProgressSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.LOAD_COMPLETE:\n\t\t\t\t\tsignal = DataLoad._queueLoadedSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.FILE_LOADED:\n\t\t\t\t\tsignal = DataLoad._fileLoadedSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.LOAD_ERROR:\n\t\t\t\t\tsignal = DataLoad._queueErrorSignal;\t\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.FILE_ERROR:\n\t\t\t\t\tsignal = DataLoad._fileErrorSignal;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif(addOnce){\n\t\t\t\tsignal.addOnce(command);\n\t\t\t} else {\n\t\t\t\tsignal.add(command);\n\t\t\t}\n\t\t}\n\n\t\tstatic removeCommand(commandID:number, command:any):void{\n\t\t\tvar signal;\n\t\t\tswitch(commandID){\n\t\t\t\tcase DataLoad.LOAD_STARTED:\n\t\t\t\t\tsignal = DataLoad._queueStartedSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.FILE_STARTED:\n\t\t\t\t\tsignal = DataLoad._fileStartedSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.LOAD_PROGRESS:\n\t\t\t\t\tsignal = DataLoad._queueProgressSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.FILE_PROGRESS:\n\t\t\t\t\tsignal = DataLoad._fileProgressSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.LOAD_COMPLETE:\n\t\t\t\t\tsignal = DataLoad._queueLoadedSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.FILE_LOADED:\n\t\t\t\t\tsignal = DataLoad._fileLoadedSignal;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.LOAD_ERROR:\n\t\t\t\t\tsignal = DataLoad._queueErrorSignal;\t\n\t\t\t\t\tbreak;\n\t\t\t\tcase DataLoad.FILE_ERROR:\n\t\t\t\t\tsignal = DataLoad._fileErrorSignal;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tsignal.remove(command);\n\t\t}\n\n//=========== LOAD EVENTS =========\n\n\t\tstatic handleLoadInitialize(event:any):void{\n\t\t\tvar loadSignal = DataLoad._loadSignal;\n\t\t\tloadSignal.dispatch(DataLoad.LOAD_INITIALIZE, event)\n\t\t}\n\n\t\tstatic handleLoadStart(event:any):void{\n\t\t\tLog.output(\"[DataLoad] Load Started!\");\n\t\t\tvar loadSignal = DataLoad._loadSignal;\n\t\t\tloadSignal.dispatch(DataLoad.LOAD_STARTED, event);\n\t\t\tDataLoad._queueStartedSignal.dispatch(event);\n\t\t}\n\n\t\tstatic handleFileStart(event:any):void{\n\t\t\tLog.output(\"[DataLoad] Loading File:\", event.item.id, \"from:\", event.item.src);\n\t\t\tvar loadSignal = DataLoad._loadSignal;\n\t\t\tloadSignal.dispatch(DataLoad.FILE_STARTED, event)\n\t\t\tDataLoad._fileStartedSignal.dispatch(event);\n\t\t}\n\n\t\tstatic handleFileLoaded(event:any):void{\n\t\t\tLog.output(\"[DataLoad] File Loaded:\", event.item.id, \"from:\", event.item.src);\n\t\t\tvar loadSignal = DataLoad._loadSignal;\n\t\t\tloadSignal.dispatch(DataLoad.FILE_LOADED, event)\n\t\t\tDataLoad._fileLoadedSignal.dispatch(event);\n\t\t}\n\n\t\tstatic handleLoadComplete(event:any):void{\n\t\t\tLog.output(\"[DataLoad] Load Completed!\");\n\t\t\tvar loadSignal       = DataLoad._loadSignal;\n\t\t\tvar handlersToRemove = DataLoad._weakHandlers.concat();\n\n\t\t\tloadSignal.dispatch(DataLoad.LOAD_COMPLETE, event);\n\t\t\tDataLoad._queueLoadedSignal.dispatch(event);\n\t\t\tDataLoad.removeWeakHandlers(handlersToRemove);\n\t\t}\n\n\t\tstatic handleFileProgress(event:any):void{\n\t\t\tvar loadSignal = DataLoad._loadSignal;\n\t\t\tloadSignal.dispatch(DataLoad.FILE_PROGRESS, event);\n\t\t\tDataLoad._fileProgressSignal.dispatch(event);\n\t\t}\n\n\t\tstatic handleOverallProgress(event:any):void{\n\t\t\tvar loadSignal = DataLoad._loadSignal;\n\t\t\tloadSignal.dispatch(DataLoad.LOAD_PROGRESS, event);\n\t\t\tDataLoad._queueProgressSignal.dispatch(event);\n\t\t}\n\n\t\tstatic handleFileError(event:any):void{\n\t\t\tvar loadSignal = DataLoad._loadSignal;\n\t\t\tloadSignal.dispatch(DataLoad.FILE_ERROR, event);\n\t\t\tDataLoad._fileErrorSignal.dispatch(event);\n\t\t}\n\n\t\tstatic handleLoaderError(event:any):void{\n\t\t\tvar loadSignal = DataLoad._loadSignal;\n\t\t\tloadSignal.dispatch(DataLoad.LOAD_ERROR, event);\n\t\t\tDataLoad._queueErrorSignal.dispatch(event);\n\t\t}\n\n\n    \tconstructor(argument) {\n    \t\t// code...\n    \t}\n    }\n}","module Animyst {\n    export class Environment {\n\n    \t//========================================\n\t\t//------------- Platform -----------------\n\t\t//========================================\n\n\t\tstatic isDesktop:boolean  = false;\n\t\tstatic isMobile:boolean   = false;\n\t\tstatic isIOS:boolean      = false;\n\t\tstatic isAndroid:boolean  = false;\n\t\tstatic isChromeOS:boolean = false;\n\t\tstatic isMacOS:boolean    = false;\n\t\tstatic isWindows:boolean  = false;\n\t\tstatic isLinux:boolean    = false;\n\n\t\tstatic platformName:string = \"\";\n\n\n\n\t\t//========================================\n\t\t//------------- Device -------------------\n\t\t//========================================\n\n\t\tstatic pixelRatio:number   = 1;\n\t\tstatic colorDepth:number   = -1;\n\t\tstatic screenWidth:number  = -1;\n\t\tstatic screenHeight:number = -1;\n\n\t\t//========================================\n\t\t//------------- Browser ------------------\n\t\t//========================================\n\n\t\tstatic isChrome:boolean   = false;\n\t\tstatic isFirefox:boolean  = false;\n\t\tstatic isIE:boolean       = false;\n\t\tstatic isEdge:boolean     = false;\n\t\tstatic isSafari:boolean   = false;\n\t\tstatic isWebApp:boolean   = false;\n\t\tstatic isCocoonJS:boolean = false;\n\n\t\tstatic browserVersion:string = \"\";\n\t\tstatic browserName:string    = \"\";\n\t\tstatic browserDetails:any    = {};\n\n\t\tstatic url:string         = \"\";\n\t\tstatic host:string        = \"\";\n\t\tstatic path:string        = \"\";\n\t\tstatic port:string        = \"\";\n\t\tstatic queryString:string = \"\";\n\n\t\t//========================================\n\n\t\tstatic _setup():void{\n\t\t\tEnvironment._checkBrowser();\n\t\t\tEnvironment._checkPlatform();\n\t\t\tEnvironment._checkDevice();\n\t\t}\n\n\t\tstatic _checkPlatform():void{\n\t\t\tvar userAgent = navigator.userAgent;\n\n\t\t\tif(/Linux/.test(userAgent)){\n\t\t\t\tEnvironment.platformName = \"Linux\";\n\t\t\t\tEnvironment.isLinux = true;\n\t\t\t}\n\n\t\t\tif(/Android/.test(userAgent)){\n\t\t\t\tEnvironment.platformName = \"Android\";\n\t\t\t\tEnvironment.isAndroid = true;\n\t\t\t}\n\n\t\t\tif(/CrOS/.test(userAgent)){\n\t\t\t\tEnvironment.platformName = \"ChromeOS\";\n\t\t\t\tEnvironment.isChromeOS = true;\n\t\t\t}\n\n\t\t\tif(/iP[ao]d|iPhone/i.test(userAgent)){\n\t\t\t\tEnvironment.platformName = \"iOS\";\n\t\t\t\tEnvironment.isIOS = true;\n\t\t\t}\n\n\t\t\tif(/Mac OS/.test(userAgent)){\n\t\t\t\tEnvironment.platformName = \"Mac\";\n\t\t\t\tEnvironment.isMacOS = true;\n\t\t\t}\n\n\t\t\tif(/Windows/.test(userAgent)){\n\t\t\t\tEnvironment.platformName = \"Windows\";\n\t\t\t\tEnvironment.isWindows = true;\n\t\t\t}\n\n\t\t\tif(Environment.isWindows || Environment.isMacOS || Environment.isLinux){\n\t\t\t\tEnvironment.isDesktop = true;\n\t\t\t}\n\n\t\t\tif(Environment.isAndroid || Environment.isIOS || Environment.isWebApp){\n\t\t\t\tEnvironment.isMobile = true;\n\t\t\t}\n\n\t\t}\n\n\t\tstatic _checkDevice():void{\n\t\t\tEnvironment.pixelRatio = window.devicePixelRatio || 1;\n\t\t\tEnvironment.colorDepth = window.screen.colorDepth;\n\n\t\t\tif(Environment.isMobile){\n\t\t\t\tEnvironment.screenWidth  = window.screen.width  * Environment.pixelRatio;\n\t\t\t\tEnvironment.screenHeight = window.screen.height * Environment.pixelRatio;\n\t\t\t} else {\n\t\t\t\tEnvironment.screenWidth  = window.screen.width;\n\t\t\t\tEnvironment.screenHeight = window.screen.height;\n\t\t\t}\n\t\t}\n\n\t\tstatic _checkBrowser():void{\n\t\t\tvar userAgent = navigator.userAgent;\n\n\t\t\tif(/Safari/.test(userAgent)){\n\t\t\t\tEnvironment.browserName = \"Safari\";\n\t\t\t\tEnvironment.isSafari = true;\n\t\t\t\tEnvironment.browserVersion = (userAgent.indexOf(\"Version\") !=-1) ? userAgent.substring(userAgent.indexOf(\"Version\") + 8) : userAgent.substring(userAgent.indexOf(\"Safari\") + 7);\n\t\t\t}\n\n\t\t\tif(/Mobile(.*)Safari/.test(userAgent)){\n\t\t\t\tEnvironment.browserName = \"MobileSafari\";\n\t\t\t\tEnvironment.isSafari = true;\n\t\t\t\tEnvironment.browserVersion = (userAgent.indexOf(\"Version\") !=-1) ? userAgent.substring(userAgent.indexOf(\"Version\") + 8) : userAgent.substring(userAgent.indexOf(\"Safari\") + 7);\n\t\t\t}\n\n\t\t\tif(/Chrome/.test(userAgent)){\n\t\t\t\tEnvironment.browserName = \"Chrome\";\n\t\t\t\tEnvironment.isChrome = true;\n\t\t\t\tEnvironment.browserVersion = userAgent.substring(userAgent.indexOf(\"Chrome\") + 7, userAgent.indexOf(\" Safari\") || null);\n\t\t\t}\n\n\t\t\tif(/Firefox/.test(userAgent)){\n\t\t\t\tEnvironment.browserName = \"Firefox\";\n\t\t\t\tEnvironment.isFirefox = true;\n\t\t\t\tEnvironment.browserVersion = userAgent.substring(userAgent.indexOf(\"Firefox\") + 8);\n\t\t\t}\n\n\t\t\tif(/MSIE (\\d+\\.\\d+);/.test(userAgent)){\n\t\t\t\tEnvironment.browserName = \"MSIE\";\n\t\t\t\tEnvironment.isIE = true;\n\t\t\t\tEnvironment.browserVersion = userAgent.substring(userAgent.indexOf(\"MSIE\") + 5);\n\t\t\t}\n\n\t\t\tif(/Edge/.test(userAgent)){\n\t\t\t\tEnvironment.browserName = \"MSEdge\";\n\t\t\t\tEnvironment.isEdge = true;\n\t\t\t\tEnvironment.browserVersion = userAgent.substring(userAgent.indexOf(\"Edge\") + 5);\n\t\t\t}\n\n\t\t\tif(navigator['standalone']){\n\t\t\t\tEnvironment.browserName = \"WebApp\";\n\t\t\t\tEnvironment.isWebApp = true;\n\t\t\t}\n\n\t\t\tif(navigator['isCocoonJS']){\n\t\t\t\tEnvironment.browserName = \"CocoonJS\";\n\t\t\t\tEnvironment.isCocoonJS = true;\n\t\t\t}\n\n\n\t\t\tEnvironment.url = window.location.href;\n\t\t\tEnvironment.queryString = window.location.search;\n\t\t\tEnvironment.host = window.location.hostname;\n\t\t\tEnvironment.path = window.location.pathname;\n\t\t\tEnvironment.port = window.location.port;\n\n\t\t\tvar details = Environment.browserVersion.split(\".\");\n\t\t\tswitch(details.length){\n\t\t\t\tcase 1:\n\t\t\t\t\tEnvironment.browserDetails.major = parseInt(details[0]);\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tEnvironment.browserDetails.major = parseInt(details[0]);\n\t\t\t\t\tEnvironment.browserDetails.minor = parseInt(details[1]);\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tEnvironment.browserDetails.major = parseInt(details[0]);\n\t\t\t\t\tEnvironment.browserDetails.minor = parseInt(details[1]);\n\t\t\t\t\tEnvironment.browserDetails.build = parseInt(details[2]);\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tEnvironment.browserDetails.major = parseInt(details[0]);\n\t\t\t\t\tEnvironment.browserDetails.minor = parseInt(details[1]);\n\t\t\t\t\tEnvironment.browserDetails.build = parseInt(details[2]);\n\t\t\t\t\tEnvironment.browserDetails.revision = parseInt(details[3]);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tstatic getURLParameterByName(name:string, escapeSpaces:boolean= false){\n\t\t\tif(escapeSpaces === null) escapeSpaces = true;\n\t\t\tvar match = new RegExp('[?&]' + name + '=([^&]*)').exec(Environment.queryString);\n\t\t\treturn (escapeSpaces) ? match && decodeURIComponent(match[1].replace(/\\/+/g, '')) : match && decodeURIComponent(match[1]);\n\t\t}\n    \t\n    \tconstructor(argument) {\n    \t\t// code...\n    \t}\n    }\n}","module Animyst {\n    export class Item {\n    \t\n    \tpublic id:string;\n    \tpublic startParams:any;\n\n    \tconstructor(id:string, params:any) {\n    \t\t// code...\n    \t\tthis.id = id;\n    \t\tthis.startParams = params;\n    \t\tthis.setup(params);\n    \t}\n\n    \tpublic setup(params:any):void{\n    \t}\n\n    \tpublic reset():void{\n    \t\tthis.setup(this.startParams);\n    \t}\n\n    \tpublic destroy():void{\n    \t\tthis.startParams = null;\n    \t}\n    }\n}\t\t\t","module Animyst {\n    export class Log {\n    \t\n\n    \tstatic output(...args):void{\n\t\t\tif(!LOGGING) return;\n\n\t\t\tvar logData = [];\n\n\t\t\tlogData.push(\":[LOG]:\");\n\n\t\t\tfor(var i = 0; i < args.length; i++){\n\t\t\t\tlogData.push(args[i]);\n\t\t\t}\n\n\t\t\tconsole.log.apply(console, logData);\n\t\t}\n\n\t\tstatic error(...args):void{\n\t\t\tif(!LOGGING) return;\n\n\n\t\t\tvar logData = [];\n\n\t\t\tlogData.push(\":[ERROR]:\");\n\n\t\t\tfor(var i = 0; i < args.length; i++){\n\t\t\t\tlogData.push(args[i]);\n\t\t\t}\n\n\t\t\tconsole.error.apply(console, logData);\n\t\t}\n\n    \tconstructor() {\n    \t}\n    }\n}","/// <reference path=\"Signal.ts\" />\n\n/*\n*\t@desc   \tAn object that represents a binding between a Signal and a listener function.\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.kiwijs.org\n*\n*/\n\nmodule Animyst\n{\n\texport class SignalBinding\n\t{\n\t\t/**\n\t\t* Handler function bound to the signal.\n\t\t* @type Function\n\t\t* @private\n\t\t*/\n\t\tprivate _listener:any;\n\n\t\t/**\n\t\t* If binding should be executed just once.\n\t\t* @type boolean\n\t\t* @private\n\t\t*/\n\t\tprivate _isOnce:boolean;\n\n\t\t/**\n\t\t* Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n\t\t* @memberOf SignalBinding.prototype\n\t\t* @name context\n\t\t* @type Object|undefined|null\n\t\t*/\n\t\tpublic context:any;\n\n\t\t/**\n\t\t* Reference to Signal object that listener is currently bound to.\n\t\t* @type Signal\n\t\t* @private\n\t\t*/\n\t\tprivate _signal:Signal;\n\n\t\t/**\n\t\t* Listener priority\n\t\t* @type Number\n\t\t*/\n\t\tpublic priority:number;\n\n\t\t/**\n\t\t* If binding is active and should be executed.\n\t\t* @type boolean\n\t\t*/\n\t\tpublic active:boolean = true;\n\n\t\t/**\n\t\t* Default parameters passed to listener during `Signal.dispatch` and `SignalBinding.execute`. (curried parameters)\n\t\t* @type Array|null\n\t\t*/\n\t\tpublic params:any[] = null;\n\n\t\t/**\n\t\t* Object that represents a binding between a Signal and a listener function.\n\t\t* <br />- <strong>This is an internal constructor and shouldn't be called by regular users.</strong>\n\t\t* <br />- inspired by Joa Ebert AS3 SignalBinding and Robert Penner's Slot classes.\n\t\t* @author Miller Medeiros\n\t\t* @constructor\n\t\t* @internal\n\t\t* @name SignalBinding\n\t\t* @param {Signal} signal Reference to Signal object that listener is currently bound to.\n\t\t* @param {Function} listener Handler function bound to the signal.\n\t\t* @param {boolean} isOnce If binding should be executed just once.\n\t\t* @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n\t\t* @param {Number} [priority] The priority level of the event listener. (default = 0).\n\t\t*/\n\t\tconstructor(signal:Signal, listener:any, isOnce:boolean, listenerContext:any, priority:number = 0)\n\t\t{\n\n\t\t\tthis._listener = listener;\n\t\t\tthis._isOnce = isOnce;\n\t\t\tthis.context = listenerContext;\n\t\t\tthis._signal = signal;\n\t\t\tthis.priority = priority || 0;\n\n\t\t}\n\n\t\t/**\n\t\t* Call listener passing arbitrary parameters.\n\t\t* <p>If binding was added using `Signal.addOnce()` it will be automatically removed from signal dispatch queue, this method is used internally for the signal dispatch.</p>\n\t\t* @param {Array} [paramsArr] Array of parameters that should be passed to the listener\n\t\t* @return {*} Value returned by the listener.\n\t\t*/\n\t\tpublic execute(paramsArr?:any[])\n\t\t{\n\t\t\tvar handlerReturn;\n\t\t\tvar params;\n\n\t\t\tif (this.active && !!this._listener)\n\t\t\t{\n\t\t\t\tparams = this.params ? this.params.concat(paramsArr) : paramsArr;\n\n\t\t\t\thandlerReturn = this._listener.apply(this.context, params);\n\n\t\t\t\tif (this._isOnce)\n\t\t\t\t{\n\t\t\t\t\tthis.detach();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn handlerReturn;\n\t\t}\n\n\t\t/**\n\t\t* Detach binding from signal.\n\t\t* - alias to:mySignal.remove(myBinding.getListener());\n\t\t* @return {Function|null} Handler function bound to the signal or `null` if binding was previously detached.\n\t\t*/\n\t\tpublic detach()\n\t\t{\n\t\t\treturn this.isBound() ? this._signal.remove(this._listener, this.context) : null;\n\t\t}\n\n\t\t/**\n\t\t* @return {Boolean} `true` if binding is still bound to the signal and have a listener.\n\t\t*/\n\t\tpublic isBound():boolean\n\t\t{\n\t\t\treturn (!!this._signal && !!this._listener);\n\t\t}\n\n\t\t/**\n\t\t* @return {boolean} If SignalBinding will only be executed once.\n\t\t*/\n\t\tpublic isOnce():boolean\n\t\t{\n\t\t\treturn this._isOnce;\n\t\t}\n\n\t\t/**\n\t\t* @return {Function} Handler function bound to the signal.\n\t\t*/\n\t\tpublic getListener():any\n\t\t{\n\t\t\treturn this._listener;\n\t\t}\n\n\t\t/**\n\t\t* @return {Signal} Signal that listener is currently bound to.\n\t\t*/\n\t\tpublic getSignal():any\n\t\t{\n\t\t\treturn this._signal;\n\t\t}\n\n\t\t/**\n\t\t* Delete instance properties\n\t\t* @private\n\t\t*/\n\t\tpublic _destroy():void\n\t\t{\n\t\t\tdelete this._signal;\n\t\t\tdelete this._listener;\n\t\t\tdelete this.context;\n\t\t}\n\n\t\t/**\n\t\t* @return {string} String representation of the object.\n\t\t*/\n\t\tpublic toString():string\n\t\t{\n\t\t\treturn '[SignalBinding isOnce:' + this._isOnce + ', isBound:' + this.isBound() + ', active:' + this.active + ']';\n\t\t}\n\n\t}\n}","/// <reference path=\"SignalBinding.ts\" />\n\n/**\n*\t@desc       A TypeScript conversion of JS Signals by Miller Medeiros\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.photonstorm.com\n*/\n\n/**\n* Custom event broadcaster\n* <br />- inspired by Robert Penner's AS3 Signals.\n* @name Signal\n* @author Miller Medeiros\n* @constructor\n*/\n\nmodule Animyst\n{\n\texport class Signal {\n\n\t\t/**\n\t\t* @property _bindings\n\t\t* @type Array\n\t\t* @private\n\t\t*/\n\t\tprivate _bindings:SignalBinding[] = [];\n\n\t\t/**\n\t\t* @property _prevParams\n\t\t* @type Any\n\t\t* @private\n\t\t*/\n\t\tprivate _prevParams = null;\n\n\t\t/**\n\t\t* Signals Version Number\n\t\t* @property VERSION\n\t\t* @type String\n\t\t* @const\n\t\t*/\n\t\tpublic static VERSION:string = '1.0.0';\n\n\t\t/**\n\t\t* If Signal should keep record of previously dispatched parameters and\n\t\t* automatically execute listener during `add()`/`addOnce()` if Signal was\n\t\t* already dispatched before.\n\t\t* @type boolean\n\t\t*/\n\t\tpublic memorize:boolean = false;\n\n\t\t/**\n\t\t* @type boolean\n\t\t* @private\n\t\t*/\n\t\tprivate _shouldPropagate:boolean = true;\n\n\t\t/**\n\t\t* If Signal is active and should broadcast events.\n\t\t* <p><strong>IMPORTANT:</strong> Setting this property during a dispatch will only affect the next dispatch, if you want to stop the propagation of a signal use `halt()` instead.</p>\n\t\t* @type boolean\n\t\t*/\n\t\tpublic active:boolean = true;\n\n\t\t/**\n\t\t* @method validateListener\n\t\t* @param {Any} listener\n\t\t* @param {Any} fnName\n\t\t*/\n\t\tpublic validateListener(listener, fnName) {\n\n\t\t\tif (typeof listener !== 'function')\n\t\t\t{\n\t\t\t\tthrow new Error('listener is a required param of {fn}() and should be a Function.'.replace('{fn}', fnName));\n\t\t\t}\n\n\t\t}\n\n\t\t/**\n\t\t* @param {Function} listener\n\t\t* @param {boolean} isOnce\n\t\t* @param {Object} [listenerContext]\n\t\t* @param {Number} [priority]\n\t\t* @return {SignalBinding}\n\t\t* @private\n\t\t*/\n\t\tprivate _registerListener(listener, isOnce:boolean, listenerContext, priority:number):SignalBinding {\n\n\t\t\tvar prevIndex:number = this._indexOfListener(listener, listenerContext);\n\t\t\tvar binding:SignalBinding;\n\n\t\t\tif (prevIndex !== -1)\n\t\t\t{\n\t\t\t\tbinding = this._bindings[prevIndex];\n\n\t\t\t\tif (binding.isOnce() !== isOnce)\n\t\t\t\t{\n\t\t\t\t\tthrow new Error('You cannot add' + (isOnce ? '' :'Once') + '() then add' + (!isOnce ? '' :'Once') + '() the same listener without removing the relationship first.');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbinding = new SignalBinding(this, listener, isOnce, listenerContext, priority);\n\n\t\t\t\tthis._addBinding(binding);\n\t\t\t}\n\n\t\t\tif (this.memorize && this._prevParams)\n\t\t\t{\n\t\t\t\tbinding.execute(this._prevParams);\n\t\t\t}\n\n\t\t\treturn binding;\n\n\t\t}\n\n\t\t/**\n\t\t* @method _addBinding\n\t\t* @param {SignalBinding} binding\n\t\t* @private\n\t\t*/\n\t\tprivate _addBinding(binding:SignalBinding) {\n\n\t\t\t//simplified insertion sort\n\n\t\t\tvar n:number = this._bindings.length;\n\n\t\t\tdo { --n; } while (this._bindings[n] && binding.priority <= this._bindings[n].priority);\n\n\t\t\tthis._bindings.splice(n + 1, 0, binding);\n\n\t\t}\n\n\t\t/**\n\t\t* @method _indexOfListener\n\t\t* @param {Function} listener\n\t\t* @return {number}\n\t\t* @private\n\t\t*/\n\t\tprivate _indexOfListener(listener, context):number {\n\n\t\t\tvar n:number = this._bindings.length;\n\t\t\tvar cur:SignalBinding;\n\n\t\t\twhile (n--)\n\t\t\t{\n\t\t\t\tcur = this._bindings[n];\n\n\t\t\t\tif (cur.getListener() === listener && cur.context === context)\n\t\t\t\t{\n\t\t\t\t\treturn n;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn -1;\n\n\t\t}\n\n\t\t/**\n\t\t* Check if listener was attached to Signal.\n\t\t* @param {Function} listener\n\t\t* @param {Object} [context]\n\t\t* @return {boolean} if Signal has the specified listener.\n\t\t*/\n\t\tpublic has(listener, context?:any):boolean {\n\n\t\t\treturn this._indexOfListener(listener, context) !== -1;\n\n\t\t}\n\n\t\t/**\n\t\t* Add a listener to the signal.\n\t\t* @param {Function} listener Signal handler function.\n\t\t* @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n\t\t* @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n\t\t* @return {SignalBinding} An Object representing the binding between the Signal and listener.\n\t\t*/\n\t\tpublic add(listener, listenerContext?:any, priority:number = 0):SignalBinding {\n\n\t\t\tthis.validateListener(listener, 'add');\n\n\t\t\treturn this._registerListener(listener, false, listenerContext, priority);\n\n\t\t}\n\n\t\t/**\n\t\t* Add listener to the signal that should be removed after first execution (will be executed only once).\n\t\t* @param {Function} listener Signal handler function.\n\t\t* @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n\t\t* @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n\t\t* @return {SignalBinding} An Object representing the binding between the Signal and listener.\n\t\t*/\n\t\tpublic addOnce(listener, listenerContext?:any, priority:number = 0):SignalBinding {\n\n\t\t\tthis.validateListener(listener, 'addOnce');\n\n\t\t\treturn this._registerListener(listener, true, listenerContext, priority);\n\n\t\t}\n\n\t\t/**\n\t\t* Remove a single listener from the dispatch queue.\n\t\t* @param {Function} listener Handler function that should be removed.\n\t\t* @param {Object} [context] Execution context (since you can add the same handler multiple times if executing in a different context).\n\t\t* @return {Function} Listener handler function.\n\t\t*/\n\t\tpublic remove(listener, context?:any) {\n\n\t\t\tthis.validateListener(listener, 'remove');\n\n\t\t\tvar i:number = this._indexOfListener(listener, context);\n\n\t\t\tif (i !== -1)\n\t\t\t{\n\t\t\t\tthis._bindings[i]._destroy(); //no reason to a SignalBinding exist if it isn't attached to a signal\n\t\t\t\tthis._bindings.splice(i, 1);\n\t\t\t}\n\n\t\t\treturn listener;\n\n\t\t}\n\n\t\t/**\n\t\t* Remove all listeners from the Signal.\n\t\t*/\n\t\tpublic removeAll() {\n\n\t\t\tvar n:number = this._bindings.length;\n\n\t\t\twhile (n--)\n\t\t\t{\n\t\t\t\tthis._bindings[n]._destroy();\n\t\t\t}\n\n\t\t\tthis._bindings.length = 0;\n\n\t\t}\n\n\t\t/**\n\t\t* @return {number} Number of listeners attached to the Signal.\n\t\t*/\n\t\tpublic getNumListeners():number {\n\n\t\t\treturn this._bindings.length;\n\n\t\t}\n\n\t\t/**\n\t\t* Stop propagation of the event, blocking the dispatch to next listeners on the queue.\n\t\t* <p><strong>IMPORTANT:</strong> should be called only during signal dispatch, calling it before/after dispatch won't affect signal broadcast.</p>\n\t\t* @see Signal.prototype.disable\n\t\t*/\n\t\tpublic halt() {\n\n\t\t\tthis._shouldPropagate = false;\n\n\t\t}\n\n\t\t/**\n\t\t* Dispatch/Broadcast Signal to all listeners added to the queue.\n\t\t* @param {...*} [params] Parameters that should be passed to each handler.\n\t\t*/\n\t\tpublic dispatch(...paramsArr:any[]) {\n\n\t\t\tif (!this.active)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar n:number = this._bindings.length;\n\t\t\tvar bindings:SignalBinding[];\n\n\t\t\tif (this.memorize)\n\t\t\t{\n\t\t\t\tthis._prevParams = paramsArr;\n\t\t\t}\n\n\t\t\tif (!n)\n\t\t\t{\n\t\t\t\t//should come after memorize\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tbindings = this._bindings.slice(0); //clone array in case add/remove items during dispatch\n\n\t\t\tthis._shouldPropagate = true; //in case `halt` was called before dispatch or during the previous dispatch.\n\n\t\t\t//execute all callbacks until end of the list or until a callback returns `false` or stops propagation\n\t\t\t//reverse loop since listeners with higher priority will be added at the end of the list\n\t\t\tdo { n--; } while (bindings[n] && this._shouldPropagate && bindings[n].execute(paramsArr) !== false);\n\n\t\t}\n\n\t\t/**\n\t\t* Forget memorized arguments.\n\t\t* @see Signal.memorize\n\t\t*/\n\t\tpublic forget() {\n\n\t\t\tthis._prevParams = null;\n\n\t\t}\n\n\t\t/**\n\t\t* Remove all bindings from signal and destroy any reference to external objects (destroy Signal object).\n\t\t* <p><strong>IMPORTANT:</strong> calling any method on the signal instance after calling dispose will throw errors.</p>\n\t\t*/\n\t\tpublic dispose() {\n\n\t\t\tthis.removeAll();\n\n\t\t\tdelete this._bindings;\n\t\t\tdelete this._prevParams;\n\n\t\t}\n\n\t\t/**\n\t\t* @return {string} String representation of the object.\n\t\t*/\n\t\tpublic toString():string {\n\n\t\t\treturn '[Signal active:' + this.active + ' numListeners:' + this.getNumListeners() + ']';\n\n\t\t}\n\n\t}\n}\n","module Animyst {\n    export class System {\n\n    \tprotected _paused:boolean;\n    \tpublic get paused():boolean{return this._paused};\n\n    \tprotected _started:boolean;\n    \tpublic get started():boolean{return this._started};\n\n    \tprivate _startupParams:any;\n\n\n\t\tpublic startup(params?:any):void{\n\t\t\tthis._started = true;\n\t\t\tthis._startupParams = params;\n\t\t}\n\n\t\tpublic shutdown():void{\n\t\t\tthis._started = false;\n\n\t\t}\n\n\t\tpublic update(delta:number, framecount:number):void{\n\n\t\t}\n\n\t\tpublic fixedUpdate(timestep:number, time:number):void{\n\n\t\t}\n\n\n    \tconstructor() {\n    \t}\n    }\n}","module Animyst {\n    export class Window {\n    \tstatic get orientation():any{return window.orientation};\n    \tstatic get isLandscape():boolean{return window.innerWidth > window.innerHeight};\n    \tstatic get isPortrait():boolean{return window.innerHeight > window.innerWidth};\n    \tstatic get width():number{return document.documentElement.clientWidth};\n    \tstatic get height():number{return document.documentElement.clientHeight};\n    \tstatic resizeSignal:Signal = new Signal();\n    \tstatic _onResize(evt:any):void{\n    \t\tLog.output(\"[Window] onResize!\")\n\t\t\tWindow.resizeSignal.dispatch(evt);\n    \t}\n\n    \tstatic _onWindowLoad(evt:any):void{\n    \t\tLog.output(\"[Window] Window loaded:\" , \"w:\", Window.width, \"h:\", Window.height)\n    \t}\n\n    \tstatic _setup():void{\n    \t\twindow.addEventListener(\"resize\", Window._onResize);\n\t\t\twindow.addEventListener(\"load\", Window._onWindowLoad);\n    \t}\n    }\n}\n\nAnimyst.Window._setup();\n","module Animyst {\n    export class Sound  {\n    \t\n    \tconstructor() {\n    \t}\n    }\n}","module Animyst {\n    export class PIXITexture extends THREE.Texture {\n\n    \tpublic stage:any;\n    \tpublic renderer:any;\n    \tpublic shouldUpdate:boolean;\n    \tpublic width:number;\n    \tpublic height:number\n\n    \tpublic _init(){\n\t\t\tthis.image = this.renderer.view;\n\n\n\t\t\tlet graphics = new PIXI.Graphics();\n\t\t\tgraphics.lineStyle(2, 0xFF00FF, 1);\n\t\t\tgraphics.beginFill(0xFF00BB, 0.25);\n\t\t\tgraphics.drawCircle(this.width/2, this.height/2, 100);\n\t\t\tgraphics.endFill();\n\n\t\t\tlet texture = PIXI.Texture.fromCanvas(DataLoad.getAsset('samusftilt'));\n\t\t\tlet sprite = new PIXI.Sprite(texture);\n\t\t\tthis.stage.addChild(sprite);\n\n\n\t\t\tthis.stage.addChild(graphics);\n\n\t\t\tthis.invalidate();\n\t\t\tthis.update();\n\t\t}\n\n\t\tpublic invalidate(){\n\t\t\t this.shouldUpdate = true; \n\t\t};\n\n\t\tpublic update(){\n\t\t\t if(this.shouldUpdate){\n\t\t\t \tthis.renderer.render(this.stage);\n\t\t\t \tthis.needsUpdate = true;\n\t\t\t \tthis.shouldUpdate = false;\n\t\t\t } \n\t\t};\n\n    \t\n    \tconstructor(stage:any, renderer:any) {\n    \t\tsuper();\n\n    \t\tthis.stage = stage;\n    \t\tthis.renderer = renderer;\n\n    \t\tthis.width = renderer.view.width;\n    \t\tthis.height = renderer.view.height;\n    \t\tthis._init();\n    \t}\n    }\n}","module Animyst {\n    export class SpriteSheetTexture extends THREE.Texture {\n    \t\n    \tpublic atlas:any;\n    \tpublic frames:any[];\n    \tpublic stage:PIXI.Container;\n    \tpublic renderer:any;\n    \tpublic playTime:number = 0;\n    \tpublic time:number = 0;\n    \tpublic loop:boolean;\n    \tpublic currentFrame:number = 0;\n    \tpublic currentFrameID:string = \"\";\n    \tpublic sprite:any = null;\n    \tpublic renderWidth:number = 0;\n    \tpublic renderHeight:number = 0;\n    \tpublic sourceFile:string = \"\";\n    \tpublic playing:boolean;\n    \tpublic timePassed:number = 0;\n\n    \tconstructor(atlas:any) {\n    \t\tsuper();\n\n\t\t\tthis.addSheet(atlas); \n    \t}\n\n    \tprivate _initSprite(startFrame):void{\n\n\t\t\tthis.stage    = new PIXI.Container();\n\t\t\tthis.renderer = PIXI.autoDetectRenderer(256, 256, {transparent : true});\n\t\t\tthis.sprite   = new PIXI.Sprite(PIXI.Texture.fromFrame(startFrame));\n\n\t\t\tthis.image = this.renderer.view;\n\n\t\t\tthis.stage.addChild(this.sprite);\n\t\t\tthis.renderer.render(this.stage);\n\n\t\t\tthis.needsUpdate = true;\n\t\t} \n\n\t\tpublic addSheet(atlas:any):void{\n\t\t\tthis.atlas = atlas;\n\t\t\tthis.frames = [];\n\n\n\t\t\tfor(var k in atlas.frames){\n\t\t\t\tvar frame = atlas.frames[k];\n\n\t\t\t\tif(frame.frame.w > this.renderWidth){\n\t\t\t\t\tthis.renderWidth = frame.frame.w % 2 == 0 ? frame.frame.w : frame.frame.w + 1;\n\n\t\t\t\t} \n\n\t\t\t\tif(frame.frame.h > this.renderHeight){\n\t\t\t\t\tthis.renderHeight = frame.frame.h % 2 == 0 ? frame.frame.h : frame.frame.h + 1;\n\t\t\t\t} \n\n\t\t\t\tthis.frames.push(k);\n\t\t\t}\n\n\t\t\tif(!this.sprite){\n\t\t\t\tthis._initSprite(this.frames[0]);\n\t\t\t\tthis.currentFrameID = this.frames[0];\n\t\t\t\tthis.currentFrame = 0;\n\t\t\t} \n\t\t}\n\n\t\tpublic showFrame(frame?:number):void{\n\t\t\tif(this.frames.length <= 0) return;\n\t\t\tif(!frame) frame = this.currentFrame || 0;\n\n\t\t\tvar thisFrame\n\n\t\t\tif(typeof frame == \"string\"){\n\t\t\t\tthisFrame = frame;\n\t\t\t} else if(typeof frame == \"number\"){\n\t\t\t\tthisFrame = this.frames[frame];\n\t\t\t}\n\n\t\t\tthis.sprite.setTexture(PIXI.Texture.fromFrame(thisFrame));\n\t\t\tthis.renderer.render(this.stage);\n\t\t\tthis.needsUpdate = true;\n\t\t\t\n\t\t}\n\n\t\tpublic play(time:number, loop:boolean):void{\n\t\t\tif(this.frames.length <= 0) return;\n\t\t\tthis.playing  = true;\n\t\t\tthis.loop     = loop;\n\t\t\tthis.playTime = time;\n\t\t\tthis.time     = 0;\n\n\t\t}\n\n\t\tpublic stop():void{\n\t\t\tthis.playing = false;\n\t\t\tthis.timePassed = 0;\n\t\t}\n\n\t\tpublic animate(delta:number, runtime?:number):void{\n\t\t\tif(this.playing){\n\t\t\t\t//console.log(delta, time, this.time, this.playTime, this.currentFrame, this.sourceFile)\n\t\t\t\tif(this.time >= this.playTime){\n\n\t\t\t\t\tif(this.loop){\n\t\t\t\t\t\tthis.time = 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.playing = false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.time += delta;\n\t\t\t\t\tthis.currentFrame = Math.round((this.time / this.playTime) * (this.frames.length - 1))\n\t\t\t\t\tif(this.currentFrame >= this.frames.length) this.currentFrame = this.frames.length - 1;\n\n\t\t\t\t\tthis.showFrame();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n    }\n}","module Animyst {\n    export class View3D extends Database {\n    \t\n    \tpublic viewAngle:number;\n    \tpublic near:number;\n    \tpublic far:number;\n    \t\n    \tprivate _scene:THREE.Scene;\n    \tprivate _renderer:THREE.WebGLRenderer;\n    \tprivate _camera:THREE.Camera;\n    \tprivate _container:any;\n    \tprivate _settings:any;\n    \tprivate _resize:boolean;\n    \tprivate _ui:any;\n    \tprivate _view:any;\n    \tprivate _context2d:CanvasRenderingContext2D;\n\n    \tpublic get aspect():number{ return this.width / this.height};\n\n\n    \tpublic width:number;\n    \tpublic height:number;\n\n\n\n    \tconstructor() {\n    \t\tsuper();\n    \t}\n\n\t\tpublic clear():void{\n\n\t\t\tDatabase.prototype.clear.call(this);\n\t\t}\n\n\t\tpublic destroy():void{\n\n\t\t\tDatabase.prototype.destroy.call(this);\n\t\t}\n\n\t\tpublic initDisplay(params:any):void{\n\t\t\tif(!params){\n\t\t\t\tLog.error(\"[View3D] No initialization params specified\");\n\t\t\t \treturn;\t\n\t\t\t} \n\n\t\t\tthis.viewAngle = params.viewAngle || this.viewAngle;\n\t\t\tthis.near = params.near || this.near;\n\t\t\tthis.far = params.far || this.far;\n\t\t\tthis._resize = params.resize;\n\n\t\t\tthis._scene    = this._scene || new THREE.Scene();\n\t\t\tthis._renderer = new THREE.WebGLRenderer();\n\t\t\tthis._camera   = new THREE.PerspectiveCamera(this.viewAngle, this.aspect, this.near, this.far);\n\n\t\t\tthis._scene.add(this._camera);\n\n\t\t\tthis._camera.lookAt(this._scene.position);\n\n\t\t\tif(params.container){\n\t\t\t\tvar container = document.getElementById(params.container);\n\t\t\t\tif(container)\t{\n\t\t\t\t\tcontainer.appendChild(this._renderer.domElement);\n\t\t\t\t} else {\n\t\t\t\t\tLog.error(\"[View3D] Container ID\", params.container, \"doesn't exist\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._camera.position.x = params.cameraX || 500;\n\t\t\tthis._camera.position.y = params.cameraY || 500;\n\t\t\tthis._camera.position.z = params.cameraZ || 500;\n\n\t\t\tthis._camera.lookAt(this._scene.position);\n\n\t\t\tthis._renderer.setClearColor(params.rendererColor || 0x888888);\n\t\t\tthis._renderer.setSize(this.width, this.height);\n\t\t\t//this._renderer.shadowMapEnabled = false;\n\n\t\t\t/*var geom = new THREE.PlaneGeometry(this.width, this.height, 32 );\n\t\t\tvar texture = new PIXITexture(new PIXI.Stage(0xFFFFFF), new PIXI.WebGLRenderer(this.width, this.height, {transparent : true}));\n\t\t\tvar matr = new THREE.MeshBasicMaterial({map:texture, side:THREE.DoubleSide});\n\t\t\tmatr.transparent = true;\n\t\t\tthis.ui = new THREE.Mesh( geom, matr);\n\n\t\t\tlet vFOV = this.camera.fov * (Math.PI / 180);\n\t\t\tlet distance =  this.height / (2 * Math.tan(vFOV / 2));\n\n\t\t\tthis.ui.position.set(0,0, -distance);\n\t\t\tthis.scene.add(this.ui);\n\n\t\t\tthis.camera.add(this.ui);*/\n\n\n\t\t\t/*this.stage    = new PIXI.Stage(0xFFFFFF);\n\t\t\tthis.uiRenderer = new PIXI.WebGLRenderer(this.width, this.height, {transparent : true});\n\n\t\t\tthis.image = this.renderer.view;\n\n\t\t\tlet graphics = new PIXI.Graphics();\n\t\t\tgraphics.lineStyle(2, 0xFF00FF, 1);\n\t\t\tgraphics.beginFill(0xFF00BB, 0.25);\n\t\t\tgraphics.drawCircle(this.width/2, this.height/2, 100, 100);\n\t\t\tgraphics.endFill();\n\n\t\t\tlet texture = PIXI.Texture.fromCanvas(DataLoad.getAsset('samusftilt'));\n\t\t\tlet sprite = new PIXI.Sprite(texture);\n\t\t\tthis.stage.addChild(sprite);\n\n\t\t\tthis.stage.addChild(graphics);\n\n\t\t \tthis.uiRenderer.render(this.stage);*/\n\n\t\t\tif(params.addAxis){\n\t\t\t\tvar axis = new THREE.AxisHelper(20);\n\t\t\t\tthis._scene.add(axis);\n\t\t\t}\n\n\t\t\tif(params.debugControls){\n\t\t\t\tvar controls = new THREE.OrbitControls(this._camera);\n\n\t\t\t\tif(GUI){\n\t\t\t\t\tvar displayControls = GUI.addFolder(\"Viewport3D\");\n\t\t\t\t\tvar c_folder = displayControls.addFolder(\"camera\");\n\n\t\t\t\t\tc_folder.add(this._camera.position, \"x\", -1000, 1000).listen();\n\t\t\t\t\tc_folder.add(this._camera.position, \"y\", -1000, 1000).listen();\n\t\t\t\t\tc_folder.add(this._camera.position, \"z\", -1000, 1000).listen();\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\n\t\t\tif(params.resize){\n\t\t\t\tAnimyst.Window.resizeSignal.add(this.onResize, this);\n\t\t\t}\n\n\t\t\tthis._view = document.createElement('canvas');\n\t\t\tthis._view.width = this.width;\n\t\t\tthis._view.height = this.height;\n\t\t\tthis._context2d = this._view.getContext('2d');\n\n\t\t}\n\n\n\t\tpublic append(containerID):void{\n\n\t\t\tif(!containerID){\n\t\t\t\tdocument.body.appendChild(this._renderer.domElement);\n\t\t\t\t//document.body.appendChild(this.view);\n\t\t\t} else {\n\t\t\t\tvar container = document.getElementById(containerID);\n\t\t\t\tif(container)\t{\n\t\t\t\t\tcontainer.appendChild(this._renderer.domElement);\n\t\t\t\t\t//container.appendChild(this.view);\n\t\t\t\t} else {\n\t\t\t\t\tLog.error(\"[Viewport3D] Container ID\", containerID, \"doesn't exist\");\n\t\t\t\t}\t\n\t\t\t}\n\t\t\t\n\t\t}\n\n\n\t\tpublic render():void{\n\t\t\tthis._renderer.render(this._scene, this._camera);\n\n\t\t\t//this.context2d.clearRect(0,0, this.view.width, this.view.height);\n\t\t\t//this.context2d.drawImage(this.renderer.domElement, 0, 0);\n\t\t\t//this.context2d.drawImage(this.uiRenderer.view, 0, 0);\n\t\t}\n\n\t\tpublic update():void{\n\t\t}\n\n\t\tpublic onResize():void{\n\t\t\t//this.renderer.setSize(Animyst.)\n\t\t}\n\n\n    }\n}","module Animyst {\n    export class Input extends System {\n\n\t\tstatic KEY_DOWN:number      = 0;\n\t\tstatic KEY_UP:number        = 1;\n\n\t\tstatic TOUCH_START:number   = 0;\n\t\tstatic TOUCH_MOVE:number    = 1;\n\t\tstatic TOUCH_RELEASE:number = 2;\n\t\tstatic TOUCH_ENTER:number   = 3;\n\t\tstatic TOUCH_LEAVE:number   = 4;\n\n\t\tstatic MOUSE_DOWN:number    = 5;\n\t\tstatic MOUSE_UP:number      = 6;\n\t\tstatic MOUSE_DRAG:number    = 7;\n\t\tstatic MOUSE_MOVE:number    = 8;\n\t\tstatic MOUSE_ENTER:number   = 9;\n\t\tstatic MOUSE_LEAVE:number   = 10;\n\t\tstatic MOUSE_CLICK:number   = 11;\n    \t\n    \tpublic inputData:any;\n    \tpublic keyboardSettings:any;\n\n    \tconstructor(inputData:any) {\n    \t\tsuper();\n    \t\tthis.inputData = inputData;\n    \t}\n\n    \tpublic startup(params){\n\t\t\tvar element = params.element;\n\t\t\tvar tool    = params.tool;\n\t\t\tthis.keyboardSettings = params.keyboardSettings;\n\n\t\t\tif(tool){\n\t\t\t\ttool.onKeyUp     = this.onKeyUp.bind(this);\n\t\t\t\ttool.onKeyDown   = this.onKeyDown.bind(this);\n\t\t\t\ttool.onMouseDown = this.onMouseDown.bind(this);\n\t\t\t\ttool.onMouseUp   = this.onMouseUp.bind(this);\t\n\t\t\t\ttool.onMouseDrag = this.onMouseDrag.bind(this);\n\t\t\t\ttool.onMouseMove = this.onMouseMove.bind(this);\t\t\n\t\t\t}\n\n\t\t\tif(element){\n\t\t\t\telement.addEventListener('touchstart', this.onTouchStart.bind(this));\n\t\t\t\telement.addEventListener('touchmove', this.onTouchMove.bind(this));\n\t\t\t\telement.addEventListener('touchend', this.onTouchRelease.bind(this));\n\t\t\t\telement.addEventListener('touchenter', this.onTouchEnter.bind(this));\n\t\t\t\telement.addEventListener('touchleave', this.onTouchLeave.bind(this));\n\n\t\t\t\telement.addEventListener('mousedown', this.onMouseDown.bind(this));\n\t\t\t\telement.addEventListener('mouseup', this.onMouseUp.bind(this));\n\t\t\t\telement.addEventListener('mousemove', this.onMouseMove.bind(this));\n\t\t\t\telement.addEventListener('mouseenter', this.onMouseEnter.bind(this));\n\t\t\t\telement.addEventListener('mouseleave', this.onMouseLeave.bind(this));\n\n\t\t\t\telement.addEventListener('keydown', this.onKeyDown.bind(this));\n\t\t\t\telement.addEventListener('keyup', this.onKeyUp.bind(this));\n\t\t\t}\n\n\t\t\tSystem.prototype.startup.call(this, params);\n\t\t}\n\n\t\tpublic shutdown():void{\n\t\t\tthis.inputData = null;\n\t\t\tSystem.prototype.shutdown.call(this);\n\t\t}\n\n\t\tpublic update(delta:number, runtime:number):void{\n\t\t\tthis.inputData.onTick(delta);\n\t\t}\n\n\t\t//=============== TOUCH EVENTS ======================//\n\n\t\tpublic onTouchStart(evt):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Touch Start!\");\n\t\t\tthis.handleTouchInput(Input.TOUCH_START, evt);\n\t\t}\n\n\t\tpublic onTouchMove(evt):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Touch Move!\");\n\t\t\tthis.handleTouchInput(Input.TOUCH_MOVE, evt);\n\t\t}\n\n\t\tpublic onTouchRelease(evt):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Touch Release!\");\n\t\t\tthis.handleTouchInput(Input.TOUCH_RELEASE, evt);\n\t\t}\n\n\t\tpublic onTouchEnter(evt):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Touch Enter!\");\n\t\t\tthis.handleTouchInput(Input.TOUCH_ENTER, evt);\n\t\t}\n\n\t\tpublic onTouchLeave(evt):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Touch Leave!\");\n\t\t\tthis.handleTouchInput(Input.TOUCH_LEAVE, evt);\n\t\t}\n\n\n\t\t//================= MOUSE EVENTS =====================//\n\n\t\tpublic onClick(evt:any):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Click!\");\n\t\t\tthis.handleMouseInput(Input.MOUSE_CLICK, evt);\n\t\t}\n\n\t\tpublic onMouseDown(evt:any):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Down!\");\n\t\t\tthis.handleMouseInput(Input.MOUSE_DOWN, evt);\n\t\t}\n\n\t\tpublic onMouseDrag(evt:any):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Drag!\");\n\t\t\tthis.handleMouseInput(Input.MOUSE_DRAG, evt);\n\t\t}\n\n\t\tpublic onMouseMove(evt:any):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Move!\");\n\t\t\tthis.handleMouseInput(Input.MOUSE_MOVE, evt);\n\t\t}\n\n\t\tpublic onMouseUp(evt:any):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Up!\");\n\t\t\tthis.handleMouseInput(Input.MOUSE_UP, evt);\n\t\t}\n\n\t\tpublic onMouseEnter(evt:any):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Enter!\");\n\t\t\tthis.handleMouseInput(Input.MOUSE_ENTER, evt);\n\t\t}\n\n\t\tpublic onMouseLeave(evt:any):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Leave!\");\n\t\t\tthis.handleMouseInput(Input.MOUSE_LEAVE, evt);\n\t\t}\n\n\t\t//================ KEYBOARD EVENTS ===================//\n\n\t\tpublic onKeyUp(evt:any):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Released Key:\", evt.key || InputData.KEY_NAMES[evt.keyCode]);\n\t\t\tif(!this.keyboardSettings.allowDefault[evt.key || InputData.KEY_NAMES[evt.keyCode]]){\n\t\t\t\tevt.preventDefault();\n\t\t\t}\n\t\t\tthis.handleKeyInput(Input.KEY_UP, evt.keyCode || InputData.KEY_CODES[evt.key]);\n\t\t}\n\n\n\t\tpublic onKeyDown(evt:any):void{\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Pressed Key:\", evt.key || InputData.KEY_NAMES[evt.keyCode]);\n\t\t\tif(!this.keyboardSettings.allowDefault[evt.key || InputData.KEY_NAMES[evt.keyCode]]){\n\t\t\t\tevt.preventDefault();\n\t\t\t}\n\n\t\t\tthis.handleKeyInput(Input.KEY_DOWN, evt.keyCode || InputData.KEY_CODES[evt.key]);\n\t\t}\n\n\t\t//====================================================//\n\n\t\tpublic handleMouseInput(type:number, evt:any):void{\n\t\t \t//console.log(evt);\n\t\t \tvar down;\n\n\t\t \tif(type == Input.MOUSE_DOWN || type == Input.MOUSE_DRAG){\n\t\t \t\tdown = true;\n\t\t \t}\n\n\t\t \tif(type == Input.MOUSE_UP || type == Input.MOUSE_LEAVE){\n\t\t \t\tdown = false;\n\t\t \t}\n\n\t\t \tthis.inputData.setMouseInput(evt, down);\n\t\t}\n\n\t\tpublic handleKeyInput(type:number, keyCode:number):void{\n\t\t\tthis.inputData.setKeyInput(keyCode, type == Input.KEY_DOWN)\n\t\t}\n\n\t\tpublic handleTouchInput(type:number, evt:any){\n\t\t\tswitch(type){\n\t\t\t\tcase Input.TOUCH_START:\n\t\t\t\t\tthis.inputData.addTouches(evt.changedTouches);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Input.TOUCH_MOVE:\n\t\t\t\t\tbreak;\n\t\t\t\tcase Input.TOUCH_RELEASE:\n\t\t\t\t\tthis.inputData.removeTouches(evt.touches);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Input.TOUCH_ENTER:\n\t\t\t\t\tbreak;\n\t\t\t\tcase Input.TOUCH_LEAVE:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tthis.inputData.updateTouches(evt.changedTouches);\n\t\t}\n\n\n    }\n}","module Animyst {\n    export class InputData extends Database {\n\n    \tstatic TOUCH_HISTORY_LIMIT:number = 12;\n\t\tstatic TOUCH_PROPERTIES:any[]     = [\"identifier\", \"screenX\", \"screenY\", \"clientX\", \"clientY\",\n\t\t\t\t\t\t\t\t\t\t\t\t   \"pageX\", \"pageY\", \"radiusX\", \"radiusY\", \"rotationAngle\", \n\t\t\t\t\t\t\t\t\t\t\t\t   \"force\", \"webkitForce\", \"target\"];\n\t\tstatic MOUSE_PROPERTIES:any[]     = [\"clientX\", \"clientY\", \"screenX\", \"screenY\",\"type\", \"point\", \n\t\t\t\t\t\t\t\t\t\t\t\t\"lastPoint\", \"downPoint\", \"middlePoint\", \"count\", \"item\", \"modifiers\"];\n\n\t\tstatic KEY_CODES:any =  {\n\t\t    'backspace': 8,\n\t\t    'tab': 9,\n\t\t    'enter': 13,\n\t\t    'shift': 16,\n\t\t    'ctrl': 17,\n\t\t    'alt': 18,\n\t\t    'pause': 19,\n\t\t    'capslock': 20,\n\t\t    'numlock': 144,\n\t\t    'esc': 27,\n\t\t    'pageup': 33,\n\t\t    'pagedown': 34,\n\t\t    'end': 35,\n\t\t    'home': 36,\n\t\t    'leftarrow': 37,\n\t\t    'uparrow': 38,\n\t\t    'rightarrow': 39,\n\t\t    'downarrow': 40,\n\t\t    'insert': 45,\n\t\t    'delete': 46,\n\t\t    'clear':12,\n\t\t    '0': 48,\n\t\t    '1': 49,\n\t\t    '2': 50,\n\t\t    '3': 51,\n\t\t    '4': 52,\n\t\t    '5': 53,\n\t\t    '6': 54,\n\t\t    '7': 55,\n\t\t    '8': 56,\n\t\t    '9': 57,\n\t\t    'a': 65,\n\t\t    'b': 66,\n\t\t    'c': 67,\n\t\t    'd': 68,\n\t\t    'e': 69,\n\t\t    'f': 70,\n\t\t    'g': 71,\n\t\t    'h': 72,\n\t\t    'i': 73,\n\t\t    'j': 74,\n\t\t    'k': 75,\n\t\t    'l': 76,\n\t\t    'm': 77,\n\t\t    'n': 78,\n\t\t    'o': 79,\n\t\t    'p': 80,\n\t\t    'q': 81,\n\t\t    'r': 82,\n\t\t    's': 83,\n\t\t    't': 84,\n\t\t    'u': 85,\n\t\t    'v': 86,\n\t\t    'w': 87,\n\t\t    'x': 88,\n\t\t    'y': 89,\n\t\t    'z': 90,\n\t\t    'numpad0': 96,\n\t\t    'numpad1': 97,\n\t\t    'numpad2': 98,\n\t\t    'numpad3': 99,\n\t\t    'numpad4': 100,\n\t\t    'numpad5': 101,\n\t\t    'numpad6': 102,\n\t\t    'numpad7': 103,\n\t\t    'numpad8': 104,\n\t\t    'numpad9': 105,\n\t\t    'multiply': 106,\n\t\t    'plus': 107,\n\t\t    'minus': 109,\n\t\t    'dot': 110,\n\t\t    'divide': 111,\n\t\t    'f1': 112,\n\t\t    'f2': 113,\n\t\t    'f3': 114,\n\t\t    'f4': 115,\n\t\t    'f5': 116,\n\t\t    'f6': 117,\n\t\t    'f7': 118,\n\t\t    'f8': 119,\n\t\t    'f9': 120,\n\t\t    'f10': 121,\n\t\t    'f11': 122,\n\t\t    'f12': 123,\n\t\t    '=': 187,\n\t\t    ',': 188,\n\t\t    '.': 190,\n\t\t    '/': 191,\n\t\t    'backslash': 220,\n\t\t    \";\":186,\n\t\t    \"'\":222,\n\t\t    \"[\":219,\n\t\t    \"]\":221,\n\t\t    \"-\":189,\n\t\t    \"space\":32 ,\n\t\t    \"~\":192\n\t\t};\n\n\t\tstatic __KEY_NAMES:any;\n\t\tstatic get KEY_NAMES():any{\n\t\t\tif(!InputData.__KEY_NAMES){\n\t\t\t\tInputData.__KEY_NAMES = ObjectUtil.invert(InputData.KEY_CODES);\n\t\t\t}\n\n\t\t\treturn InputData.__KEY_NAMES;\n\t\t};\n\n\t\tstatic MOUSE = 0;\n\t\tstatic TOUCH = 1;\n\t\tstatic KEY   = 2;\n\n\t\tstatic TOUCH_ADDED   = 0;\n\t\tstatic TOUCH_REMOVED = 1;\n\t\tstatic TOUCH_UPDATED = 2;\n\n\t\tstatic MOUSE_DOWN = 0;\n\t\tstatic MOUSE_UP   = 1;\n\t\tstatic MOUSE_MOVE = 2;\n\n\t\tstatic KEY_ACTIVE   = 0;\n\t\tstatic KEY_INACTIVE = 1;\n\n    \tpublic map:any                = {};\n\t\tpublic touches:any[]          = [];\n\t\tpublic touchHistory:any[]     = [];\n\t\tpublic mouse:any              = {};\n\t\tpublic mouseHistory:any[]     = [];\n\t\tpublic totalTouchCount:number = 0;\n\t\tpublic time:number            = 0;\n    \t\n    \tconstructor() {\n    \t\tsuper();\n    \t}\n\n    \tpublic clear():void{\n\n\t\t\tthis.map             = {};\n\t\t\tthis.touches         = [];\n\t\t\tthis.touchHistory    = [];\n\t\t\tthis.totalTouchCount = 0;\n\n\t\t\tsuper.clear();\n\t\t}\n\n\t\tpublic destroy():void{\n\n\t\t\tthis.map             = null;\n\t\t\tthis.touches         = null;\n\t\t\tthis.touchHistory    = null;\n\t\t\tthis.totalTouchCount = 0;\n\n\t\t\tsuper.destroy();\n\t\t}\n\n\t\tpublic onTick(delta:number):void{\n\t\t\tthis.time += delta;\n\n\t\t\tif(this.mouse.down){\n\t\t\t\tthis.mouse.clickTime += delta;\n\t\t\t}\n\n\t\t\tfor(var k in this.map){\n\t\t\t\tvar data = this.map[k];\n\n\t\t\t\tif(data.active){\n\t\t\t\t\tdata.time = (data.time || 0) + delta;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor(var i = 0; i < this.touches.length; i++){\n\t\t\t\tvar touchData = this.touches[i];\n\t\t\t\ttouchData.time += delta;\n\t\t\t}\n\t\t}\n\n\t\tpublic isKeyDown(keyName:string):boolean{\n\t\t\tvar keyCode = InputData.KEY_CODES[keyName];\n\t\t\treturn (this.map[keyCode] && this.map[keyCode].active) ? true : false;\n\t\t}\n\n\t\tpublic setKeyInput(keyCode:number, active?:boolean):void{\n\t\t\tvar data = this.map[keyCode] || {};\n\t\t\tvar evtType;\n\n\t\t\tif(active && !data.active){\n\t\t\t\tdata.time = 0;\n\t\t\t\tevtType = InputData.KEY_ACTIVE;\n\t\t\t}\n\n\t\t\tif(!active && data.active){\n\t\t\t\tdata.lastInput = {};\n\t\t\t\tdata.lastInput.endTime   = this.time;\n\t\t\t\tdata.lastInput.duration  = data.time;\n\t\t\t\tdata.lastInput.startTime = this.time - data.time;\n\n\t\t\t\tdata.time = 0;\n\t\t\t\tevtType = InputData.KEY_INACTIVE\n\t\t\t}\n\n\t\t\tdata.active = active === true;\n\n\t\t\tif(!this.map[keyCode]){\n\t\t\t\tthis.map[keyCode] = data;\n\t\t\t}\n\n\t\t\tif(evtType) this.signal.dispatch(InputData.KEY, evtType, data);\n\n\n\t\t}\n\n\t\tpublic setMouseInput(evt:any, down?:boolean):void{\n\t\t\tif(this.touches.length > 0 && down) down = false;\n\t\t\tif(typeof(down) != \"boolean\") down = this.mouse.down;\n\n\n\t\t\tvar lastClick  = this.mouse.down && !down ? this.mouse.lastClick || {} : null;\n\t\t\tvar clickStart = !this.mouse.down && down ? {} : null;\n\t\t\tvar evtType = InputData.MOUSE_MOVE;\n\t\t\t\n\n\t\t\tfor(var i = 0; i < InputData.MOUSE_PROPERTIES.length; i++){\n\t\t\t\tvar k = InputData.MOUSE_PROPERTIES[i];\n\t\t\t\tif(evt[k]){\n\t\t\t\t\tthis.mouse[k] = evt[k];\n\t\t\t\t\tif(lastClick) lastClick[k] = evt[k];\n\t\t\t\t\tif(clickStart) clickStart[k] = evt[k];\t\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(clickStart){\n\t\t\t\tif(Animyst.LOGGING) console.log(\"[InputData] Click Start!\");\n\t\t\t\tthis.mouse.clickStart = clickStart\n\t\t\t\tthis.mouse.clickTime = 0;\n\t\t\t\tevtType = InputData.MOUSE_DOWN;\n\t\t\t}\n\n\t\t\tif(lastClick){\n\t\t\t\tif(Animyst.LOGGING) console.log(\"[InputData] Click Ended!\", this.mouse.clickTime);\n\t\t\t\tlastClick.clickStart = this.mouse.clickStart;\n\t\t\t\tlastClick.clickTime  = this.mouse.clickTime;\n\t\t\t\t\n\t\t\t\tthis.mouse.clickStart = null;\n\t\t\t\tthis.mouse.lastClick = lastClick;\n\t\t\t\tevtType = InputData.MOUSE_UP;\n\t\t\t}\n\t\t\t\n\t\t\tthis.mouse.down = down;\n\n\t\t\tthis.signal.dispatch(InputData.MOUSE, evtType, this.mouse);\n\t\t}\n\n\t\tpublic getTouches():any{\n\t\t\treturn this.touches.concat();\n\t\t}\n\n\t\tpublic addTouches(touches:any[]):void{\n\t\t\tfor(var i = 0; i < touches.length; i++){\n\t\t\t\tvar touch = touches[i];\n\t\t\t\tvar isNew = true;\n\n\t\t\t\tfor(var j = 0; j < this.touches.length; j++){\n\t\t\t\t\tif(this.touches[j].identifier == touch.identifier){\n\t\t\t\t\t\tisNew = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(isNew){\n\t\t\t\t\tvar data:any = {};\n\t\t\t\t\tvar startData:any = {};\n\n\t\t\t\t\tfor(var j = 0; j < InputData.TOUCH_PROPERTIES.length; j++){\n\t\t\t\t\t\tvar k = InputData.TOUCH_PROPERTIES[j];\n\t\t\t\t\t\tdata[k]      = (typeof touch[k] != \"object\" || k == \"target\") ? touch[k] : null;\n\t\t\t\t\t\tstartData[k] = (typeof touch[k] != \"object\") ? touch[k] : null;\n\t\t\t\t\t} \n\n\t\t\t\t\tdata.time      = 0;        //Time Counter\n\t\t\t\t\tdata.timestamp = this.time //When the touch began\n\t\t\t\t\tdata.startData = startData //Data assosiated with the start of the touch\n\t\t\t\t\tdata.uid       = data.identifier + \"\" + this.totalTouchCount //Unique identifier for this touch that seperates it from past touches\n\n\t\t\t\t\tthis.touches.push(data);\n\t\t\t\t\tthis.totalTouchCount++;\n\t\t\t\t\tif(Animyst.LOGGING) console.log(\"[InputData] Adding Touch:\", data.uid);\n\n\t\t\t\t\tthis.signal.dispatch(InputData.TOUCH, InputData.TOUCH_ADDED, data);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tpublic removeTouches(touches:any[]):void{\n\t\t\tfor(var i = this.touches.length - 1; i > -1 && this.touches.length > 0; i--){\n\t\t\t\tvar touchData = this.touches[i];\n\t\t\t\tvar isGone = true;\n\n\t\t\t\tfor(var j = 0; j < touches.length; j++){\n\t\t\t\t\tif(touches[j].identifier == touchData.identifier){\n\t\t\t\t\t\tisGone = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(isGone){\n\t\t\t\t\tif(Animyst.LOGGING) console.log(\"[InputData] Removing Touch:\", touchData.uid);\n\t\t\t\t\tthis.touchHistory.unshift(touchData);\n\t\t\t\t\tthis.touches.splice(i,1);\n\t\t\t\t\tif(this.touchHistory.length > InputData.TOUCH_HISTORY_LIMIT){\n\t\t\t\t\t\tthis.touchHistory.pop();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.signal.dispatch(InputData.TOUCH, InputData.TOUCH_REMOVED, touchData);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\n\t\tpublic updateTouches(touches:any[]):void{\n\t\t\tfor(var i = 0; i < touches.length; i++){\n\t\t\t\tvar touch = touches[i];\n\t\t\t\tvar data\n\t\t\t\tfor(var j = 0; j < this.touches.length; j++){\n\t\t\t\t\tif(this.touches[j].identifier == touch.identifier){\n\t\t\t\t\t\tdata = this.touches[j];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(data){\n\t\t\t\t\tfor(var j = 0; j < InputData.TOUCH_PROPERTIES.length; j++){\n\t\t\t\t\t\tvar k = InputData.TOUCH_PROPERTIES[j];\n\t\t\t\t\t\tdata[k] = touch[k];\n\t\t\t\t\t}\n\n\t\t\t\t\tif(Animyst.LOGGING) console.log(\"[InputData] Updated Touch:\", data.uid, Math.round(data.pageX), Math.round(data.pageY), Math.round(data.screenX), Math.round(data.screenY), data.force || data.webkitForce);\n\t\t\t\t\tthis.signal.dispatch(InputData.TOUCH, InputData.TOUCH_UPDATED, data);\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\n    }\n}","module Animyst {\n    export class SpriteSheetAnimation {\n\n    \tpublic id:string ;\n\t\tpublic idle:string;\n\t\tpublic currentAnim:string;\n\t\tpublic animations:any;\n\t\tpublic spritesheets:any;\n\t\tpublic framerate:number;\n\t\tpublic playing:boolean;\n\t\tpublic time:number = 0;\n\t\tpublic playTime:number = 0;\n\t\tpublic currentFrame:number = 0;\n    \t\n    \tconstructor(id:string, framerate:number = 60){\n    \t\tthis.id = id;\n\t\t\tthis.animations = {};\n\t\t\tthis.spritesheets = {};\n\t\t\tthis.framerate = framerate;\n    \t}\n\n    \tpublic addSheet(sheetData:SpriteSheetData):void{\n\t\t\tthis.spritesheets[sheetData.name] = sheetData;\n\t\t}\n\n\t\tpublic getSheet(sheetID):SpriteSheetData{\n\t\t\t return this.spritesheets[sheetID]; \n\t\t};\n\n\t\tpublic addAnimation(name:string, prefix:string, sheetID:string, params:any = {}){\n\t\t\tvar anim:any = {};\n\t\t\tvar spritesheet = this.getSheet(sheetID);\n\n\t\t\tanim.name = name;\n\t\t\tanim.prefix = prefix;\n\t\t\tanim.sheetID = sheetID;\n\t\t\tanim.useFrames = params.useFrames || false;\n\t\t\tanim.frames = spritesheet.getFrames(anim.prefix);\n\t\t\tanim.currentFrameIndex = 0;\n\t\t\tanim.totalFrames = anim.frames.length;\n\t\t\tanim.duration = params.duration || anim.useFrames ? anim.totalFrames * (this.framerate / 60) : 1000 / this.framerate * anim.totalFrames;\n\t\t\tanim.loop = params.loop || false;\n\t\t\tanim.repeat = params.repeat || 0;\n\t\t\tanim.elapsed = 0;\n\t\t\tanim.framecount = 0;\n\n\n\t\t\tthis.animations[anim.name] = anim;\n\t\t}\n\n\t\tpublic getAnimation(name:string):any{\n\t\t\t return this.animations[name]; \n\t\t};\n\n\t\tpublic play(name:string):void{\n\t\t\tif(this.currentAnim == name) return;\n\n\t\t\tvar anim = this.getAnimation(name);\n\t\t\tthis.currentAnim = name;\n\t\t\tthis.playing = true;\n\t\t};\n\n\t\tpublic stop():void{\n\t\t\t\n\t\t}\n\n\t\tpublic pause():void{\n\t\t\t\n\t\t}\n\n\t\tpublic resume():void{\n\t\t\t\n\t\t}\n\n\t\tpublic setIdle(name:string):void{\n\t\t\t // body...  \n\t\t};\n\n\t\tpublic animate(delta:number = 0):void{\n\t\t\tif(this.playing){\n\t\t\t\t//console.log(delta, time, this.time, this.playTime, this.currentFrame, this.sourceFile)\n\t\t\t\tvar anim = this.getAnimation(this.currentAnim)\n\n\t\t\t\tif(anim.useFrames){\n\n\t\t\t\t} else {\n\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\t//TODO: Finish...\n\t\t\t\t\n\n\t\t\t\t/*if(this.time >= this.playTime){\n\n\t\t\t\t\tif(this.loop){\n\t\t\t\t\t\tthis.time = 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.playing = false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.time += delta;\n\t\t\t\t\tthis.currentFrame = Math.round((this.time / this.playTime) * (this.frames.length - 1))\n\t\t\t\t\tif(this.currentFrame >= this.frames.length) this.currentFrame = this.frames.length - 1;\n\t\t\t\t}*/\n\t\t\t}\n\t\t};\n    }\n}","module Animyst {\n    export class SpriteSheetData extends Database {\n    \t\n    \tpublic name:string;\n    \tpublic data:any;\n\n    \tconstructor(name:string, data:any) {\n    \t\tsuper();\n\n    \t\tthis.name  = name;\n    \t\tthis.data = data;\n    \t\tthis.parse();\n    \t}\n\n    \tpublic parse():void{\n\t\t\tfor(var k in this.data.frames){\n\t\t\t\tthis.addFrame(k, this.data.frames[k]);\t\n\t\t\t} \n\t\t}\n\n\t\tpublic addFrame(frameID, data):void{\n\t\t\tvar frame = new FrameData(frameID, data);\n\t\t\tthis.create(frame, frameID, data); \n\t\t}\n\n\t\tpublic getFrame(frameID):void{\n\t\t\treturn this.getItem(frameID);\n\t\t}\n\n\t\tpublic getFrames(framePrefix):void{\n\t\t\tif(!this.hasCategory(framePrefix)){\n\t\t\t\tlet ctx:any = {}\n\t\t\t\tctx.framePrefix = framePrefix;\n\t\t\t\tthis.addCategory(framePrefix, function(frame){\n\t\t\t\t\treturn frame.id.indexOf(this.framePrefix) == 0;\n\t\t\t\t}, FrameData, ctx);\n\t\t\t} \n\n\t\t\tlet frames = this.getItemsInCategory(framePrefix);\n\t\t\tframes.sort(this._sortCaseInsensitive);\n\t\t\treturn frames;\n\t\t}\n\n\t\tprivate _sortCaseInsensitive(a,b):number{\n\t\t\tif (a.toLowerCase() < b.toLowerCase()) return -1;\n\t\t\tif (a.toLowerCase() > b.toLowerCase()) return 1;\n\n\t\t\treturn 0;\n\t\t}\n    }\n\n    export class FrameData extends Item {\n\n    \tpublic frame:any;\n    \tpublic rotated:boolean;\n    \tpublic trimmed:boolean;\n    \tpublic spriteSourceSize:any;\n    \tpublic sourceSize:any;\n    \tpublic pivot:any;\n\n    \tconstructor(id:string, params:any) {\n    \t\tsuper(id, params);\n    \t}\n\n    \tpublic setup(params:any):void{\n\t\t\tthis.frame = params.frame;\n\t\t\tthis.rotated = params.rotated;\n\t\t\tthis.trimmed = params.trimmed;\n\t\t\tthis.spriteSourceSize = params.spriteSourceSize;\n\t\t\tthis.sourceSize = params.sourceSize;\n\t\t\tthis.pivot = params.pivot;\n\n\t\t\tsuper.setup(params);\n\t\t};\n    }\n}","module Animyst {\n    export class CoreProcess extends AppState {\n    \t\n    \tstatic ID:string      = \"core\";\n\t\tstatic INPUT:string   = \"input\";\n\n    \tprivate _inputData:InputData;\n    \t\n\n    \tconstructor(id:string) {\n    \t\tsuper(id);\n\n    \t}\n\n    \tpublic setup():void{\n\t\t\tLog.output(\"[CoreProcess] Core Process Initialize\");\n\t\t\tsuper.setup.call(this);\n\n\t\t\tthis._inputData = new InputData();\n\n\t\t\tvar config = this.appScope.config;\n\t\t\tvar input  = new Input(this._inputData);\n\n\n\t\t\tinput.startup({element: document.body, keyboardSettings:config.settings.keyboard});\n\n\t\t\tthis.addSystem(\"input\", input);\n\n\n\t\t\tthis.appScope.addDatabase(CoreProcess.INPUT, this._inputData);\n\n\t\t}\n\n\t\tpublic start():void{\n\t\t\tLog.output(\"[CoreProcess] Start\");\n\t\t\tsuper.start();\n\t\t}\n\n\t\tpublic update(delta, time):void{\n\t\t\t//console.log(\"[Game] Updating...\")\n\t\t\tsuper.update(delta, time);\n\t\t}\n\n\t\tpublic pause():void{\n\t\t\tsuper.pause();\n\t\t}\n\n\t\tpublic resume():void{\n\t\t\tsuper.resume();\n\t\t}\n\n\t\tpublic kill():void{\n\t\t\tsuper.kill();\n\t\t}\n\n\t\tpublic restart():void{\n\t\t\tsuper.restart();\n\t\t}\n    }\n}","module Animyst {\n    export class ArrayUtil {\n\n    \t/**\n\t\t* Searches through any array for an element with a specific property\n\t\t* @param  {any} property Property to check\n\t\t* @param  {any} value    Value of the property\n\t\t* @param  {any} array    Array of elements\n\t\t* @return {any}          First element found with given property value. Returns null if nothing is found\n\t\t*/\n\t\tstatic search (property, value, array){\n\t\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\t\tvar obj = array[i];\n\t\t\t\tif (obj[property] && obj[property] === value) {\n\t\t\t\t\treturn obj;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\n\t\t/**\n\t\t* Searches through any array for all elements with a specific property\n\t\t* @param  {any} property Property to check\n\t\t* @param  {any} value    Value of the property\n\t\t* @param  {any} array    Array of elements\n\t\t* @return {any}          First element found with given property value. Returns null if nothing is found\n\t\t*/\n\t\tstatic searchAll (property, value, array, output = []) {\n\t\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\t\tvar obj = array[i];\n\t\t\t\tif (obj[property] && obj[property] === value) {\n\t\t\t\t\toutput.push(obj);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn output;\n\t\t}\n\n\n\t\t/**\n\t\t* Pushes an element to an array as long as it is not already included in the array\n\t\t* @param {any}   element [description]\n\t\t* @param {any[]} array   [description]\n\t\t*/\n\t\tstatic include (element, array){\n\t\t\tif (array.indexOf(element) == -1) array.push(element);\n\t\t}\n\n\t\t/**\n\t\t* Splices an element out of an array\n\t\t* @param {any}   element [description]\n\t\t* @param {any[]} array   [description]\n\t\t*/\n\t\tstatic remove (element, array){\n\t\t\tvar index = array.indexOf(element);\n\t\t\tif (index >= 0) array.splice(index, 1);\n\t\t}\n\n\t\t/**\n\t\t* Traverses array and executes a call on each element\n\t\t* @param {any[]}     array   [description]\n\t\t* @param {any}       command [description]\n\t\t* @param {number =       0}           startIndex [description]\n\t\t* @param {number =       1}           inc        [description]\n\t\t* @param {any}       ctx     [description]\n\t\t*/\n\t\tstatic traverse (array, command, startIndex = 0, inc = 1, ctx = null){\n\t\t\tfor (var i = startIndex; i < array.length; i+= inc){\n\t\t\t\tcommand.call(ctx, array[i]);\n\t\t\t}\n\t\t}\n    \t\n    \tconstructor(argument) {\n    \t\t// code...\n    \t}\n    }\n}","module Animyst {\n    export class MathUtil {\n\n\t\tstatic loopSum(v:number, inc:number, max:number, min:number = 0):number {\n\t\t\tvar result = (v + inc) % (max + 1) + min;\n\t\t\tif(result < min) result = (max + 1) - Math.abs(result - min);\n\t\t\treturn result;\n\t\t}\n\n\t\tstatic constrain(v:number, min:number, max:number):number {\n\t\t\treturn Math.max(min, Math.min(v, max));\n\t\t}\n\n\t\tstatic findClosestDivisable(value, divisor):number {\n\t\t\tif (value <= divisor) return divisor;\n\n\t\t\tif (value % divisor > divisor / 2) {\n\t\t\t\treturn value + (divisor - (value % divisor));\n\t\t\t} else {\n\t\t\t\treturn value - (value % divisor);\n\t\t\t}\n\t\t}\n\n\t\tstatic findNextDivisable(value, divisor):number {\n\t\t\tif (value <= divisor) return divisor;\n\t\t\treturn value + (divisor - (value % divisor));\n\t\t}\n\n\t\tstatic interpolate(a, b, percent):number{\n\t\t\treturn a + (b - a) * percent\n\t\t}\n\n    }\n}\t","module Animyst {\n    export class ObjectUtil {\n\n    \t/**\n    \t * Inverts the properties and keys of an object\n    \t * @param  {any} object Object to invert\n    \t * @return {any}        Inverted copy of object\n    \t */\n\t\tstatic invert (object:any):any{\n\t\t\tvar obj = {};\n\n\t\t\tfor(var k in object){\n\t\t\t\tobj[object[k]] = k;\n\t\t\t}\n\n\t\t\treturn obj\n\t\t}\n\n\t\t/**\n\t\t * Returns copy of an object\n\t\t * @param  {any} obj    Object to copy\n\t\t * @param  {any} target Target object to copy to\n\t\t * @return {any}        [description]\n\t\t */\n\t\tstatic copy(obj:any, target?:any):any{\n\t\t\ttarget = target || {};\n\t\t\tfor(var k in obj){\n\t\t\t\tif(obj[k] instanceof Object){\n\t\t\t\t\tif(Array.isArray(obj[k])){\n\t\t\t\t\t\ttarget[k] = obj[k].concat()\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttarget[k] = ObjectUtil.copy(obj[k]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttarget[k] = obj[k];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn target;\n\t\t}\n    \n    }\n}\t"],"sourceRoot":"src"}