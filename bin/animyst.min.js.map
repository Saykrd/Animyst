{"version":3,"sources":["animyst.min.js","_core/Application.ts","_core/AppScope.ts","_core/AppState.ts","_core/Database.ts","_core/DataLoad.ts","_core/Environment.ts","_core/Item.ts","_core/Log.ts","_core/SignalBinding.ts","_core/Signal.ts","_core/System.ts","_core/View3D.ts","_core/Window.ts","Animyst.ts","audio/Sound.ts","display/PIXITexture.ts","display/SpriteSheetTexture.ts","input/Input.ts","input/InputData.ts","libs/pixi/pixi.js-tests.ts","spritesheet/SpriteSheetAnimation.ts","spritesheet/SpriteSheetData.ts","states/CoreProcess.ts","utils/ArrayUtil.ts","utils/MathUtil.ts","utils/ObjectUtil.ts"],"names":["__extends","this","d","b","__","constructor","p","hasOwnProperty","prototype","Object","create","Animyst","Application","argument","_lastFrame","_framerate","_framecount","_timestep","runtime","_appStateList","_appStateLib","appScope","AppScope","initSignal","Signal","defineProperty","get","enumerable","configurable","set","v","startup","params","_this","Log","output","VERSION","Environment","browserName","browserVersion","platformName","_startParams","DataLoad","loadAsset","id","src","type","evt","onLoading","FILE_LOADED","item","config","getAsset","loadFromManifest","assets","strings","listAssets","manifest","initialLoad","LOAD_COMPLETE","init","LOGGING","settings","logging","DEBUG","debug","window","isCocoonJS","_stats","domElement","style","position","left","top","document","body","appendChild","GUI","coreprocess","CoreProcess","ID","run","timestep","setInterval","fixedUpdate","onFrame","frameUpdate","bind","initFrame","dispatch","requestAnimationFrame","appState","push","setScope","framerate","setup","start","halt","appStateID","pause","resume","end","kill","i","length","state","splice","endAll","k","event","delta","time","Date","now","begin","update","databases","addDatabase","database","getDatabase","AppState","_systemList","_systemLib","_id","clearScope","active","stop","system","shutdown","framecount","paused","started","restart","addSystem","getSystem","console","error","Database","_itemCount","_items","_itemList","_categoryLists","_categoryChecks","signal","addCategory","name","check","cls","context","traverse","list","hasCategory","data","call","ArrayUtil","include","unlist","itemID","remove","getItemsInCategory","category","items","getItem","isInCategory","indexOf","command","ADDED","REMOVED","removeAll","clear","destroy","LoadQueue","_loadQueue","_loadSignal","queue","on","handleFileLoaded","handleLoadComplete","handleFileError","handleLoaderError","handleFileStart","handleLoadInitialize","handleLoadStart","handleFileProgress","handleOverallProgress","_fileStartedSignal","_fileProgressSignal","_fileLoadedSignal","_fileErrorSignal","_queueStartedSignal","_queueProgressSignal","_queueLoadedSignal","_queueErrorSignal","assetList","_assetList","value","loadHandler","persistant","addLoadHandler","_busy","loadManifest","loadFile","getResult","getData","handler","_weakHandlers","add","removeLoadHandler","h","removeWeakHandlers","handlers","shift","addCommand","commandID","addOnce","LOAD_STARTED","FILE_STARTED","LOAD_PROGRESS","FILE_PROGRESS","LOAD_ERROR","FILE_ERROR","removeCommand","loadSignal","LOAD_INITIALIZE","handlersToRemove","concat","_setup","_checkBrowser","_checkPlatform","_checkDevice","userAgent","navigator","test","isLinux","isAndroid","isChromeOS","isIOS","isMacOS","isWindows","isDesktop","isWebApp","isMobile","pixelRatio","devicePixelRatio","colorDepth","screen","screenWidth","width","screenHeight","height","isSafari","substring","isChrome","isFirefox","isIE","isEdge","url","location","href","queryString","search","host","hostname","path","pathname","port","details","split","browserDetails","major","parseInt","minor","build","revision","getURLParameterByName","escapeSpaces","match","RegExp","exec","decodeURIComponent","replace","Item","startParams","reset","args","_i","arguments","logData","log","apply","SignalBinding","listener","isOnce","listenerContext","priority","_listener","_isOnce","_signal","execute","paramsArr","handlerReturn","detach","isBound","getListener","getSignal","_destroy","toString","_bindings","_prevParams","memorize","_shouldPropagate","validateListener","fnName","Error","_registerListener","binding","prevIndex","_indexOfListener","_addBinding","n","cur","has","getNumListeners","bindings","slice","forget","dispose","System","_paused","_started","_startupParams","View3D","_super","initDisplay","viewAngle","near","far","_resize","resize","_scene","THREE","Scene","_renderer","WebGLRenderer","_camera","PerspectiveCamera","aspect","lookAt","container","getElementById","x","cameraX","y","cameraY","z","cameraZ","setClearColor","rendererColor","setSize","addAxis","axis","AxisHelper","debugControls","OrbitControls","displayControls","addFolder","c_folder","listen","Window","resizeSignal","onResize","_view","createElement","_context2d","getContext","append","containerID","render","orientation","innerWidth","innerHeight","documentElement","clientWidth","clientHeight","_onResize","_onWindowLoad","addEventListener","MAJOR","MINOR","BUILD","DATA","Sound","PIXITexture","stage","renderer","view","_init","image","graphics","PIXI","Graphics","lineStyle","beginFill","drawCircle","endFill","texture","Texture","fromCanvas","sprite","Sprite","addChild","invalidate","shouldUpdate","needsUpdate","SpriteSheetTexture","atlas","playTime","currentFrame","currentFrameID","renderWidth","renderHeight","sourceFile","timePassed","addSheet","_initSprite","startFrame","Container","autoDetectRenderer","transparent","fromFrame","frames","frame","w","showFrame","thisFrame","setTexture","play","loop","playing","animate","Math","round","Input","inputData","element","tool","keyboardSettings","onKeyUp","onKeyDown","onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onTouchStart","onTouchMove","onTouchRelease","onTouchEnter","onTouchLeave","onMouseEnter","onMouseLeave","onTick","handleTouchInput","TOUCH_START","TOUCH_MOVE","TOUCH_RELEASE","TOUCH_ENTER","TOUCH_LEAVE","onClick","handleMouseInput","MOUSE_CLICK","MOUSE_DOWN","MOUSE_DRAG","MOUSE_MOVE","MOUSE_UP","MOUSE_ENTER","MOUSE_LEAVE","key","InputData","KEY_NAMES","keyCode","allowDefault","preventDefault","handleKeyInput","KEY_UP","KEY_CODES","KEY_DOWN","down","setMouseInput","setKeyInput","addTouches","changedTouches","removeTouches","touches","updateTouches","map","touchHistory","mouse","mouseHistory","totalTouchCount","clickTime","touchData","isKeyDown","keyName","evtType","KEY_ACTIVE","lastInput","endTime","duration","startTime","KEY_INACTIVE","KEY","lastClick","clickStart","MOUSE_PROPERTIES","MOUSE","getTouches","touch","isNew","j","identifier","startData","TOUCH_PROPERTIES","timestamp","uid","TOUCH","TOUCH_ADDED","isGone","unshift","TOUCH_HISTORY_LIMIT","pop","TOUCH_REMOVED","pageX","pageY","screenX","screenY","force","webkitForce","TOUCH_UPDATED","backspace","tab","enter","ctrl","alt","capslock","numlock","esc","pageup","pagedown","home","leftarrow","uparrow","rightarrow","downarrow","insert","delete","0","1","2","3","4","5","6","7","8","9","a","c","e","f","g","l","m","o","q","r","s","t","u","numpad0","numpad1","numpad2","numpad3","numpad4","numpad5","numpad6","numpad7","numpad8","numpad9","multiply","plus","minus","dot","divide","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","=",",",".","/","backslash",";","'","[","]","-","space","~","ObjectUtil","invert","basics","Basics","app","backgroundColor","bunny","fromImage","anchor","ticker","rotation","Click","baseTexture","scaleMode","SCALE_MODES","NEAREST","interactive","buttonMode","scale","ContainerPivot","floor","pivot","CustomizedFilter","fragmentSource","customUniform","Filter","CustomFilter","background","loader","load","resource","filter","shader","filters","uniforms","antialias","moveTo","lineTo","drawRect","drawRoundedRect","RenderTexture","random","PI","brt","BaseRenderTexture","LINEAR","rt","SpriteSheet","val","anim","extras","AnimatedSprite","animationSpeed","deltaTime","Text","basicText","TextStyle","fontFamily","fontSize","fontStyle","fontWeight","fill","stroke","strokeThickness","dropShadow","dropShadowColor","dropShadowBlur","dropShadowAngle","dropShadowDistance","wordWrap","wordWrapWidth","richText","TexturedMesh","ropeLength","points","Point","strip","mesh","Rope","count","sin","cos","renderPoints","TilingSprite","tilingSprite","tileScale","tilePosition","Video","button","fromVideo","videoSprite","demos","AlphaMask","bg","cells","mask","target","abs","AnimatedSpriteDemo","explosionTextures","explosion","gotoAndPlay","Batch","sprites","particles","ParticleContainer","uvs","alpha","maggots","totalSprites","dudeTexture","dude","Dude","tint","direction","turningSpeed","speed","offset","dudeBoundsPadding","dudeBounds","Rectangle","tick","BlendModes","dudeArray","totalDudes","blendMode","BLEND_MODES","ADD","CacheAsBitmap","aliens","alienFrames","alienContainer","frameName","alien","cacheAsBitmap","Dragging","createBunny","dragging","newPosition","getLocalPosition","GraphicsDemo","quadraticCurveTo","thing","bezierCurveTo","Interactivity","buttons","buttonPositions","textureButton","Masking","bgFront","light2","light1","panda","RenderTextureDemo","renderTexture","renderTexture2","currentTexture","outputSprite","stuffContainer","fruits","temp","StripDemo","snakeContainer","TextDemo","bitmapFontText","BitmapText","font","align","textWidth","textSample","spinningText","countingText","text","TextureRotate","bol","resources","flowerTop","textures","D8","GroupD8","rotate","isSwapWidthHeight","crop","trim","rotatedTexture","offsetX","offsetY","gridW","gridH","TextureSwap","secondTexture","Tinting","TransparentBackground","BlurFilter","littleDudes","littleRobot","blurFilter1","blurFilter2","blurAmount","blurAmount2","blur","DisplacementMap","onPointerMove","eventData","ring","visible","displacementSprite","global","padding","bounds","maggot","DisplacementMapDude","turnSpeed","original","clone","displacementFilter","DisplacementFilter","ColorMatrixFilter","enabled","help","matrix","SpriteSheetAnimation","animations","spritesheets","sheetData","getSheet","sheetID","addAnimation","prefix","spritesheet","useFrames","getFrames","currentFrameIndex","totalFrames","repeat","elapsed","getAnimation","currentAnim","setIdle","SpriteSheetData","parse","addFrame","frameID","FrameData","getFrame","framePrefix","ctx","sort","_sortCaseInsensitive","toLowerCase","rotated","trimmed","spriteSourceSize","sourceSize","_inputData","input","keyboard","INPUT","property","array","obj","searchAll","index","startIndex","inc","MathUtil","loopSum","max","min","result","constrain","findClosestDivisable","divisor","findNextDivisable","interpolate","percent","object","copy","Array","isArray"],"mappings":"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","file":"animyst.min.js","sourcesContent":["var __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Animyst;\n(function (Animyst) {\n    var Application = (function () {\n        function Application(argument) {\n            this._lastFrame = 0;\n            this._framerate = 60;\n            this._framecount = 0;\n            this._timestep = 1000 / this._framerate;\n            this.runtime = 0;\n            this._appStateList = [];\n            this._appStateLib = {};\n            this.appScope = new Animyst.AppScope();\n            this.initSignal = new Animyst.Signal();\n        }\n        Object.defineProperty(Application.prototype, \"framerate\", {\n            get: function () { return this._framerate; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Application.prototype, \"framecount\", {\n            get: function () { return this._framecount; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Application.prototype, \"timestep\", {\n            get: function () { return this._timestep; },\n            set: function (v) { this._timestep = v; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        ;\n        Application.prototype.startup = function (params) {\n            var _this = this;\n            Animyst.Log.output(\"===================================================\");\n            Animyst.Log.output(\"   ----- AnimystJS: (v \" + Animyst.VERSION + \") by ~Saykrd -----   \");\n            Animyst.Log.output(\"===================================================\");\n            Animyst.Log.output(\"Browser:\", Animyst.Environment.browserName);\n            Animyst.Log.output(\"Version:\", Animyst.Environment.browserVersion);\n            Animyst.Log.output(\"Platform:\", Animyst.Environment.platformName);\n            Animyst.Log.output(\"===================================================\");\n            this._startParams = params;\n            // Load all configuration files and and assets first\n            Animyst.DataLoad.startup({});\n            Animyst.DataLoad.loadAsset({ \"id\": \"config\", \"src\": \"config.json\" }, function (type, evt) { return _this.onLoading(type, evt); });\n        };\n        Application.prototype.onLoading = function (type, evt) {\n            if (type == Animyst.DataLoad.FILE_LOADED) {\n                switch (evt.item.id) {\n                    case \"config\":\n                        Animyst.Log.output(\"[Application] Config json loaded\");\n                        this.config = Animyst.DataLoad.getAsset(\"config\");\n                        this.appScope.config = this.config;\n                        Animyst.DataLoad.loadFromManifest([\n                            { \"id\": \"assets\", \"src\": this.config.assets },\n                            { \"id\": \"strings\", \"src\": this.config.strings }\n                        ]);\n                        break;\n                    case \"assets\":\n                        Animyst.Log.output(\"[Application] Assets json loaded\");\n                        var assets = Animyst.DataLoad.getAsset(\"assets\");\n                        Animyst.DataLoad.listAssets(assets.manifest);\n                        //Log.output(DataLoad._assetList);\n                        if (assets.initialLoad) {\n                            Animyst.DataLoad.loadFromManifest(assets.initialLoad);\n                        }\n                        break;\n                    case \"strings\":\n                        Animyst.Log.output(\"[Application] Strings json loaded\");\n                        break;\n                }\n            }\n            else if (type == Animyst.DataLoad.LOAD_COMPLETE) {\n                //DataLoad.removeLoadHandler(this._load);\n                this.init();\n            }\n        };\n        Application.prototype.init = function () {\n            var _this = this;\n            var params = this._startParams;\n            Animyst.LOGGING = this.config.settings.logging || Animyst.LOGGING;\n            Animyst.DEBUG = this.config.settings.debug || Animyst.DEBUG;\n            //window[\"Paper\"] = {};\n            //paper.install(window[\"Paper\"]);\n            Animyst.Log.output(\"[Application] Application Started\");\n            if (this.config.settings.debug) {\n                if (window[\"Stats\"] && !Animyst.Environment.isCocoonJS) {\n                    this._stats = new window[\"Stats\"]();\n                    this._stats.domElement.style.position = 'absolute';\n                    this._stats.domElement.style.left = '0px';\n                    this._stats.domElement.style.top = '0px';\n                    document.body.appendChild(this._stats.domElement);\n                    Animyst.Log.output(\"[Application] Stats Enabled\");\n                }\n                if (window[\"dat\"] && !Animyst.Environment.isCocoonJS) {\n                    Animyst.GUI = new window[\"dat\"].GUI();\n                }\n            }\n            var coreprocess = new Animyst.CoreProcess(Animyst.CoreProcess.ID);\n            this.run(coreprocess);\n            this.timestep = this.config.settings.timestep || this.timestep;\n            setInterval(function () { return _this.fixedUpdate; }, this.timestep);\n            if (window[\"view\"]) {\n                window[\"view\"].onFrame = this.frameUpdate.bind(this);\n            }\n            else {\n                this.initFrame();\n            }\n            this.initSignal.dispatch();\n        };\n        Application.prototype.initFrame = function () {\n            var _this = this;\n            requestAnimationFrame(function () { return _this.initFrame(); });\n            this.frameUpdate();\n        };\n        Application.prototype.run = function (appState) {\n            if (!this._appStateLib[appState.id]) {\n                this._appStateLib[appState.id] = appState;\n                this._appStateList.push(appState);\n                appState.setScope(this.appScope);\n                appState.framerate = this.framerate;\n                appState.timestep = this.timestep;\n                appState.setup();\n                appState.start();\n            }\n        };\n        Application.prototype.halt = function (appStateID) {\n            if (!this._appStateLib[appStateID]) {\n                this._appStateLib[appStateID].pause();\n            }\n        };\n        Application.prototype.resume = function (appStateID) {\n            if (!this._appStateLib[appStateID]) {\n                this._appStateLib[appStateID].resume();\n            }\n        };\n        Application.prototype.end = function (appStateID) {\n            if (!this._appStateLib[appStateID]) {\n                var appState = this._appStateLib[appStateID];\n                appState.kill();\n                this._appStateLib[appState.id] = null;\n                for (var i = 0; i < this._appStateList.length; i++) {\n                    var state = this._appStateList[i];\n                    if (state.id == appState.id) {\n                        this._appStateList.splice(i, 1);\n                        break;\n                    }\n                }\n            }\n        };\n        Application.prototype.endAll = function () {\n            for (var k in this._appStateLib) {\n                this.end(k);\n            }\n        };\n        Application.prototype.fixedUpdate = function () {\n            this.runtime += this.timestep;\n            for (var i = 0; i < this._appStateList.length; i++) {\n                var state = this._appStateList[i];\n                state.fixedUpdate(this.timestep, this.runtime);\n            }\n        };\n        Application.prototype.frameUpdate = function (event) {\n            // Calculate time intervals\n            var delta = 0;\n            var time = 0;\n            if (event) {\n                delta = event.delta;\n                time = event.time;\n            }\n            else {\n                time = Date.now();\n                delta = time - (this._lastFrame || Date.now());\n                this._lastFrame = time;\n            }\n            if (this._stats) {\n                this._stats.begin();\n            }\n            for (var i = 0; i < this._appStateList.length; i++) {\n                var state = this._appStateList[i];\n                state.update(delta, this._framecount);\n            }\n            this._framecount++;\n            if (this._stats) {\n                this._stats.end();\n            }\n        };\n        return Application;\n    }());\n    Animyst.Application = Application;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var AppScope = (function () {\n        function AppScope() {\n            this.databases = {};\n            // code...\n        }\n        AppScope.prototype.addDatabase = function (id, database) {\n            this.databases[id] = database;\n        };\n        AppScope.prototype.getDatabase = function (id) {\n            return this.databases[id];\n        };\n        return AppScope;\n    }());\n    Animyst.AppScope = AppScope;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var AppState = (function () {\n        function AppState(id) {\n            this._systemList = [];\n            this._systemLib = [];\n            this._framerate = 60;\n            this._timestep = 1000 / this.framerate;\n            this._id = id;\n        }\n        Object.defineProperty(AppState.prototype, \"id\", {\n            get: function () { return this._id; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(AppState.prototype, \"framerate\", {\n            get: function () { return this._framerate; },\n            set: function (v) { this._framerate = v; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        ;\n        Object.defineProperty(AppState.prototype, \"timestep\", {\n            get: function () { return this._timestep; },\n            set: function (v) { this._timestep = v; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        ;\n        AppState.prototype.setScope = function (appScope) {\n            this.appScope = appScope;\n        };\n        AppState.prototype.clearScope = function () {\n            this.appScope = null;\n        };\n        AppState.prototype.setup = function () {\n        };\n        AppState.prototype.start = function () {\n            this.active = true;\n        };\n        AppState.prototype.stop = function () {\n            this.active = false;\n            for (var i = 0; i < this._systemList.length; i++) {\n                var system = this._systemList[i];\n                system.shutdown();\n            }\n        };\n        AppState.prototype.update = function (delta, framecount) {\n            //console.log(\"[AppState] Updating...\", this);\n            if (this.active && !this.paused) {\n                for (var i = 0; i < this._systemList.length; i++) {\n                    var system = this._systemList[i];\n                    if (system.started && !system.paused) {\n                        system.update(delta, framecount);\n                    }\n                }\n            }\n        };\n        AppState.prototype.fixedUpdate = function (timestep, time) {\n            //console.log(\"[AppState] Updating...\", this);\n            if (this.active && !this.paused) {\n                for (var i = 0; i < this._systemList.length; i++) {\n                    var system = this._systemList[i];\n                    if (system.started && !system.paused) {\n                        system.fixedUpdate(timestep, time);\n                    }\n                }\n            }\n        };\n        AppState.prototype.pause = function () {\n            this.paused = true;\n        };\n        AppState.prototype.resume = function () {\n            this.paused = false;\n        };\n        AppState.prototype.kill = function () {\n            this.stop();\n            this.clearScope();\n            this._systemList = null;\n            this._systemLib = null;\n        };\n        AppState.prototype.restart = function () {\n        };\n        AppState.prototype.addSystem = function (id, system) {\n            if (!this._systemList[id]) {\n                this._systemLib[id] = system;\n                this._systemList.push(system);\n            }\n        };\n        AppState.prototype.getSystem = function (id) {\n            if (!this._systemList[id]) {\n                return this._systemLib[id];\n            }\n            console.error(\"[AppState] !! No system found with ID: \" + id);\n        };\n        return AppState;\n    }());\n    Animyst.AppState = AppState;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Database = (function () {\n        function Database() {\n            this._itemCount = 0;\n            this._items = {};\n            this._itemList = [];\n            this._categoryLists = {};\n            this._categoryChecks = {};\n            this.signal = new Animyst.Signal();\n            // code...\n        }\n        /**\n         * Adds an item category list to keep track of specific items\n         * @param {string} name    Name of category\n         * @param {function} check   A function evaluating the item. Ex: \"function (item) { if(shouldBeInList) return true; return false}\"\n         * @param {class} cls     The class type the item should belong to\n         * @param {ctx} context The 'this' variable to be used with the check\n         */\n        Database.prototype.addCategory = function (name, check, cls, context) {\n            this._categoryLists[name] = [];\n            this._categoryChecks[name] = { check: check, context: context, cls: cls };\n            this.traverse(this.list, this);\n        };\n        ;\n        /**\n         * Checks if a category exists\n         * @param {string} name [description]\n         */\n        Database.prototype.hasCategory = function (name) {\n            return this._categoryLists[name] != null;\n        };\n        ;\n        /**\n         * Adds item into all category lists that it belongs to\n         * @param {Item} item [description]\n         */\n        Database.prototype.list = function (item) {\n            for (var k in this._categoryLists) {\n                var data = this._categoryChecks[k];\n                if (item instanceof data.cls && data.check.call(data.context, item)) {\n                    Animyst.ArrayUtil.include(item.id, this._categoryLists[k]);\n                }\n            }\n        };\n        ;\n        /**\n         * Removes item from all categories\n         * @param {string} itemID [description]\n         */\n        Database.prototype.unlist = function (itemID) {\n            for (var k in this._categoryLists) {\n                for (var i = 0; i < this._categoryLists[k].length; i++) {\n                    Animyst.ArrayUtil.remove(itemID, this._categoryLists[k]);\n                }\n            }\n        };\n        ;\n        /**\n         * Returns the list of item ID's in a given category\n         * @param {string} category [description]\n         */\n        Database.prototype.getItemsInCategory = function (category) {\n            var items = this._categoryLists[category] || [];\n            for (var i = items.length - 1; i >= 0 && items.length > 0; i--) {\n                var item = this.getItem(items[i]);\n                if (!item) {\n                    items.splice(i, 1);\n                }\n            }\n            return items;\n        };\n        ;\n        /**\n         * Evaluates whether an item is listed in a specific category\n         * @param  {string}  itemID   [description]\n         * @param  {string}  category [description]\n         */\n        Database.prototype.isInCategory = function (itemID, category) {\n            var list = this._categoryLists[category];\n            return list.indexOf(itemID) > -1;\n        };\n        ;\n        /**\n         * Traverses a category of items or all items in this database and executes a command on all of them\n         * @param  {function} command  Command to execute on all items (\"function(item){//...}\")\n         * @param  {object} context  'this' variable for the command\n         * @param  {string} category Category to traverse. Traverses entire database if no category is specified\n         */\n        Database.prototype.traverse = function (command, context, category) {\n            if (category === void 0) { category = null; }\n            var list = this._categoryLists[category] || this._itemList;\n            for (var i = 0; i < list.length; i++) {\n                var item = this.getItem(list[i]);\n                if (item) {\n                    command.call(context, item);\n                }\n                else {\n                    list.splice(i, 1);\n                    i--;\n                    continue;\n                }\n            }\n        };\n        ;\n        /**\n         * Creates an item and adds it to the database\n         * @param {object} cls   Class of the item\n         * @param {string} id     Item ID\n         * @param {object} params Params to initialize the item\n         * @return {object} Returns the item that was added\n         */\n        Database.prototype.create = function (cls, id, params) {\n            if (!id) {\n                id = \"item\" + this._itemCount;\n            }\n            if (this._items[id]) {\n                id = id + this._itemCount;\n            }\n            var item = new cls(id, params);\n            item.id = id;\n            this._items[id] = item;\n            this._itemList.push(item.id);\n            this.list(item);\n            this._itemCount++;\n            item.signal = this.signal;\n            this.signal.dispatch(Database.ADDED, item.id);\n            return item;\n        };\n        ;\n        /**\n         * Removes item from database\n         * @param {string} itemID [description]\n         */\n        Database.prototype.remove = function (itemID) {\n            if (!this._items[itemID])\n                return;\n            var item = this.getItem(itemID);\n            this.unlist(itemID);\n            delete this._items[itemID];\n            this.signal.dispatch(Database.REMOVED, itemID);\n        };\n        ;\n        /**\n         * Removes all items in database\n         */\n        Database.prototype.removeAll = function () {\n            this.traverse(function (item) { this.remove(item.id); }, this);\n        };\n        ;\n        /**\n         * Returns item in database\n         * @param {string} itemID [description]\n         */\n        Database.prototype.getItem = function (itemID) {\n            return this._items[itemID];\n        };\n        ;\n        Database.prototype.clear = function () {\n        };\n        Database.prototype.destroy = function () {\n        };\n        return Database;\n    }());\n    Database.ADDED = 'added';\n    Database.REMOVED = 'removed';\n    Animyst.Database = Database;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var DataLoad = (function () {\n        function DataLoad(argument) {\n            // code...\n        }\n        DataLoad.startup = function (params) {\n            DataLoad.LoadQueue = window[\"createjs\"].LoadQueue;\n            DataLoad._loadQueue = new DataLoad.LoadQueue(true);\n            DataLoad._loadSignal = new Animyst.Signal();\n            var queue = DataLoad._loadQueue;\n            queue.on(\"fileload\", DataLoad.handleFileLoaded);\n            queue.on(\"complete\", DataLoad.handleLoadComplete);\n            queue.on(\"fileerror\", DataLoad.handleFileError);\n            queue.on(\"error\", DataLoad.handleLoaderError);\n            queue.on(\"filestart\", DataLoad.handleFileStart);\n            queue.on(\"initialize\", DataLoad.handleLoadInitialize);\n            queue.on(\"loadstart\", DataLoad.handleLoadStart);\n            queue.on(\"fileprogress\", DataLoad.handleFileProgress);\n            queue.on(\"progress\", DataLoad.handleOverallProgress);\n            DataLoad._fileStartedSignal = new Animyst.Signal();\n            ;\n            DataLoad._fileProgressSignal = new Animyst.Signal();\n            ;\n            DataLoad._fileLoadedSignal = new Animyst.Signal();\n            ;\n            DataLoad._fileErrorSignal = new Animyst.Signal();\n            ;\n            DataLoad._queueStartedSignal = new Animyst.Signal();\n            ;\n            DataLoad._queueProgressSignal = new Animyst.Signal();\n            ;\n            DataLoad._queueLoadedSignal = new Animyst.Signal();\n            ;\n            DataLoad._queueErrorSignal = new Animyst.Signal();\n            ;\n            if (params.manifest != null) {\n            }\n        };\n        DataLoad.listAssets = function (manifest) {\n            var assetList = DataLoad._assetList;\n            for (var i = 0; i < manifest.length; i++) {\n                var item = manifest[i];\n                assetList[item.id] = item;\n            }\n        };\n        DataLoad.loadFromManifest = function (value, loadHandler, persistant) {\n            if (persistant === void 0) { persistant = false; }\n            var queue = DataLoad._loadQueue;\n            var manifest = [];\n            for (var i = 0; i < value.length; i++) {\n                var v = value[i];\n                var item;\n                if (typeof v == \"string\") {\n                    item = { \"id\": v, \"src\": v };\n                }\n                else {\n                    item = { \"id\": v.id, \"src\": v.src };\n                }\n                if (!DataLoad._assetList[item.id]) {\n                    DataLoad._assetList[item.id] = item;\n                }\n                manifest.push(DataLoad._assetList[item.id]);\n            }\n            DataLoad.addLoadHandler(loadHandler, persistant);\n            DataLoad._busy = true;\n            queue.loadManifest(manifest);\n        };\n        DataLoad.loadAsset = function (value, loadHandler, persistant) {\n            if (persistant === void 0) { persistant = false; }\n            var queue = DataLoad._loadQueue;\n            var item;\n            if (typeof value == \"string\") {\n                item = { \"id\": value, \"src\": value };\n            }\n            else {\n                item = { \"id\": value.id, \"src\": value.src };\n            }\n            if (!DataLoad._assetList[item.id]) {\n                DataLoad._assetList[item.id] = item;\n            }\n            DataLoad.addLoadHandler(loadHandler, persistant);\n            DataLoad._busy = true;\n            queue.loadFile(DataLoad._assetList[item.id]);\n        };\n        DataLoad.getAsset = function (id) {\n            return DataLoad._loadQueue.getResult(id);\n        };\n        DataLoad.getData = function (id) {\n            return DataLoad._assetList[id];\n        };\n        //=========== HANDLER MANAGEMENT =========\n        DataLoad.addLoadHandler = function (handler, persistant) {\n            if (persistant === void 0) { persistant = false; }\n            if (!handler)\n                return;\n            if (!persistant) {\n                DataLoad._weakHandlers.push(handler);\n            }\n            DataLoad._loadSignal.add(handler);\n        };\n        DataLoad.removeLoadHandler = function (handler) {\n            for (var i = DataLoad._weakHandlers.length - 1; i >= 0 && DataLoad._weakHandlers.length > 0; i--) {\n                var h = DataLoad._weakHandlers[i];\n                if (h == handler) {\n                    DataLoad._weakHandlers.splice(i, 1);\n                    break;\n                }\n            }\n            DataLoad._loadSignal.remove(handler);\n        };\n        DataLoad.removeWeakHandlers = function (handlers) {\n            var loadSignal = DataLoad._loadSignal;\n            while (handlers.length > 0) {\n                var handler = handlers.shift();\n                DataLoad.removeLoadHandler(handler);\n            }\n        };\n        DataLoad.addCommand = function (commandID, command, addOnce) {\n            if (addOnce === void 0) { addOnce = false; }\n            var signal;\n            switch (commandID) {\n                case DataLoad.LOAD_STARTED:\n                    signal = DataLoad._queueStartedSignal;\n                    break;\n                case DataLoad.FILE_STARTED:\n                    signal = DataLoad._fileStartedSignal;\n                    break;\n                case DataLoad.LOAD_PROGRESS:\n                    signal = DataLoad._queueProgressSignal;\n                    break;\n                case DataLoad.FILE_PROGRESS:\n                    signal = DataLoad._fileProgressSignal;\n                    break;\n                case DataLoad.LOAD_COMPLETE:\n                    signal = DataLoad._queueLoadedSignal;\n                    break;\n                case DataLoad.FILE_LOADED:\n                    signal = DataLoad._fileLoadedSignal;\n                    break;\n                case DataLoad.LOAD_ERROR:\n                    signal = DataLoad._queueErrorSignal;\n                    break;\n                case DataLoad.FILE_ERROR:\n                    signal = DataLoad._fileErrorSignal;\n                    break;\n            }\n            if (addOnce) {\n                signal.addOnce(command);\n            }\n            else {\n                signal.add(command);\n            }\n        };\n        DataLoad.removeCommand = function (commandID, command) {\n            var signal;\n            switch (commandID) {\n                case DataLoad.LOAD_STARTED:\n                    signal = DataLoad._queueStartedSignal;\n                    break;\n                case DataLoad.FILE_STARTED:\n                    signal = DataLoad._fileStartedSignal;\n                    break;\n                case DataLoad.LOAD_PROGRESS:\n                    signal = DataLoad._queueProgressSignal;\n                    break;\n                case DataLoad.FILE_PROGRESS:\n                    signal = DataLoad._fileProgressSignal;\n                    break;\n                case DataLoad.LOAD_COMPLETE:\n                    signal = DataLoad._queueLoadedSignal;\n                    break;\n                case DataLoad.FILE_LOADED:\n                    signal = DataLoad._fileLoadedSignal;\n                    break;\n                case DataLoad.LOAD_ERROR:\n                    signal = DataLoad._queueErrorSignal;\n                    break;\n                case DataLoad.FILE_ERROR:\n                    signal = DataLoad._fileErrorSignal;\n                    break;\n            }\n            signal.remove(command);\n        };\n        //=========== LOAD EVENTS =========\n        DataLoad.handleLoadInitialize = function (event) {\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.LOAD_INITIALIZE, event);\n        };\n        DataLoad.handleLoadStart = function (event) {\n            Animyst.Log.output(\"[DataLoad] Load Started!\");\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.LOAD_STARTED, event);\n            DataLoad._queueStartedSignal.dispatch(event);\n        };\n        DataLoad.handleFileStart = function (event) {\n            Animyst.Log.output(\"[DataLoad] Loading File:\", event.item.id, \"from:\", event.item.src);\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.FILE_STARTED, event);\n            DataLoad._fileStartedSignal.dispatch(event);\n        };\n        DataLoad.handleFileLoaded = function (event) {\n            Animyst.Log.output(\"[DataLoad] File Loaded:\", event.item.id, \"from:\", event.item.src);\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.FILE_LOADED, event);\n            DataLoad._fileLoadedSignal.dispatch(event);\n        };\n        DataLoad.handleLoadComplete = function (event) {\n            Animyst.Log.output(\"[DataLoad] Load Completed!\");\n            var loadSignal = DataLoad._loadSignal;\n            var handlersToRemove = DataLoad._weakHandlers.concat();\n            loadSignal.dispatch(DataLoad.LOAD_COMPLETE, event);\n            DataLoad._queueLoadedSignal.dispatch(event);\n            DataLoad.removeWeakHandlers(handlersToRemove);\n        };\n        DataLoad.handleFileProgress = function (event) {\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.FILE_PROGRESS, event);\n            DataLoad._fileProgressSignal.dispatch(event);\n        };\n        DataLoad.handleOverallProgress = function (event) {\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.LOAD_PROGRESS, event);\n            DataLoad._queueProgressSignal.dispatch(event);\n        };\n        DataLoad.handleFileError = function (event) {\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.FILE_ERROR, event);\n            DataLoad._fileErrorSignal.dispatch(event);\n        };\n        DataLoad.handleLoaderError = function (event) {\n            var loadSignal = DataLoad._loadSignal;\n            loadSignal.dispatch(DataLoad.LOAD_ERROR, event);\n            DataLoad._queueErrorSignal.dispatch(event);\n        };\n        return DataLoad;\n    }());\n    DataLoad.LOAD_INITIALIZE = 0;\n    DataLoad.LOAD_STARTED = 1;\n    DataLoad.LOAD_PROGRESS = 2;\n    DataLoad.LOAD_COMPLETE = 3;\n    DataLoad.LOAD_ERROR = 4;\n    DataLoad.FILE_STARTED = 5;\n    DataLoad.FILE_PROGRESS = 6;\n    DataLoad.FILE_LOADED = 7;\n    DataLoad.FILE_ERROR = 9;\n    DataLoad._assetList = {};\n    DataLoad._weakHandlers = []; // List of handlers to remove once the load is completed\n    DataLoad._loadQueue = null; // CreateJS load queue\n    DataLoad._loadSignal = null;\n    DataLoad._fileStartedSignal = null;\n    DataLoad._fileProgressSignal = null;\n    DataLoad._fileLoadedSignal = null;\n    DataLoad._fileErrorSignal = null;\n    DataLoad._queueStartedSignal = null;\n    DataLoad._queueProgressSignal = null;\n    DataLoad._queueLoadedSignal = null;\n    DataLoad._queueErrorSignal = null;\n    DataLoad._busy = false;\n    Animyst.DataLoad = DataLoad;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Environment = (function () {\n        function Environment(argument) {\n            // code...\n        }\n        //========================================\n        Environment._setup = function () {\n            Environment._checkBrowser();\n            Environment._checkPlatform();\n            Environment._checkDevice();\n        };\n        Environment._checkPlatform = function () {\n            var userAgent = navigator.userAgent;\n            if (/Linux/.test(userAgent)) {\n                Environment.platformName = \"Linux\";\n                Environment.isLinux = true;\n            }\n            if (/Android/.test(userAgent)) {\n                Environment.platformName = \"Android\";\n                Environment.isAndroid = true;\n            }\n            if (/CrOS/.test(userAgent)) {\n                Environment.platformName = \"ChromeOS\";\n                Environment.isChromeOS = true;\n            }\n            if (/iP[ao]d|iPhone/i.test(userAgent)) {\n                Environment.platformName = \"iOS\";\n                Environment.isIOS = true;\n            }\n            if (/Mac OS/.test(userAgent)) {\n                Environment.platformName = \"Mac\";\n                Environment.isMacOS = true;\n            }\n            if (/Windows/.test(userAgent)) {\n                Environment.platformName = \"Windows\";\n                Environment.isWindows = true;\n            }\n            if (Environment.isWindows || Environment.isMacOS || Environment.isLinux) {\n                Environment.isDesktop = true;\n            }\n            if (Environment.isAndroid || Environment.isIOS || Environment.isWebApp) {\n                Environment.isMobile = true;\n            }\n        };\n        Environment._checkDevice = function () {\n            Environment.pixelRatio = window.devicePixelRatio || 1;\n            Environment.colorDepth = window.screen.colorDepth;\n            if (Environment.isMobile) {\n                Environment.screenWidth = window.screen.width * Environment.pixelRatio;\n                Environment.screenHeight = window.screen.height * Environment.pixelRatio;\n            }\n            else {\n                Environment.screenWidth = window.screen.width;\n                Environment.screenHeight = window.screen.height;\n            }\n        };\n        Environment._checkBrowser = function () {\n            var userAgent = navigator.userAgent;\n            if (/Safari/.test(userAgent)) {\n                Environment.browserName = \"Safari\";\n                Environment.isSafari = true;\n                Environment.browserVersion = (userAgent.indexOf(\"Version\") != -1) ? userAgent.substring(userAgent.indexOf(\"Version\") + 8) : userAgent.substring(userAgent.indexOf(\"Safari\") + 7);\n            }\n            if (/Mobile(.*)Safari/.test(userAgent)) {\n                Environment.browserName = \"MobileSafari\";\n                Environment.isSafari = true;\n                Environment.browserVersion = (userAgent.indexOf(\"Version\") != -1) ? userAgent.substring(userAgent.indexOf(\"Version\") + 8) : userAgent.substring(userAgent.indexOf(\"Safari\") + 7);\n            }\n            if (/Chrome/.test(userAgent)) {\n                Environment.browserName = \"Chrome\";\n                Environment.isChrome = true;\n                Environment.browserVersion = userAgent.substring(userAgent.indexOf(\"Chrome\") + 7, userAgent.indexOf(\" Safari\") || null);\n            }\n            if (/Firefox/.test(userAgent)) {\n                Environment.browserName = \"Firefox\";\n                Environment.isFirefox = true;\n                Environment.browserVersion = userAgent.substring(userAgent.indexOf(\"Firefox\") + 8);\n            }\n            if (/MSIE (\\d+\\.\\d+);/.test(userAgent)) {\n                Environment.browserName = \"MSIE\";\n                Environment.isIE = true;\n                Environment.browserVersion = userAgent.substring(userAgent.indexOf(\"MSIE\") + 5);\n            }\n            if (/Edge/.test(userAgent)) {\n                Environment.browserName = \"MSEdge\";\n                Environment.isEdge = true;\n                Environment.browserVersion = userAgent.substring(userAgent.indexOf(\"Edge\") + 5);\n            }\n            if (navigator['standalone']) {\n                Environment.browserName = \"WebApp\";\n                Environment.isWebApp = true;\n            }\n            if (navigator['isCocoonJS']) {\n                Environment.browserName = \"CocoonJS\";\n                Environment.isCocoonJS = true;\n            }\n            Environment.url = window.location.href;\n            Environment.queryString = window.location.search;\n            Environment.host = window.location.hostname;\n            Environment.path = window.location.pathname;\n            Environment.port = window.location.port;\n            var details = Environment.browserVersion.split(\".\");\n            switch (details.length) {\n                case 1:\n                    Environment.browserDetails.major = parseInt(details[0]);\n                    break;\n                case 2:\n                    Environment.browserDetails.major = parseInt(details[0]);\n                    Environment.browserDetails.minor = parseInt(details[1]);\n                    break;\n                case 3:\n                    Environment.browserDetails.major = parseInt(details[0]);\n                    Environment.browserDetails.minor = parseInt(details[1]);\n                    Environment.browserDetails.build = parseInt(details[2]);\n                    break;\n                case 4:\n                    Environment.browserDetails.major = parseInt(details[0]);\n                    Environment.browserDetails.minor = parseInt(details[1]);\n                    Environment.browserDetails.build = parseInt(details[2]);\n                    Environment.browserDetails.revision = parseInt(details[3]);\n                    break;\n            }\n        };\n        Environment.getURLParameterByName = function (name, escapeSpaces) {\n            if (escapeSpaces === void 0) { escapeSpaces = false; }\n            if (escapeSpaces === null)\n                escapeSpaces = true;\n            var match = new RegExp('[?&]' + name + '=([^&]*)').exec(Environment.queryString);\n            return (escapeSpaces) ? match && decodeURIComponent(match[1].replace(/\\/+/g, '')) : match && decodeURIComponent(match[1]);\n        };\n        return Environment;\n    }());\n    //========================================\n    //------------- Platform -----------------\n    //========================================\n    Environment.isDesktop = false;\n    Environment.isMobile = false;\n    Environment.isIOS = false;\n    Environment.isAndroid = false;\n    Environment.isChromeOS = false;\n    Environment.isMacOS = false;\n    Environment.isWindows = false;\n    Environment.isLinux = false;\n    Environment.platformName = \"\";\n    //========================================\n    //------------- Device -------------------\n    //========================================\n    Environment.pixelRatio = 1;\n    Environment.colorDepth = -1;\n    Environment.screenWidth = -1;\n    Environment.screenHeight = -1;\n    //========================================\n    //------------- Browser ------------------\n    //========================================\n    Environment.isChrome = false;\n    Environment.isFirefox = false;\n    Environment.isIE = false;\n    Environment.isEdge = false;\n    Environment.isSafari = false;\n    Environment.isWebApp = false;\n    Environment.isCocoonJS = false;\n    Environment.browserVersion = \"\";\n    Environment.browserName = \"\";\n    Environment.browserDetails = {};\n    Environment.url = \"\";\n    Environment.host = \"\";\n    Environment.path = \"\";\n    Environment.port = \"\";\n    Environment.queryString = \"\";\n    Animyst.Environment = Environment;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Item = (function () {\n        function Item(id, params) {\n            // code...\n            this.id = id;\n            this.startParams = params;\n            this.setup(params);\n        }\n        Item.prototype.setup = function (params) {\n        };\n        Item.prototype.reset = function () {\n            this.setup(this.startParams);\n        };\n        Item.prototype.destroy = function () {\n            this.startParams = null;\n        };\n        return Item;\n    }());\n    Animyst.Item = Item;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Log = (function () {\n        function Log() {\n        }\n        Log.output = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            if (!Animyst.LOGGING)\n                return;\n            var logData = [];\n            logData.push(\":[LOG]:\");\n            for (var i = 0; i < args.length; i++) {\n                logData.push(args[i]);\n            }\n            console.log.apply(console, logData);\n        };\n        Log.error = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            if (!Animyst.LOGGING)\n                return;\n            var logData = [];\n            logData.push(\":[ERROR]:\");\n            for (var i = 0; i < args.length; i++) {\n                logData.push(args[i]);\n            }\n            console.error.apply(console, logData);\n        };\n        return Log;\n    }());\n    Animyst.Log = Log;\n})(Animyst || (Animyst = {}));\n/// <reference path=\"Signal.ts\" />\n/*\n*\t@desc   \tAn object that represents a binding between a Signal and a listener function.\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.kiwijs.org\n*\n*/\nvar Animyst;\n/// <reference path=\"Signal.ts\" />\n/*\n*\t@desc   \tAn object that represents a binding between a Signal and a listener function.\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.kiwijs.org\n*\n*/\n(function (Animyst) {\n    var SignalBinding = (function () {\n        /**\n        * Object that represents a binding between a Signal and a listener function.\n        * <br />- <strong>This is an internal constructor and shouldn't be called by regular users.</strong>\n        * <br />- inspired by Joa Ebert AS3 SignalBinding and Robert Penner's Slot classes.\n        * @author Miller Medeiros\n        * @constructor\n        * @internal\n        * @name SignalBinding\n        * @param {Signal} signal Reference to Signal object that listener is currently bound to.\n        * @param {Function} listener Handler function bound to the signal.\n        * @param {boolean} isOnce If binding should be executed just once.\n        * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n        * @param {Number} [priority] The priority level of the event listener. (default = 0).\n        */\n        function SignalBinding(signal, listener, isOnce, listenerContext, priority) {\n            if (priority === void 0) { priority = 0; }\n            /**\n            * If binding is active and should be executed.\n            * @type boolean\n            */\n            this.active = true;\n            /**\n            * Default parameters passed to listener during `Signal.dispatch` and `SignalBinding.execute`. (curried parameters)\n            * @type Array|null\n            */\n            this.params = null;\n            this._listener = listener;\n            this._isOnce = isOnce;\n            this.context = listenerContext;\n            this._signal = signal;\n            this.priority = priority || 0;\n        }\n        /**\n        * Call listener passing arbitrary parameters.\n        * <p>If binding was added using `Signal.addOnce()` it will be automatically removed from signal dispatch queue, this method is used internally for the signal dispatch.</p>\n        * @param {Array} [paramsArr] Array of parameters that should be passed to the listener\n        * @return {*} Value returned by the listener.\n        */\n        SignalBinding.prototype.execute = function (paramsArr) {\n            var handlerReturn;\n            var params;\n            if (this.active && !!this._listener) {\n                params = this.params ? this.params.concat(paramsArr) : paramsArr;\n                handlerReturn = this._listener.apply(this.context, params);\n                if (this._isOnce) {\n                    this.detach();\n                }\n            }\n            return handlerReturn;\n        };\n        /**\n        * Detach binding from signal.\n        * - alias to:mySignal.remove(myBinding.getListener());\n        * @return {Function|null} Handler function bound to the signal or `null` if binding was previously detached.\n        */\n        SignalBinding.prototype.detach = function () {\n            return this.isBound() ? this._signal.remove(this._listener, this.context) : null;\n        };\n        /**\n        * @return {Boolean} `true` if binding is still bound to the signal and have a listener.\n        */\n        SignalBinding.prototype.isBound = function () {\n            return (!!this._signal && !!this._listener);\n        };\n        /**\n        * @return {boolean} If SignalBinding will only be executed once.\n        */\n        SignalBinding.prototype.isOnce = function () {\n            return this._isOnce;\n        };\n        /**\n        * @return {Function} Handler function bound to the signal.\n        */\n        SignalBinding.prototype.getListener = function () {\n            return this._listener;\n        };\n        /**\n        * @return {Signal} Signal that listener is currently bound to.\n        */\n        SignalBinding.prototype.getSignal = function () {\n            return this._signal;\n        };\n        /**\n        * Delete instance properties\n        * @private\n        */\n        SignalBinding.prototype._destroy = function () {\n            delete this._signal;\n            delete this._listener;\n            delete this.context;\n        };\n        /**\n        * @return {string} String representation of the object.\n        */\n        SignalBinding.prototype.toString = function () {\n            return '[SignalBinding isOnce:' + this._isOnce + ', isBound:' + this.isBound() + ', active:' + this.active + ']';\n        };\n        return SignalBinding;\n    }());\n    Animyst.SignalBinding = SignalBinding;\n})(Animyst || (Animyst = {}));\n/// <reference path=\"SignalBinding.ts\" />\n/**\n*\t@desc       A TypeScript conversion of JS Signals by Miller Medeiros\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.photonstorm.com\n*/\n/**\n* Custom event broadcaster\n* <br />- inspired by Robert Penner's AS3 Signals.\n* @name Signal\n* @author Miller Medeiros\n* @constructor\n*/\nvar Animyst;\n/// <reference path=\"SignalBinding.ts\" />\n/**\n*\t@desc       A TypeScript conversion of JS Signals by Miller Medeiros\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.photonstorm.com\n*/\n/**\n* Custom event broadcaster\n* <br />- inspired by Robert Penner's AS3 Signals.\n* @name Signal\n* @author Miller Medeiros\n* @constructor\n*/\n(function (Animyst) {\n    var Signal = (function () {\n        function Signal() {\n            /**\n            * @property _bindings\n            * @type Array\n            * @private\n            */\n            this._bindings = [];\n            /**\n            * @property _prevParams\n            * @type Any\n            * @private\n            */\n            this._prevParams = null;\n            /**\n            * If Signal should keep record of previously dispatched parameters and\n            * automatically execute listener during `add()`/`addOnce()` if Signal was\n            * already dispatched before.\n            * @type boolean\n            */\n            this.memorize = false;\n            /**\n            * @type boolean\n            * @private\n            */\n            this._shouldPropagate = true;\n            /**\n            * If Signal is active and should broadcast events.\n            * <p><strong>IMPORTANT:</strong> Setting this property during a dispatch will only affect the next dispatch, if you want to stop the propagation of a signal use `halt()` instead.</p>\n            * @type boolean\n            */\n            this.active = true;\n        }\n        /**\n        * @method validateListener\n        * @param {Any} listener\n        * @param {Any} fnName\n        */\n        Signal.prototype.validateListener = function (listener, fnName) {\n            if (typeof listener !== 'function') {\n                throw new Error('listener is a required param of {fn}() and should be a Function.'.replace('{fn}', fnName));\n            }\n        };\n        /**\n        * @param {Function} listener\n        * @param {boolean} isOnce\n        * @param {Object} [listenerContext]\n        * @param {Number} [priority]\n        * @return {SignalBinding}\n        * @private\n        */\n        Signal.prototype._registerListener = function (listener, isOnce, listenerContext, priority) {\n            var prevIndex = this._indexOfListener(listener, listenerContext);\n            var binding;\n            if (prevIndex !== -1) {\n                binding = this._bindings[prevIndex];\n                if (binding.isOnce() !== isOnce) {\n                    throw new Error('You cannot add' + (isOnce ? '' : 'Once') + '() then add' + (!isOnce ? '' : 'Once') + '() the same listener without removing the relationship first.');\n                }\n            }\n            else {\n                binding = new Animyst.SignalBinding(this, listener, isOnce, listenerContext, priority);\n                this._addBinding(binding);\n            }\n            if (this.memorize && this._prevParams) {\n                binding.execute(this._prevParams);\n            }\n            return binding;\n        };\n        /**\n        * @method _addBinding\n        * @param {SignalBinding} binding\n        * @private\n        */\n        Signal.prototype._addBinding = function (binding) {\n            //simplified insertion sort\n            var n = this._bindings.length;\n            do {\n                --n;\n            } while (this._bindings[n] && binding.priority <= this._bindings[n].priority);\n            this._bindings.splice(n + 1, 0, binding);\n        };\n        /**\n        * @method _indexOfListener\n        * @param {Function} listener\n        * @return {number}\n        * @private\n        */\n        Signal.prototype._indexOfListener = function (listener, context) {\n            var n = this._bindings.length;\n            var cur;\n            while (n--) {\n                cur = this._bindings[n];\n                if (cur.getListener() === listener && cur.context === context) {\n                    return n;\n                }\n            }\n            return -1;\n        };\n        /**\n        * Check if listener was attached to Signal.\n        * @param {Function} listener\n        * @param {Object} [context]\n        * @return {boolean} if Signal has the specified listener.\n        */\n        Signal.prototype.has = function (listener, context) {\n            return this._indexOfListener(listener, context) !== -1;\n        };\n        /**\n        * Add a listener to the signal.\n        * @param {Function} listener Signal handler function.\n        * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n        * @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n        * @return {SignalBinding} An Object representing the binding between the Signal and listener.\n        */\n        Signal.prototype.add = function (listener, listenerContext, priority) {\n            if (priority === void 0) { priority = 0; }\n            this.validateListener(listener, 'add');\n            return this._registerListener(listener, false, listenerContext, priority);\n        };\n        /**\n        * Add listener to the signal that should be removed after first execution (will be executed only once).\n        * @param {Function} listener Signal handler function.\n        * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n        * @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n        * @return {SignalBinding} An Object representing the binding between the Signal and listener.\n        */\n        Signal.prototype.addOnce = function (listener, listenerContext, priority) {\n            if (priority === void 0) { priority = 0; }\n            this.validateListener(listener, 'addOnce');\n            return this._registerListener(listener, true, listenerContext, priority);\n        };\n        /**\n        * Remove a single listener from the dispatch queue.\n        * @param {Function} listener Handler function that should be removed.\n        * @param {Object} [context] Execution context (since you can add the same handler multiple times if executing in a different context).\n        * @return {Function} Listener handler function.\n        */\n        Signal.prototype.remove = function (listener, context) {\n            this.validateListener(listener, 'remove');\n            var i = this._indexOfListener(listener, context);\n            if (i !== -1) {\n                this._bindings[i]._destroy(); //no reason to a SignalBinding exist if it isn't attached to a signal\n                this._bindings.splice(i, 1);\n            }\n            return listener;\n        };\n        /**\n        * Remove all listeners from the Signal.\n        */\n        Signal.prototype.removeAll = function () {\n            var n = this._bindings.length;\n            while (n--) {\n                this._bindings[n]._destroy();\n            }\n            this._bindings.length = 0;\n        };\n        /**\n        * @return {number} Number of listeners attached to the Signal.\n        */\n        Signal.prototype.getNumListeners = function () {\n            return this._bindings.length;\n        };\n        /**\n        * Stop propagation of the event, blocking the dispatch to next listeners on the queue.\n        * <p><strong>IMPORTANT:</strong> should be called only during signal dispatch, calling it before/after dispatch won't affect signal broadcast.</p>\n        * @see Signal.prototype.disable\n        */\n        Signal.prototype.halt = function () {\n            this._shouldPropagate = false;\n        };\n        /**\n        * Dispatch/Broadcast Signal to all listeners added to the queue.\n        * @param {...*} [params] Parameters that should be passed to each handler.\n        */\n        Signal.prototype.dispatch = function () {\n            var paramsArr = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                paramsArr[_i] = arguments[_i];\n            }\n            if (!this.active) {\n                return;\n            }\n            var n = this._bindings.length;\n            var bindings;\n            if (this.memorize) {\n                this._prevParams = paramsArr;\n            }\n            if (!n) {\n                //should come after memorize\n                return;\n            }\n            bindings = this._bindings.slice(0); //clone array in case add/remove items during dispatch\n            this._shouldPropagate = true; //in case `halt` was called before dispatch or during the previous dispatch.\n            //execute all callbacks until end of the list or until a callback returns `false` or stops propagation\n            //reverse loop since listeners with higher priority will be added at the end of the list\n            do {\n                n--;\n            } while (bindings[n] && this._shouldPropagate && bindings[n].execute(paramsArr) !== false);\n        };\n        /**\n        * Forget memorized arguments.\n        * @see Signal.memorize\n        */\n        Signal.prototype.forget = function () {\n            this._prevParams = null;\n        };\n        /**\n        * Remove all bindings from signal and destroy any reference to external objects (destroy Signal object).\n        * <p><strong>IMPORTANT:</strong> calling any method on the signal instance after calling dispose will throw errors.</p>\n        */\n        Signal.prototype.dispose = function () {\n            this.removeAll();\n            delete this._bindings;\n            delete this._prevParams;\n        };\n        /**\n        * @return {string} String representation of the object.\n        */\n        Signal.prototype.toString = function () {\n            return '[Signal active:' + this.active + ' numListeners:' + this.getNumListeners() + ']';\n        };\n        return Signal;\n    }());\n    /**\n    * Signals Version Number\n    * @property VERSION\n    * @type String\n    * @const\n    */\n    Signal.VERSION = '1.0.0';\n    Animyst.Signal = Signal;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var System = (function () {\n        function System() {\n        }\n        Object.defineProperty(System.prototype, \"paused\", {\n            get: function () { return this._paused; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(System.prototype, \"started\", {\n            get: function () { return this._started; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        System.prototype.startup = function (params) {\n            this._started = true;\n            this._startupParams = params;\n        };\n        System.prototype.shutdown = function () {\n            this._started = false;\n        };\n        System.prototype.update = function (delta, framecount) {\n        };\n        System.prototype.fixedUpdate = function (timestep, time) {\n        };\n        return System;\n    }());\n    Animyst.System = System;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var View3D = (function (_super) {\n        __extends(View3D, _super);\n        function View3D() {\n            return _super.call(this) || this;\n        }\n        Object.defineProperty(View3D.prototype, \"aspect\", {\n            get: function () { return this.width / this.height; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        View3D.prototype.clear = function () {\n            Animyst.Database.prototype.clear.call(this);\n        };\n        View3D.prototype.destroy = function () {\n            Animyst.Database.prototype.destroy.call(this);\n        };\n        View3D.prototype.initDisplay = function (params) {\n            if (!params) {\n                Animyst.Log.error(\"[View3D] No initialization params specified\");\n                return;\n            }\n            this.viewAngle = params.viewAngle || this.viewAngle;\n            this.near = params.near || this.near;\n            this.far = params.far || this.far;\n            this._resize = params.resize;\n            this._scene = this._scene || new THREE.Scene();\n            this._renderer = new THREE.WebGLRenderer();\n            this._camera = new THREE.PerspectiveCamera(this.viewAngle, this.aspect, this.near, this.far);\n            this._scene.add(this._camera);\n            this._camera.lookAt(this._scene.position);\n            if (params.container) {\n                var container = document.getElementById(params.container);\n                if (container) {\n                    container.appendChild(this._renderer.domElement);\n                }\n                else {\n                    Animyst.Log.error(\"[View3D] Container ID\", params.container, \"doesn't exist\");\n                }\n            }\n            this._camera.position.x = params.cameraX || 500;\n            this._camera.position.y = params.cameraY || 500;\n            this._camera.position.z = params.cameraZ || 500;\n            this._camera.lookAt(this._scene.position);\n            this._renderer.setClearColor(params.rendererColor || 0x888888);\n            this._renderer.setSize(this.width, this.height);\n            //this._renderer.shadowMapEnabled = false;\n            /*var geom = new THREE.PlaneGeometry(this.width, this.height, 32 );\n            var texture = new PIXITexture(new PIXI.Stage(0xFFFFFF), new PIXI.WebGLRenderer(this.width, this.height, {transparent : true}));\n            var matr = new THREE.MeshBasicMaterial({map:texture, side:THREE.DoubleSide});\n            matr.transparent = true;\n            this.ui = new THREE.Mesh( geom, matr);\n\n            let vFOV = this.camera.fov * (Math.PI / 180);\n            let distance =  this.height / (2 * Math.tan(vFOV / 2));\n\n            this.ui.position.set(0,0, -distance);\n            this.scene.add(this.ui);\n\n            this.camera.add(this.ui);*/\n            /*this.stage    = new PIXI.Stage(0xFFFFFF);\n            this.uiRenderer = new PIXI.WebGLRenderer(this.width, this.height, {transparent : true});\n\n            this.image = this.renderer.view;\n\n            let graphics = new PIXI.Graphics();\n            graphics.lineStyle(2, 0xFF00FF, 1);\n            graphics.beginFill(0xFF00BB, 0.25);\n            graphics.drawCircle(this.width/2, this.height/2, 100, 100);\n            graphics.endFill();\n\n            let texture = PIXI.Texture.fromCanvas(DataLoad.getAsset('samusftilt'));\n            let sprite = new PIXI.Sprite(texture);\n            this.stage.addChild(sprite);\n\n            this.stage.addChild(graphics);\n\n            this.uiRenderer.render(this.stage);*/\n            if (params.addAxis) {\n                var axis = new THREE.AxisHelper(20);\n                this._scene.add(axis);\n            }\n            if (params.debugControls) {\n                var controls = new THREE.OrbitControls(this._camera);\n                if (Animyst.GUI) {\n                    var displayControls = Animyst.GUI.addFolder(\"Viewport3D\");\n                    var c_folder = displayControls.addFolder(\"camera\");\n                    c_folder.add(this._camera.position, \"x\", -1000, 1000).listen();\n                    c_folder.add(this._camera.position, \"y\", -1000, 1000).listen();\n                    c_folder.add(this._camera.position, \"z\", -1000, 1000).listen();\n                }\n            }\n            if (params.resize) {\n                Animyst.Window.resizeSignal.add(this.onResize, this);\n            }\n            this._view = document.createElement('canvas');\n            this._view.width = this.width;\n            this._view.height = this.height;\n            this._context2d = this._view.getContext('2d');\n        };\n        View3D.prototype.append = function (containerID) {\n            if (!containerID) {\n                document.body.appendChild(this._renderer.domElement);\n            }\n            else {\n                var container = document.getElementById(containerID);\n                if (container) {\n                    container.appendChild(this._renderer.domElement);\n                }\n                else {\n                    Animyst.Log.error(\"[Viewport3D] Container ID\", containerID, \"doesn't exist\");\n                }\n            }\n        };\n        View3D.prototype.render = function () {\n            this._renderer.render(this._scene, this._camera);\n            //this.context2d.clearRect(0,0, this.view.width, this.view.height);\n            //this.context2d.drawImage(this.renderer.domElement, 0, 0);\n            //this.context2d.drawImage(this.uiRenderer.view, 0, 0);\n        };\n        View3D.prototype.update = function () {\n        };\n        View3D.prototype.onResize = function () {\n            //this.renderer.setSize(Animyst.)\n        };\n        return View3D;\n    }(Animyst.Database));\n    Animyst.View3D = View3D;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Window = (function () {\n        function Window() {\n        }\n        Object.defineProperty(Window, \"orientation\", {\n            get: function () { return window.orientation; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Window, \"isLandscape\", {\n            get: function () { return window.innerWidth > window.innerHeight; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Window, \"isPortrait\", {\n            get: function () { return window.innerHeight > window.innerWidth; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Window, \"width\", {\n            get: function () { return document.documentElement.clientWidth; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Object.defineProperty(Window, \"height\", {\n            get: function () { return document.documentElement.clientHeight; },\n            enumerable: true,\n            configurable: true\n        });\n        ;\n        Window._onResize = function (evt) {\n            Animyst.Log.output(\"[Window] onResize!\");\n            Window.resizeSignal.dispatch(evt);\n        };\n        Window._onWindowLoad = function (evt) {\n            Animyst.Log.output(\"[Window] Window loaded:\", \"w:\", Window.width, \"h:\", Window.height);\n        };\n        Window._setup = function () {\n            window.addEventListener(\"resize\", Window._onResize);\n            window.addEventListener(\"load\", Window._onWindowLoad);\n        };\n        return Window;\n    }());\n    Window.resizeSignal = new Animyst.Signal();\n    Animyst.Window = Window;\n})(Animyst || (Animyst = {}));\nAnimyst.Window._setup();\nvar Animyst;\n(function (Animyst) {\n    Animyst.LOGGING = true;\n    Animyst.DEBUG = true;\n    Animyst.MAJOR = 0;\n    Animyst.MINOR = 0;\n    Animyst.BUILD = 0;\n    Animyst.DATA = \"\";\n    Animyst.VERSION = Animyst.MAJOR + \".\" + Animyst.MINOR + \".\" + Animyst.BUILD;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Sound = (function () {\n        function Sound() {\n        }\n        return Sound;\n    }());\n    Animyst.Sound = Sound;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var PIXITexture = (function (_super) {\n        __extends(PIXITexture, _super);\n        function PIXITexture(stage, renderer) {\n            var _this = _super.call(this) || this;\n            _this.stage = stage;\n            _this.renderer = renderer;\n            _this.width = renderer.view.width;\n            _this.height = renderer.view.height;\n            _this._init();\n            return _this;\n        }\n        PIXITexture.prototype._init = function () {\n            this.image = this.renderer.view;\n            var graphics = new PIXI.Graphics();\n            graphics.lineStyle(2, 0xFF00FF, 1);\n            graphics.beginFill(0xFF00BB, 0.25);\n            graphics.drawCircle(this.width / 2, this.height / 2, 100);\n            graphics.endFill();\n            var texture = PIXI.Texture.fromCanvas(Animyst.DataLoad.getAsset('samusftilt'));\n            var sprite = new PIXI.Sprite(texture);\n            this.stage.addChild(sprite);\n            this.stage.addChild(graphics);\n            this.invalidate();\n            this.update();\n        };\n        PIXITexture.prototype.invalidate = function () {\n            this.shouldUpdate = true;\n        };\n        ;\n        PIXITexture.prototype.update = function () {\n            if (this.shouldUpdate) {\n                this.renderer.render(this.stage);\n                this.needsUpdate = true;\n                this.shouldUpdate = false;\n            }\n        };\n        ;\n        return PIXITexture;\n    }(THREE.Texture));\n    Animyst.PIXITexture = PIXITexture;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var SpriteSheetTexture = (function (_super) {\n        __extends(SpriteSheetTexture, _super);\n        function SpriteSheetTexture(atlas) {\n            var _this = _super.call(this) || this;\n            _this.playTime = 0;\n            _this.time = 0;\n            _this.currentFrame = 0;\n            _this.currentFrameID = \"\";\n            _this.sprite = null;\n            _this.renderWidth = 0;\n            _this.renderHeight = 0;\n            _this.sourceFile = \"\";\n            _this.timePassed = 0;\n            _this.addSheet(atlas);\n            return _this;\n        }\n        SpriteSheetTexture.prototype._initSprite = function (startFrame) {\n            this.stage = new PIXI.Container();\n            this.renderer = PIXI.autoDetectRenderer(256, 256, { transparent: true });\n            this.sprite = new PIXI.Sprite(PIXI.Texture.fromFrame(startFrame));\n            this.image = this.renderer.view;\n            this.stage.addChild(this.sprite);\n            this.renderer.render(this.stage);\n            this.needsUpdate = true;\n        };\n        SpriteSheetTexture.prototype.addSheet = function (atlas) {\n            this.atlas = atlas;\n            this.frames = [];\n            for (var k in atlas.frames) {\n                var frame = atlas.frames[k];\n                if (frame.frame.w > this.renderWidth) {\n                    this.renderWidth = frame.frame.w % 2 == 0 ? frame.frame.w : frame.frame.w + 1;\n                }\n                if (frame.frame.h > this.renderHeight) {\n                    this.renderHeight = frame.frame.h % 2 == 0 ? frame.frame.h : frame.frame.h + 1;\n                }\n                this.frames.push(k);\n            }\n            if (!this.sprite) {\n                this._initSprite(this.frames[0]);\n                this.currentFrameID = this.frames[0];\n                this.currentFrame = 0;\n            }\n        };\n        SpriteSheetTexture.prototype.showFrame = function (frame) {\n            if (this.frames.length <= 0)\n                return;\n            if (!frame)\n                frame = this.currentFrame || 0;\n            var thisFrame;\n            if (typeof frame == \"string\") {\n                thisFrame = frame;\n            }\n            else if (typeof frame == \"number\") {\n                thisFrame = this.frames[frame];\n            }\n            this.sprite.setTexture(PIXI.Texture.fromFrame(thisFrame));\n            this.renderer.render(this.stage);\n            this.needsUpdate = true;\n        };\n        SpriteSheetTexture.prototype.play = function (time, loop) {\n            if (this.frames.length <= 0)\n                return;\n            this.playing = true;\n            this.loop = loop;\n            this.playTime = time;\n            this.time = 0;\n        };\n        SpriteSheetTexture.prototype.stop = function () {\n            this.playing = false;\n            this.timePassed = 0;\n        };\n        SpriteSheetTexture.prototype.animate = function (delta, runtime) {\n            if (this.playing) {\n                //console.log(delta, time, this.time, this.playTime, this.currentFrame, this.sourceFile)\n                if (this.time >= this.playTime) {\n                    if (this.loop) {\n                        this.time = 0;\n                    }\n                    else {\n                        this.playing = false;\n                    }\n                }\n                else {\n                    this.time += delta;\n                    this.currentFrame = Math.round((this.time / this.playTime) * (this.frames.length - 1));\n                    if (this.currentFrame >= this.frames.length)\n                        this.currentFrame = this.frames.length - 1;\n                    this.showFrame();\n                }\n            }\n        };\n        return SpriteSheetTexture;\n    }(THREE.Texture));\n    Animyst.SpriteSheetTexture = SpriteSheetTexture;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var Input = (function (_super) {\n        __extends(Input, _super);\n        function Input(inputData) {\n            var _this = _super.call(this) || this;\n            _this.inputData = inputData;\n            return _this;\n        }\n        Input.prototype.startup = function (params) {\n            var element = params.element;\n            var tool = params.tool;\n            this.keyboardSettings = params.keyboardSettings;\n            if (tool) {\n                tool.onKeyUp = this.onKeyUp.bind(this);\n                tool.onKeyDown = this.onKeyDown.bind(this);\n                tool.onMouseDown = this.onMouseDown.bind(this);\n                tool.onMouseUp = this.onMouseUp.bind(this);\n                tool.onMouseDrag = this.onMouseDrag.bind(this);\n                tool.onMouseMove = this.onMouseMove.bind(this);\n            }\n            if (element) {\n                element.addEventListener('touchstart', this.onTouchStart.bind(this));\n                element.addEventListener('touchmove', this.onTouchMove.bind(this));\n                element.addEventListener('touchend', this.onTouchRelease.bind(this));\n                element.addEventListener('touchenter', this.onTouchEnter.bind(this));\n                element.addEventListener('touchleave', this.onTouchLeave.bind(this));\n                element.addEventListener('mousedown', this.onMouseDown.bind(this));\n                element.addEventListener('mouseup', this.onMouseUp.bind(this));\n                element.addEventListener('mousemove', this.onMouseMove.bind(this));\n                element.addEventListener('mouseenter', this.onMouseEnter.bind(this));\n                element.addEventListener('mouseleave', this.onMouseLeave.bind(this));\n                element.addEventListener('keydown', this.onKeyDown.bind(this));\n                element.addEventListener('keyup', this.onKeyUp.bind(this));\n            }\n            Animyst.System.prototype.startup.call(this, params);\n        };\n        Input.prototype.shutdown = function () {\n            this.inputData = null;\n            Animyst.System.prototype.shutdown.call(this);\n        };\n        Input.prototype.update = function (delta, runtime) {\n            this.inputData.onTick(delta);\n        };\n        //=============== TOUCH EVENTS ======================//\n        Input.prototype.onTouchStart = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Touch Start!\");\n            this.handleTouchInput(Input.TOUCH_START, evt);\n        };\n        Input.prototype.onTouchMove = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Touch Move!\");\n            this.handleTouchInput(Input.TOUCH_MOVE, evt);\n        };\n        Input.prototype.onTouchRelease = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Touch Release!\");\n            this.handleTouchInput(Input.TOUCH_RELEASE, evt);\n        };\n        Input.prototype.onTouchEnter = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Touch Enter!\");\n            this.handleTouchInput(Input.TOUCH_ENTER, evt);\n        };\n        Input.prototype.onTouchLeave = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Touch Leave!\");\n            this.handleTouchInput(Input.TOUCH_LEAVE, evt);\n        };\n        //================= MOUSE EVENTS =====================//\n        Input.prototype.onClick = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Click!\");\n            this.handleMouseInput(Input.MOUSE_CLICK, evt);\n        };\n        Input.prototype.onMouseDown = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Down!\");\n            this.handleMouseInput(Input.MOUSE_DOWN, evt);\n        };\n        Input.prototype.onMouseDrag = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Drag!\");\n            this.handleMouseInput(Input.MOUSE_DRAG, evt);\n        };\n        Input.prototype.onMouseMove = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Move!\");\n            this.handleMouseInput(Input.MOUSE_MOVE, evt);\n        };\n        Input.prototype.onMouseUp = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Up!\");\n            this.handleMouseInput(Input.MOUSE_UP, evt);\n        };\n        Input.prototype.onMouseEnter = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Enter!\");\n            this.handleMouseInput(Input.MOUSE_ENTER, evt);\n        };\n        Input.prototype.onMouseLeave = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Mouse Leave!\");\n            this.handleMouseInput(Input.MOUSE_LEAVE, evt);\n        };\n        //================ KEYBOARD EVENTS ===================//\n        Input.prototype.onKeyUp = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Released Key:\", evt.key || Animyst.InputData.KEY_NAMES[evt.keyCode]);\n            if (!this.keyboardSettings.allowDefault[evt.key || Animyst.InputData.KEY_NAMES[evt.keyCode]]) {\n                evt.preventDefault();\n            }\n            this.handleKeyInput(Input.KEY_UP, evt.keyCode || Animyst.InputData.KEY_CODES[evt.key]);\n        };\n        Input.prototype.onKeyDown = function (evt) {\n            if (Animyst.LOGGING)\n                console.log(\"[Input] Pressed Key:\", evt.key || Animyst.InputData.KEY_NAMES[evt.keyCode]);\n            if (!this.keyboardSettings.allowDefault[evt.key || Animyst.InputData.KEY_NAMES[evt.keyCode]]) {\n                evt.preventDefault();\n            }\n            this.handleKeyInput(Input.KEY_DOWN, evt.keyCode || Animyst.InputData.KEY_CODES[evt.key]);\n        };\n        //====================================================//\n        Input.prototype.handleMouseInput = function (type, evt) {\n            //console.log(evt);\n            var down;\n            if (type == Input.MOUSE_DOWN || type == Input.MOUSE_DRAG) {\n                down = true;\n            }\n            if (type == Input.MOUSE_UP || type == Input.MOUSE_LEAVE) {\n                down = false;\n            }\n            this.inputData.setMouseInput(evt, down);\n        };\n        Input.prototype.handleKeyInput = function (type, keyCode) {\n            this.inputData.setKeyInput(keyCode, type == Input.KEY_DOWN);\n        };\n        Input.prototype.handleTouchInput = function (type, evt) {\n            switch (type) {\n                case Input.TOUCH_START:\n                    this.inputData.addTouches(evt.changedTouches);\n                    break;\n                case Input.TOUCH_MOVE:\n                    break;\n                case Input.TOUCH_RELEASE:\n                    this.inputData.removeTouches(evt.touches);\n                    break;\n                case Input.TOUCH_ENTER:\n                    break;\n                case Input.TOUCH_LEAVE:\n                    break;\n            }\n            this.inputData.updateTouches(evt.changedTouches);\n        };\n        return Input;\n    }(Animyst.System));\n    Input.KEY_DOWN = 0;\n    Input.KEY_UP = 1;\n    Input.TOUCH_START = 0;\n    Input.TOUCH_MOVE = 1;\n    Input.TOUCH_RELEASE = 2;\n    Input.TOUCH_ENTER = 3;\n    Input.TOUCH_LEAVE = 4;\n    Input.MOUSE_DOWN = 5;\n    Input.MOUSE_UP = 6;\n    Input.MOUSE_DRAG = 7;\n    Input.MOUSE_MOVE = 8;\n    Input.MOUSE_ENTER = 9;\n    Input.MOUSE_LEAVE = 10;\n    Input.MOUSE_CLICK = 11;\n    Animyst.Input = Input;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var InputData = (function (_super) {\n        __extends(InputData, _super);\n        function InputData() {\n            var _this = _super.call(this) || this;\n            _this.map = {};\n            _this.touches = [];\n            _this.touchHistory = [];\n            _this.mouse = {};\n            _this.mouseHistory = [];\n            _this.totalTouchCount = 0;\n            _this.time = 0;\n            return _this;\n        }\n        InputData.prototype.clear = function () {\n            this.map = {};\n            this.touches = [];\n            this.touchHistory = [];\n            this.totalTouchCount = 0;\n            _super.prototype.clear.call(this);\n        };\n        InputData.prototype.destroy = function () {\n            this.map = null;\n            this.touches = null;\n            this.touchHistory = null;\n            this.totalTouchCount = 0;\n            _super.prototype.destroy.call(this);\n        };\n        InputData.prototype.onTick = function (delta) {\n            this.time += delta;\n            if (this.mouse.down) {\n                this.mouse.clickTime += delta;\n            }\n            for (var k in this.map) {\n                var data = this.map[k];\n                if (data.active) {\n                    data.time = (data.time || 0) + delta;\n                }\n            }\n            for (var i = 0; i < this.touches.length; i++) {\n                var touchData = this.touches[i];\n                touchData.time += delta;\n            }\n        };\n        InputData.prototype.isKeyDown = function (keyName) {\n            var keyCode = InputData.KEY_CODES[keyName];\n            return (this.map[keyCode] && this.map[keyCode].active) ? true : false;\n        };\n        InputData.prototype.setKeyInput = function (keyCode, active) {\n            var data = this.map[keyCode] || {};\n            var evtType;\n            if (active && !data.active) {\n                data.time = 0;\n                evtType = InputData.KEY_ACTIVE;\n            }\n            if (!active && data.active) {\n                data.lastInput = {};\n                data.lastInput.endTime = this.time;\n                data.lastInput.duration = data.time;\n                data.lastInput.startTime = this.time - data.time;\n                data.time = 0;\n                evtType = InputData.KEY_INACTIVE;\n            }\n            data.active = active === true;\n            if (!this.map[keyCode]) {\n                this.map[keyCode] = data;\n            }\n            if (evtType)\n                this.signal.dispatch(InputData.KEY, evtType, data);\n        };\n        InputData.prototype.setMouseInput = function (evt, down) {\n            if (this.touches.length > 0 && down)\n                down = false;\n            if (typeof (down) != \"boolean\")\n                down = this.mouse.down;\n            var lastClick = this.mouse.down && !down ? this.mouse.lastClick || {} : null;\n            var clickStart = !this.mouse.down && down ? {} : null;\n            var evtType = InputData.MOUSE_MOVE;\n            for (var i = 0; i < InputData.MOUSE_PROPERTIES.length; i++) {\n                var k = InputData.MOUSE_PROPERTIES[i];\n                if (evt[k]) {\n                    this.mouse[k] = evt[k];\n                    if (lastClick)\n                        lastClick[k] = evt[k];\n                    if (clickStart)\n                        clickStart[k] = evt[k];\n                }\n            }\n            if (clickStart) {\n                if (Animyst.LOGGING)\n                    console.log(\"[InputData] Click Start!\");\n                this.mouse.clickStart = clickStart;\n                this.mouse.clickTime = 0;\n                evtType = InputData.MOUSE_DOWN;\n            }\n            if (lastClick) {\n                if (Animyst.LOGGING)\n                    console.log(\"[InputData] Click Ended!\", this.mouse.clickTime);\n                lastClick.clickStart = this.mouse.clickStart;\n                lastClick.clickTime = this.mouse.clickTime;\n                this.mouse.clickStart = null;\n                this.mouse.lastClick = lastClick;\n                evtType = InputData.MOUSE_UP;\n            }\n            this.mouse.down = down;\n            this.signal.dispatch(InputData.MOUSE, evtType, this.mouse);\n        };\n        InputData.prototype.getTouches = function () {\n            return this.touches.concat();\n        };\n        InputData.prototype.addTouches = function (touches) {\n            for (var i = 0; i < touches.length; i++) {\n                var touch = touches[i];\n                var isNew = true;\n                for (var j = 0; j < this.touches.length; j++) {\n                    if (this.touches[j].identifier == touch.identifier) {\n                        isNew = false;\n                        break;\n                    }\n                }\n                if (isNew) {\n                    var data = {};\n                    var startData = {};\n                    for (var j = 0; j < InputData.TOUCH_PROPERTIES.length; j++) {\n                        var k = InputData.TOUCH_PROPERTIES[j];\n                        data[k] = (typeof touch[k] != \"object\" || k == \"target\") ? touch[k] : null;\n                        startData[k] = (typeof touch[k] != \"object\") ? touch[k] : null;\n                    }\n                    data.time = 0; //Time Counter\n                    data.timestamp = this.time; //When the touch began\n                    data.startData = startData; //Data assosiated with the start of the touch\n                    data.uid = data.identifier + \"\" + this.totalTouchCount; //Unique identifier for this touch that seperates it from past touches\n                    this.touches.push(data);\n                    this.totalTouchCount++;\n                    if (Animyst.LOGGING)\n                        console.log(\"[InputData] Adding Touch:\", data.uid);\n                    this.signal.dispatch(InputData.TOUCH, InputData.TOUCH_ADDED, data);\n                }\n            }\n        };\n        InputData.prototype.removeTouches = function (touches) {\n            for (var i = this.touches.length - 1; i > -1 && this.touches.length > 0; i--) {\n                var touchData = this.touches[i];\n                var isGone = true;\n                for (var j = 0; j < touches.length; j++) {\n                    if (touches[j].identifier == touchData.identifier) {\n                        isGone = false;\n                        break;\n                    }\n                }\n                if (isGone) {\n                    if (Animyst.LOGGING)\n                        console.log(\"[InputData] Removing Touch:\", touchData.uid);\n                    this.touchHistory.unshift(touchData);\n                    this.touches.splice(i, 1);\n                    if (this.touchHistory.length > InputData.TOUCH_HISTORY_LIMIT) {\n                        this.touchHistory.pop();\n                    }\n                    this.signal.dispatch(InputData.TOUCH, InputData.TOUCH_REMOVED, touchData);\n                }\n            }\n        };\n        InputData.prototype.updateTouches = function (touches) {\n            for (var i = 0; i < touches.length; i++) {\n                var touch = touches[i];\n                var data;\n                for (var j = 0; j < this.touches.length; j++) {\n                    if (this.touches[j].identifier == touch.identifier) {\n                        data = this.touches[j];\n                        break;\n                    }\n                }\n                if (data) {\n                    for (var j = 0; j < InputData.TOUCH_PROPERTIES.length; j++) {\n                        var k = InputData.TOUCH_PROPERTIES[j];\n                        data[k] = touch[k];\n                    }\n                    if (Animyst.LOGGING)\n                        console.log(\"[InputData] Updated Touch:\", data.uid, Math.round(data.pageX), Math.round(data.pageY), Math.round(data.screenX), Math.round(data.screenY), data.force || data.webkitForce);\n                    this.signal.dispatch(InputData.TOUCH, InputData.TOUCH_UPDATED, data);\n                }\n            }\n        };\n        return InputData;\n    }(Animyst.Database));\n    InputData.TOUCH_HISTORY_LIMIT = 12;\n    InputData.TOUCH_PROPERTIES = [\"identifier\", \"screenX\", \"screenY\", \"clientX\", \"clientY\",\n        \"pageX\", \"pageY\", \"radiusX\", \"radiusY\", \"rotationAngle\",\n        \"force\", \"webkitForce\", \"target\"];\n    InputData.MOUSE_PROPERTIES = [\"clientX\", \"clientY\", \"screenX\", \"screenY\", \"type\", \"point\",\n        \"lastPoint\", \"downPoint\", \"middlePoint\", \"count\", \"item\", \"modifiers\"];\n    InputData.KEY_CODES = {\n        'backspace': 8,\n        'tab': 9,\n        'enter': 13,\n        'shift': 16,\n        'ctrl': 17,\n        'alt': 18,\n        'pause': 19,\n        'capslock': 20,\n        'numlock': 144,\n        'esc': 27,\n        'pageup': 33,\n        'pagedown': 34,\n        'end': 35,\n        'home': 36,\n        'leftarrow': 37,\n        'uparrow': 38,\n        'rightarrow': 39,\n        'downarrow': 40,\n        'insert': 45,\n        'delete': 46,\n        'clear': 12,\n        '0': 48,\n        '1': 49,\n        '2': 50,\n        '3': 51,\n        '4': 52,\n        '5': 53,\n        '6': 54,\n        '7': 55,\n        '8': 56,\n        '9': 57,\n        'a': 65,\n        'b': 66,\n        'c': 67,\n        'd': 68,\n        'e': 69,\n        'f': 70,\n        'g': 71,\n        'h': 72,\n        'i': 73,\n        'j': 74,\n        'k': 75,\n        'l': 76,\n        'm': 77,\n        'n': 78,\n        'o': 79,\n        'p': 80,\n        'q': 81,\n        'r': 82,\n        's': 83,\n        't': 84,\n        'u': 85,\n        'v': 86,\n        'w': 87,\n        'x': 88,\n        'y': 89,\n        'z': 90,\n        'numpad0': 96,\n        'numpad1': 97,\n        'numpad2': 98,\n        'numpad3': 99,\n        'numpad4': 100,\n        'numpad5': 101,\n        'numpad6': 102,\n        'numpad7': 103,\n        'numpad8': 104,\n        'numpad9': 105,\n        'multiply': 106,\n        'plus': 107,\n        'minus': 109,\n        'dot': 110,\n        'divide': 111,\n        'f1': 112,\n        'f2': 113,\n        'f3': 114,\n        'f4': 115,\n        'f5': 116,\n        'f6': 117,\n        'f7': 118,\n        'f8': 119,\n        'f9': 120,\n        'f10': 121,\n        'f11': 122,\n        'f12': 123,\n        '=': 187,\n        ',': 188,\n        '.': 190,\n        '/': 191,\n        'backslash': 220,\n        \";\": 186,\n        \"'\": 222,\n        \"[\": 219,\n        \"]\": 221,\n        \"-\": 189,\n        \"space\": 32,\n        \"~\": 192\n    };\n    InputData.KEY_NAMES = Animyst.ObjectUtil.invert(InputData.KEY_CODES);\n    InputData.MOUSE = 0;\n    InputData.TOUCH = 1;\n    InputData.KEY = 2;\n    InputData.TOUCH_ADDED = 0;\n    InputData.TOUCH_REMOVED = 1;\n    InputData.TOUCH_UPDATED = 2;\n    InputData.MOUSE_DOWN = 0;\n    InputData.MOUSE_UP = 1;\n    InputData.MOUSE_MOVE = 2;\n    InputData.KEY_ACTIVE = 0;\n    InputData.KEY_INACTIVE = 1;\n    Animyst.InputData = InputData;\n})(Animyst || (Animyst = {}));\n/// <reference path=\"pixi.js.d.ts\" />\nvar basics;\n/// <reference path=\"pixi.js.d.ts\" />\n(function (basics) {\n    var Basics = (function () {\n        function Basics() {\n            var _this = this;\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\n            document.body.appendChild(this.app.view);\n            this.bunny = PIXI.Sprite.fromImage(\"required/assets/basics/bunny.png\");\n            this.bunny.anchor.set(0.5);\n            this.bunny.x = this.app.renderer.width / 2;\n            this.bunny.y = this.app.renderer.height / 2;\n            this.app.stage.addChild(this.bunny);\n            this.app.ticker.add(function (delta) {\n                _this.bunny.rotation += 0.1 / delta;\n            });\n        }\n        return Basics;\n    }());\n    basics.Basics = Basics;\n    var Click = (function () {\n        function Click() {\n            var _this = this;\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\n            document.body.appendChild(this.app.view);\n            this.sprite = PIXI.Sprite.fromImage(\"../../_assets/basics/bunny.png\");\n            this.sprite.texture.baseTexture.scaleMode = PIXI.SCALE_MODES.NEAREST;\n            this.sprite.anchor.set(0.5);\n            this.sprite.x = this.app.renderer.width / 2;\n            this.sprite.y = this.app.renderer.height / 2;\n            this.sprite.interactive = true;\n            this.sprite.buttonMode = true;\n            this.sprite.on(\"pointerdown\", function () {\n                _this.sprite.scale.x *= 1.25;\n                _this.sprite.scale.y *= 1.25;\n            });\n            this.app.stage.addChild(this.sprite);\n        }\n        return Click;\n    }());\n    basics.Click = Click;\n    var ContainerPivot = (function () {\n        function ContainerPivot() {\n            var _this = this;\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\n            document.body.appendChild(this.app.view);\n            this.container = new PIXI.Container();\n            this.app.stage.addChild(this.container);\n            var texture = PIXI.Texture.fromImage(\"../../_assets/basics/bunny.png\");\n            for (var i = 0; i < 25; i++) {\n                var bunny = new PIXI.Sprite(texture);\n                bunny.anchor.set(0.5);\n                bunny.x = (i % 5) * 40;\n                bunny.y = Math.floor(i / 5) * 40;\n                this.container.addChild(bunny);\n            }\n            this.container.x = this.app.renderer.width / 2;\n            this.container.y = this.app.renderer.height / 2;\n            this.container.pivot.x = this.container.width / 2;\n            this.container.pivot.y = this.container.height / 2;\n            this.app.ticker.add(function (delta) {\n                _this.container.rotation -= 0.01 / delta;\n            });\n        }\n        return ContainerPivot;\n    }());\n    basics.ContainerPivot = ContainerPivot;\n    var Container = (function () {\n        function Container() {\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\n            document.body.appendChild(this.app.view);\n            this.container = new PIXI.Container();\n            this.app.stage.addChild(this.container);\n            var texture = PIXI.Texture.fromImage(\"../../_assets/basics/bunny.png\");\n            for (var i = 0; i < 25; i++) {\n                var bunny = new PIXI.Sprite(texture);\n                bunny.anchor.set(0.5);\n                bunny.x = (i % 5) * 40;\n                bunny.y = Math.floor(i / 5) * 40;\n                this.container.addChild(bunny);\n            }\n            this.container.x = this.app.renderer.width / 2;\n            this.container.y = this.app.renderer.height / 2;\n        }\n        return Container;\n    }());\n    basics.Container = Container;\n    var CustomizedFilter = (function (_super) {\n        __extends(CustomizedFilter, _super);\n        function CustomizedFilter(fragmentSource) {\n            return _super.call(this, null, fragmentSource, {\n                customUniform: {\n                    type: \"1f\",\n                    value: 0\n                }\n            }) || this;\n        }\n        return CustomizedFilter;\n    }(PIXI.Filter));\n    basics.CustomizedFilter = CustomizedFilter;\n    var CustomFilter = (function () {\n        function CustomFilter() {\n            var _this = this;\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\n            document.body.appendChild(this.app.view);\n            this.background = PIXI.Sprite.fromImage(\"required/assets/bkg-grass.jpg\");\n            this.background.width = this.app.renderer.width;\n            this.background.height = this.app.renderer.height;\n            this.app.stage.addChild(this.background);\n            this.app.stop();\n            PIXI.loader.add(\"shader\", \"_assets/basics/shader.frag\")\n                .load(function (loader, resource) {\n                _this.filter = new PIXI.Filter(null, resource.shader.data);\n                _this.background.filters = [_this.filter];\n                _this.app.start();\n                _this.app.ticker.add(function (delta) {\n                    _this.filter.uniforms.customUniform += 0.04 / delta;\n                });\n            });\n        }\n        return CustomFilter;\n    }());\n    basics.CustomFilter = CustomFilter;\n    var Graphics = (function () {\n        function Graphics() {\n            this.app = new PIXI.Application(800, 600, { antialias: true });\n            document.body.appendChild(this.app.view);\n            var graphics = new PIXI.Graphics();\n            // set a fill and line style\n            graphics.beginFill(0xFF3300);\n            graphics.lineStyle(4, 0xffd900, 1);\n            // draw a shape\n            graphics.moveTo(50, 50);\n            graphics.lineTo(250, 50);\n            graphics.lineTo(100, 100);\n            graphics.lineTo(50, 50);\n            graphics.endFill();\n            // set a fill and a line style again and draw a rectangle\n            graphics.lineStyle(2, 0x0000FF, 1);\n            graphics.beginFill(0xFF700B, 1);\n            graphics.drawRect(50, 250, 120, 120);\n            // draw a rounded rectangle\n            graphics.lineStyle(2, 0xFF00FF, 1);\n            graphics.beginFill(0xFF00BB, 0.25);\n            graphics.drawRoundedRect(150, 450, 300, 100, 15);\n            graphics.endFill();\n            // draw a circle, set the lineStyle to zero so the circle doesn\"t have an outline\n            graphics.lineStyle(0);\n            graphics.beginFill(0xFFFF0B, 0.5);\n            graphics.drawCircle(470, 90, 60);\n            graphics.endFill();\n            this.graphics = graphics;\n            this.app.stage.addChild(this.graphics);\n        }\n        return Graphics;\n    }());\n    basics.Graphics = Graphics;\n    var RenderTexture = (function () {\n        function RenderTexture() {\n            var _this = this;\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\n            document.body.appendChild(this.app.view);\n            this.container = new PIXI.Container();\n            this.app.stage.addChild(this.container);\n            var texture = PIXI.Texture.fromImage(\"required/assets/basics/bunny.png\");\n            for (var i = 0; i < 25; i++) {\n                var bunny = new PIXI.Sprite(texture);\n                bunny.x = (i % 5) * 30;\n                bunny.y = Math.floor(i / 5) * 30;\n                bunny.rotation = Math.random() * (Math.PI * 2);\n                this.container.addChild(bunny);\n            }\n            var brt = new PIXI.BaseRenderTexture(300, 300, PIXI.SCALE_MODES.LINEAR, 1);\n            var rt = new PIXI.RenderTexture(brt);\n            this.sprite = new PIXI.Sprite(rt);\n            this.sprite.x = 450;\n            this.sprite.y = 60;\n            this.app.stage.addChild(this.sprite);\n            this.container.x = 100;\n            this.container.y = 60;\n            this.app.ticker.add(function (delta) {\n                _this.app.renderer.render(_this.container, rt);\n            });\n        }\n        return RenderTexture;\n    }());\n    basics.RenderTexture = RenderTexture;\n    var SpriteSheet = (function () {\n        function SpriteSheet() {\n            var _this = this;\n            PIXI.loader\n                .add(\"required/assets/basics/fighter.json\")\n                .load(function (loader, resource) {\n                var frames = [];\n                for (var i = 0; i < 30; i++) {\n                    var val = i < 10 ? \"0\" + i : i;\n                    frames.push(PIXI.Texture.fromFrame(\"rollSequence00\" + val + \".png\"));\n                }\n                _this.anim = new PIXI.extras.AnimatedSprite(frames);\n                _this.anim.x = _this.app.renderer.width / 2;\n                _this.anim.y = _this.app.renderer.height / 2;\n                _this.anim.anchor.set(0.5);\n                _this.anim.animationSpeed = 0.5;\n                _this.anim.play();\n                _this.app.stage.addChild(_this.anim);\n                _this.app.ticker.add(function (deltaTime) {\n                    _this.anim.rotation += 0.01;\n                });\n            });\n        }\n        return SpriteSheet;\n    }());\n    basics.SpriteSheet = SpriteSheet;\n    var Text = (function () {\n        function Text() {\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\n            document.body.appendChild(this.app.view);\n            this.basicText = new PIXI.Text(\"Basic text in pixi\");\n            this.basicText.x = 30;\n            this.basicText.y = 90;\n            this.app.stage.addChild(this.basicText);\n            var style = new PIXI.TextStyle({\n                fontFamily: \"Arial\",\n                fontSize: 36,\n                fontStyle: \"italic\",\n                fontWeight: \"bold\",\n                fill: [\"#ffffff\", \"#fff0b5\"],\n                stroke: \"#4a1850\",\n                strokeThickness: 5,\n                dropShadow: true,\n                dropShadowColor: \"#000000\",\n                dropShadowBlur: 4,\n                dropShadowAngle: Math.PI / 6,\n                dropShadowDistance: 6,\n                wordWrap: true,\n                wordWrapWidth: 440\n            });\n            this.richText = new PIXI.Text(\"Rich text with a lot of options and across multiple lines\", style);\n            this.richText.x = 30;\n            this.richText.y = 180;\n            this.app.stage.addChild(this.richText);\n        }\n        return Text;\n    }());\n    basics.Text = Text;\n    var TexturedMesh = (function () {\n        function TexturedMesh() {\n            var _this = this;\n            var ropeLength = 918 / 20;\n            for (var i = 0; i < 25; i++) {\n                this.points.push(new PIXI.Point(i * ropeLength, 0));\n            }\n            this.strip = new PIXI.mesh.Rope(PIXI.Texture.fromImage(\"required/assets/snake.png\"), this.points);\n            this.strip.x = -40;\n            this.strip.y = 300;\n            this.app.stage.addChild(this.strip);\n            this.graphics = new PIXI.Graphics();\n            this.graphics.x = this.strip.x;\n            this.graphics.y = this.strip.y;\n            this.app.stage.addChild(this.graphics);\n            // start animating\n            this.app.ticker.add(function (deltaTime) {\n                _this.count += 0.1;\n                // make the snake\n                for (var i = 0; i < _this.points.length; i++) {\n                    _this.points[i].y = Math.sin((i * 0.5) + _this.count) * 30;\n                    _this.points[i].x = i * ropeLength + Math.cos((i * 0.3) + _this.count) * 20;\n                }\n                _this.renderPoints();\n            });\n        }\n        TexturedMesh.prototype.renderPoints = function () {\n            this.graphics.clear();\n            this.graphics.lineStyle(2, 0xffc2c2);\n            this.graphics.moveTo(this.points[0].x, this.points[0].y);\n            for (var i = 1; i < this.points.length; i++) {\n                this.graphics.lineTo(this.points[i].x, this.points[i].y);\n            }\n            for (var i = 1; i < this.points.length; i++) {\n                this.graphics.beginFill(0xff0022);\n                this.graphics.drawCircle(this.points[i].x, this.points[i].y, 10);\n                this.graphics.endFill();\n            }\n        };\n        return TexturedMesh;\n    }());\n    basics.TexturedMesh = TexturedMesh;\n    var TilingSprite = (function () {\n        function TilingSprite() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            document.body.appendChild(this.app.view);\n            var texture = PIXI.Texture.fromImage(\"required/assets/p2.jpeg\");\n            this.tilingSprite = new PIXI.extras.TilingSprite(texture, this.app.renderer.width, this.app.renderer.height);\n            this.app.stage.addChild(this.tilingSprite);\n            this.count = 0;\n            this.app.ticker.add(function (deltaTime) {\n                _this.count += 0.005;\n                _this.tilingSprite.tileScale.x = 2 + Math.sin(_this.count);\n                _this.tilingSprite.tileScale.y = 2 + Math.cos(_this.count);\n                _this.tilingSprite.tilePosition.x += 1;\n                _this.tilingSprite.tilePosition.y += 1;\n            });\n        }\n        return TilingSprite;\n    }());\n    basics.TilingSprite = TilingSprite;\n    var Video = (function () {\n        function Video() {\n            var _this = this;\n            this.app = new PIXI.Application(800, 600, { transparent: true });\n            document.body.appendChild(this.app.view);\n            this.button = new PIXI.Graphics()\n                .beginFill(0x0, 0.5)\n                .drawRoundedRect(0, 0, 100, 100, 10)\n                .endFill()\n                .beginFill(0xffffff)\n                .moveTo(36, 30)\n                .lineTo(36, 70)\n                .lineTo(70, 50);\n            // Position the button\n            this.button.x = (this.app.renderer.width - this.button.width) / 2;\n            this.button.y = (this.app.renderer.height - this.button.height) / 2;\n            // Enable interactivity on the button\n            this.button.interactive = true;\n            this.button.buttonMode = true;\n            // Add to the stage\n            this.app.stage.addChild(this.button);\n            this.button.on(\"pointertap\", function () {\n                _this.button.destroy();\n                var texture = PIXI.Texture.fromVideo(\"required/assets/testVideo.mp4\");\n                _this.videoSprite = new PIXI.Sprite(texture);\n                _this.videoSprite.width = _this.app.renderer.width;\n                _this.videoSprite.height = _this.app.renderer.height;\n                _this.app.stage.addChild(_this.videoSprite);\n            });\n        }\n        return Video;\n    }());\n    basics.Video = Video;\n})(basics || (basics = {}));\nvar demos;\n(function (demos) {\n    var AlphaMask = (function () {\n        function AlphaMask() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            this.app.stage.interactive = true;\n            document.body.appendChild(this.app.view);\n            this.bg = PIXI.Sprite.fromImage(\"required/assets/bkg.jpg\");\n            this.app.stage.addChild(this.bg);\n            this.cells = PIXI.Sprite.fromImage(\"required/assets/cells.png\");\n            this.cells.scale.set(1.5);\n            this.mask = PIXI.Sprite.fromImage(\"required/assets/flowerTop.png\");\n            this.mask.anchor.set(0.5);\n            this.mask.x = 310;\n            this.mask.y = 190;\n            this.cells.mask = this.mask;\n            this.app.stage.addChild(this.mask, this.cells);\n            this.target = new PIXI.Point();\n            this.reset();\n            this.app.ticker.add(function (deltaTime) {\n                _this.mask.position.x += (_this.target.x - _this.mask.x) * 0.1;\n                _this.mask.position.y += (_this.target.y - _this.mask.y) * 0.1;\n                if (Math.abs(_this.mask.x - _this.target.x) < 1) {\n                    _this.reset();\n                }\n            });\n        }\n        AlphaMask.prototype.reset = function () {\n            this.target.x = Math.floor(Math.random() * 550);\n            this.target.y = Math.floor(Math.random() * 300);\n        };\n        return AlphaMask;\n    }());\n    demos.AlphaMask = AlphaMask;\n    var AnimatedSpriteDemo = (function () {\n        function AnimatedSpriteDemo() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            this.app.stop();\n            document.body.appendChild(this.app.view);\n            PIXI.loader\n                .add(\"spritesheet\", \"required/assets/mc.json\")\n                .load(function () {\n                var explosionTextures = [];\n                var i;\n                for (i = 0; i < 26; i++) {\n                    var texture = PIXI.Texture.fromFrame(\"Explosion_Sequence_A \" + (i + 1) + \".png\");\n                    explosionTextures.push(texture);\n                }\n                for (i = 0; i < 50; i++) {\n                    var explosion = new PIXI.extras.AnimatedSprite(explosionTextures);\n                    explosion.x = Math.random() * _this.app.renderer.width;\n                    explosion.y = Math.random() * _this.app.renderer.height;\n                    explosion.anchor.set(0.5);\n                    explosion.rotation = Math.random() * Math.PI;\n                    explosion.scale.set(0.75 + Math.random() * 0.5);\n                    explosion.gotoAndPlay(Math.random() * 27);\n                    _this.app.stage.addChild(explosion);\n                }\n                _this.app.start();\n            });\n        }\n        return AnimatedSpriteDemo;\n    }());\n    demos.AnimatedSpriteDemo = AnimatedSpriteDemo;\n    var Batch = (function () {\n        function Batch() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            document.body.appendChild(this.app.view);\n            this.sprites = new PIXI.particles.ParticleContainer(10000, {\n                scale: true,\n                position: true,\n                rotation: true,\n                uvs: true,\n                alpha: true\n            });\n            this.app.stage.addChild(this.sprites);\n            this.maggots = [];\n            var totalSprites = this.app.renderer instanceof PIXI.WebGLRenderer ? 10000 : 100;\n            var dudeTexture = PIXI.Texture.fromImage(\"required/assets/tinyMaggot.png\");\n            for (var i = 0; i < totalSprites; i++) {\n                var dude = new Dude(dudeTexture);\n                dude.tint = Math.random() * 0xE8D4CD;\n                dude.anchor.set(0.5);\n                dude.scale.set(0.8 + Math.random() * 0.3);\n                dude.x = Math.random() * this.app.renderer.width;\n                dude.y = Math.random() * this.app.renderer.height;\n                dude.direction = Math.random() * Math.PI * 2;\n                dude.turningSpeed = Math.random() - 0.8;\n                dude.speed = (2 + Math.random() * 2) * 0.2;\n                dude.offset = Math.random() * 100;\n                this.maggots.push(dude);\n                this.sprites.addChild(dude);\n            }\n            var dudeBoundsPadding = 100;\n            this.dudeBounds = new PIXI.Rectangle(-dudeBoundsPadding, -dudeBoundsPadding, this.app.renderer.width + dudeBoundsPadding * 2, this.app.renderer.height + dudeBoundsPadding * 2);\n            this.tick = 0;\n            this.app.ticker.add(function () {\n                for (var i = 0; i < _this.maggots.length; i++) {\n                    var dude = _this.maggots[i];\n                    dude.scale.y = 0.95 + Math.sin(_this.tick + dude.offset) * 0.05;\n                    dude.direction += dude.turningSpeed * 0.01;\n                    dude.x += Math.sin(dude.direction) * (dude.speed * dude.scale.y);\n                    dude.y += Math.cos(dude.direction) * (dude.speed * dude.scale.y);\n                    dude.rotation = -dude.direction + Math.PI;\n                    // wrap the maggots\n                    if (dude.x < _this.dudeBounds.x) {\n                        dude.x += _this.dudeBounds.width;\n                    }\n                    else if (dude.x > _this.dudeBounds.x + _this.dudeBounds.width) {\n                        dude.x -= _this.dudeBounds.width;\n                    }\n                    if (dude.y < _this.dudeBounds.y) {\n                        dude.y += _this.dudeBounds.height;\n                    }\n                    else if (dude.y > _this.dudeBounds.y + _this.dudeBounds.height) {\n                        dude.y -= _this.dudeBounds.height;\n                    }\n                }\n                _this.tick += 0.1;\n            });\n        }\n        return Batch;\n    }());\n    demos.Batch = Batch;\n    var Dude = (function (_super) {\n        __extends(Dude, _super);\n        function Dude(texture) {\n            var _this = _super.call(this, texture) || this;\n            _this.direction = 0;\n            _this.speed = 0;\n            _this.turningSpeed = 0;\n            _this.offset = 0;\n            return _this;\n        }\n        return Dude;\n    }(PIXI.Sprite));\n    demos.Dude = Dude;\n    var BlendModes = (function () {\n        function BlendModes() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            document.body.appendChild(this.app.view);\n            this.background = PIXI.Sprite.fromImage(\"required/assets/BGrotate.jpg\");\n            this.app.stage.addChild(this.background);\n            this.dudeArray = [];\n            var totalDudes = 20;\n            var dudeTexture = PIXI.Texture.fromImage(\"required/assets/flowerTop.png\");\n            for (var i = 0; i < totalDudes; i++) {\n                var dude = new Dude(dudeTexture);\n                dude.anchor.set(0.5);\n                dude.scale.set(0.8 + Math.random() * 0.3);\n                dude.x = Math.floor(Math.random() * this.app.renderer.width);\n                dude.y = Math.floor(Math.random() * this.app.renderer.height);\n                dude.blendMode = PIXI.BLEND_MODES.ADD;\n                dude.direction = Math.random() * Math.PI * 2;\n                dude.turningSpeed = Math.random() - 0.8;\n                dude.speed = 2 + Math.random() * 2;\n                this.dudeArray.push(dude);\n                this.app.stage.addChild(dude);\n            }\n            var dudeBoundsPadding = 100;\n            this.dudeBounds = new PIXI.Rectangle(-dudeBoundsPadding, -dudeBoundsPadding, this.app.renderer.width + dudeBoundsPadding * 2, this.app.renderer.height + dudeBoundsPadding * 2);\n            this.app.ticker.add(function () {\n                for (var i = 0; i < _this.dudeArray.length; i++) {\n                    var dude = _this.dudeArray[i];\n                    dude.direction += dude.turningSpeed * 0.01;\n                    dude.x += Math.sin(dude.direction) * dude.speed;\n                    dude.y += Math.cos(dude.direction) * dude.speed;\n                    dude.rotation = -dude.direction - Math.PI / 2;\n                    // wrap the dudes by testing their bounds...\n                    if (dude.x < _this.dudeBounds.x) {\n                        dude.x += _this.dudeBounds.width;\n                    }\n                    else if (dude.x > _this.dudeBounds.x + _this.dudeBounds.width) {\n                        dude.x -= _this.dudeBounds.width;\n                    }\n                    if (dude.y < _this.dudeBounds.y) {\n                        dude.y += _this.dudeBounds.height;\n                    }\n                    else if (dude.y > _this.dudeBounds.y + _this.dudeBounds.height) {\n                        dude.y -= _this.dudeBounds.height;\n                    }\n                }\n            });\n        }\n        return BlendModes;\n    }());\n    demos.BlendModes = BlendModes;\n    var CacheAsBitmap = (function () {\n        function CacheAsBitmap() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            this.app.stage.interactive = true;\n            document.body.appendChild(this.app.view);\n            this.app.stop();\n            this.aliens = [];\n            var alienFrames = [\n                \"eggHead.png\",\n                \"flowerTop.png\",\n                \"helmlok.png\",\n                \"skully.png\"\n            ];\n            this.count = 0;\n            this.alienContainer = new PIXI.Container();\n            this.alienContainer.x = 400;\n            this.alienContainer.y = 300;\n            this.app.stage.addChild(this.alienContainer);\n            PIXI.loader\n                .add(\"spritesheet\", \"required/assets/monsters.json\")\n                .load(function () {\n                for (var i = 0; i < 100; i++) {\n                    var frameName = alienFrames[i % 4];\n                    var alien = PIXI.Sprite.fromFrame(frameName);\n                    alien.tint = Math.random() * 0xFFFFFF;\n                    alien.x = Math.random() * 800 - 400;\n                    alien.y = Math.random() * 600 - 300;\n                    alien.anchor.x = 0.5;\n                    alien.anchor.y = 0.5;\n                    _this.aliens.push(alien);\n                    _this.alienContainer.addChild(alien);\n                }\n                _this.app.start();\n                _this.app.stage.on(\"pointerTap\", function (event) {\n                    _this.alienContainer.cacheAsBitmap = !_this.alienContainer.cacheAsBitmap;\n                });\n                _this.app.ticker.add(function () {\n                    // let\"s rotate the aliens a little bit\n                    for (var i = 0; i < 100; i++) {\n                        var alien = _this.aliens[i];\n                        alien.rotation += 0.1;\n                    }\n                    _this.count += 0.01;\n                    _this.alienContainer.scale.x = Math.sin(_this.count);\n                    _this.alienContainer.scale.y = Math.sin(_this.count);\n                    _this.alienContainer.rotation += 0.01;\n                });\n            });\n        }\n        return CacheAsBitmap;\n    }());\n    demos.CacheAsBitmap = CacheAsBitmap;\n    var Dragging = (function () {\n        function Dragging() {\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\n            document.body.appendChild(this.app.view);\n            var texture = PIXI.Texture.fromImage(\"required/assets/bunny.png\");\n            texture.baseTexture.scaleMode = PIXI.SCALE_MODES.NEAREST;\n            for (var i = 0; i < 10; i++) {\n                this.createBunny(texture, Math.floor(Math.random() * this.app.renderer.width), Math.floor(Math.random() * this.app.renderer.height));\n            }\n        }\n        Dragging.prototype.createBunny = function (texture, x, y) {\n            var _this = this;\n            var bunny = new PIXI.Sprite(texture);\n            bunny.interactive = true;\n            bunny.buttonMode = true;\n            bunny.anchor.set(0.5);\n            bunny.scale.set(3);\n            bunny\n                .on(\"pointerdown\", function (event) {\n                _this.data = event.data;\n                bunny.alpha = 0.5;\n                _this.dragging = true;\n            })\n                .on(\"pointerup\", function (event) {\n                _this.data = null;\n                bunny.alpha = 0.5;\n                _this.dragging = false;\n            })\n                .on(\"pointerupoutside\", function (event) {\n                _this.data = null;\n                bunny.alpha = 0.5;\n                _this.dragging = false;\n            })\n                .on(\"pointermove\", function (event) {\n                if (_this.dragging) {\n                    var newPosition = _this.data.getLocalPosition(bunny);\n                    bunny.x = newPosition.x;\n                    bunny.y = newPosition.y;\n                }\n            });\n            bunny.x = x;\n            bunny.y = y;\n            this.app.stage.addChild(bunny);\n        };\n        return Dragging;\n    }());\n    demos.Dragging = Dragging;\n    var GraphicsDemo = (function () {\n        function GraphicsDemo() {\n            var _this = this;\n            this.app = new PIXI.Application(800, 600, { antialias: true });\n            this.app.stage.interactive = true;\n            document.body.appendChild(this.app.view);\n            var graphics = new PIXI.Graphics();\n            graphics.beginFill(0xFF3300);\n            graphics.lineStyle(10, 0xffd900, 1);\n            graphics.moveTo(50, 50);\n            graphics.lineTo(250, 50);\n            graphics.lineTo(100, 100);\n            graphics.lineTo(250, 220);\n            graphics.lineTo(50, 220);\n            graphics.lineTo(50, 50);\n            graphics.endFill();\n            graphics.lineStyle(10, 0xFF0000, 0.8);\n            graphics.beginFill(0xFF700B, 1);\n            graphics.moveTo(210, 300);\n            graphics.lineTo(450, 320);\n            graphics.lineTo(570, 350);\n            graphics.quadraticCurveTo(600, 0, 480, 100);\n            graphics.lineTo(330, 120);\n            graphics.lineTo(410, 200);\n            graphics.lineTo(210, 300);\n            graphics.endFill();\n            graphics.lineStyle(2, 0x0000FF, 1);\n            graphics.drawRect(50, 250, 100, 100);\n            graphics.lineStyle(0);\n            graphics.beginFill(0xFFFF0B, 0.5);\n            graphics.drawCircle(470, 200, 100);\n            graphics.endFill();\n            graphics.lineStyle(20, 0x33FF00);\n            graphics.moveTo(30, 30);\n            graphics.lineTo(600, 300);\n            this.graphics = graphics;\n            this.app.stage.addChild(this.graphics);\n            this.thing = new PIXI.Graphics();\n            this.thing.x = 800 / 2;\n            this.thing.y = 600 / 2;\n            this.app.stage.addChild(this.thing);\n            this.count = 0;\n            this.app.stage.on(\"pointertap\", function () {\n                _this.graphics.lineStyle(Math.random() * 30, Math.random() * 0xFFFFFF, 1);\n                _this.graphics.moveTo(Math.random() * 800, Math.random() * 600);\n                _this.graphics.bezierCurveTo(Math.random() * 800, Math.random() * 600, Math.random() * 800, Math.random() * 600, Math.random() * 800, Math.random() * 600);\n            });\n            this.app.ticker.add(function () {\n                _this.count += 0.1;\n                _this.thing.clear();\n                _this.thing.lineStyle(10, 0xff0000, 1);\n                _this.thing.beginFill(0xffFF00, 0.5);\n                _this.thing.moveTo(-120 + Math.sin(_this.count) * 20, -100 + Math.cos(_this.count) * 20);\n                _this.thing.lineTo(120 + Math.cos(_this.count) * 20, -100 + Math.sin(_this.count) * 20);\n                _this.thing.lineTo(120 + Math.sin(_this.count) * 20, 100 + Math.cos(_this.count) * 20);\n                _this.thing.lineTo(-120 + Math.cos(_this.count) * 20, 100 + Math.sin(_this.count) * 20);\n                _this.thing.lineTo(-120 + Math.sin(_this.count) * 20, -100 + Math.cos(_this.count) * 20);\n                _this.thing.rotation = _this.count * 0.1;\n            });\n        }\n        return GraphicsDemo;\n    }());\n    demos.GraphicsDemo = GraphicsDemo;\n    var Interactivity = (function () {\n        function Interactivity() {\n            this.app = new PIXI.Application();\n            document.body.appendChild(this.app.view);\n            var background = PIXI.Sprite.fromImage(\"required/assets/button_test_BG.jpg\");\n            background.width = this.app.renderer.width;\n            background.height = this.app.renderer.height;\n            this.background = background;\n            this.app.stage.addChild(this.background);\n            this.buttons = [];\n            var buttonPositions = [\n                175, 75,\n                655, 75,\n                410, 325,\n                150, 465,\n                685, 445\n            ];\n            var textureButton = PIXI.Texture.fromImage(\"../../_assets/button.png\");\n            var textureButtonDown = PIXI.Texture.fromImage(\"../../_assets/buttonDown.png\");\n            var textureButtonOver = PIXI.Texture.fromImage(\"../../_assets/buttonOver.png\");\n            for (var i = 0; i < 5; i++) {\n                var button = new PIXI.Sprite(textureButton);\n                button.anchor.set(0.5);\n                button.x = buttonPositions[i * 2];\n                button.y = buttonPositions[i * 2 + 1];\n                button.interactive = true;\n                button.buttonMode = true;\n                button\n                    .on(\"pointerdown\", function () {\n                    // blah\n                })\n                    .on(\"pointerup\", function () {\n                    // blah\n                })\n                    .on(\"pointerupoutside\", function () {\n                    // blah\n                })\n                    .on(\"pointerover\", function () {\n                    // blah\n                })\n                    .on(\"pointerout\", function () {\n                    // blah\n                });\n                this.app.stage.addChild(button);\n                this.buttons.push(button);\n            }\n            this.buttons[0].scale.set(1.2);\n            this.buttons[2].rotation = Math.PI / 10;\n            this.buttons[3].scale.set(0.8);\n            this.buttons[4].scale.set(0.8, 1.2);\n            this.buttons[4].rotation = Math.PI;\n        }\n        return Interactivity;\n    }());\n    demos.Interactivity = Interactivity;\n    var Masking = (function () {\n        function Masking() {\n            var _this = this;\n            this.app = new PIXI.Application(800, 600, { antialias: true });\n            this.app.stage.interactive = true;\n            document.body.appendChild(this.app.view);\n            this.bg = PIXI.Sprite.fromImage(\"required/assets/BGrotate.jpg\");\n            this.bg.anchor.set(0.5);\n            this.bg.x = this.app.renderer.width / 2;\n            this.bg.y = this.app.renderer.height / 2;\n            this.app.stage.addChild(this.bg);\n            this.container = new PIXI.Container();\n            this.container.x = this.app.renderer.width / 2;\n            this.container.y = this.app.renderer.height / 2;\n            this.app.stage.addChild(this.container);\n            this.bgFront = PIXI.Sprite.fromImage(\"required/assets/SceneRotate.jpg\");\n            this.bgFront.anchor.set(0.5);\n            this.light2 = PIXI.Sprite.fromImage(\"required/assets/LightRotate2.png\");\n            this.light2.anchor.set(0.5);\n            this.light1 = PIXI.Sprite.fromImage(\"required/assets/LightRotate1.png\");\n            this.light1.anchor.set(0.5);\n            this.panda = PIXI.Sprite.fromImage(\"required/assets/panda.png\");\n            this.panda.anchor.set(0.5);\n            this.container.addChild(this.bgFront, this.light2, this.light1, this.panda);\n            this.app.stage.addChild(this.container);\n            this.thing = new PIXI.Graphics();\n            this.app.stage.addChild(this.thing);\n            this.thing.x = this.app.renderer.width / 2;\n            this.thing.y = this.app.renderer.height / 2;\n            this.thing.lineStyle(0);\n            this.container.mask = this.thing;\n            this.count = 0;\n            this.app.stage.on(\"pointertap\", function () {\n                if (!_this.container.mask) {\n                    _this.container.mask = _this.thing;\n                }\n                else {\n                    _this.container.mask = null;\n                }\n            });\n            this.app.ticker.add(function () {\n                _this.bg.rotation += 0.01;\n                _this.bgFront.rotation -= 0.01;\n                _this.light1.rotation += 0.02;\n                _this.light2.rotation += 0.01;\n                _this.panda.scale.x = 1 + Math.sin(_this.count) * 0.04;\n                _this.panda.scale.y = 1 + Math.cos(_this.count) * 0.04;\n                _this.count += 0.1;\n                _this.thing.clear();\n                _this.thing.beginFill(0x8bc5ff, 0.4);\n                _this.thing.moveTo(-120 + Math.sin(_this.count) * 20, -100 + Math.cos(_this.count) * 20);\n                _this.thing.lineTo(-320 + Math.cos(_this.count) * 20, 100 + Math.sin(_this.count) * 20);\n                _this.thing.lineTo(120 + Math.cos(_this.count) * 20, -100 + Math.sin(_this.count) * 20);\n                _this.thing.lineTo(120 + Math.sin(_this.count) * 20, 100 + Math.cos(_this.count) * 20);\n                _this.thing.lineTo(-120 + Math.cos(_this.count) * 20, 100 + Math.sin(_this.count) * 20);\n                _this.thing.lineTo(-120 + Math.sin(_this.count) * 20, -300 + Math.cos(_this.count) * 20);\n                _this.thing.lineTo(-320 + Math.sin(_this.count) * 20, -100 + Math.cos(_this.count) * 20);\n                _this.thing.rotation = _this.count * 0.1;\n            });\n        }\n        return Masking;\n    }());\n    demos.Masking = Masking;\n    var RenderTextureDemo = (function () {\n        function RenderTextureDemo() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            document.body.appendChild(this.app.view);\n            this.renderTexture = PIXI.RenderTexture.create(this.app.renderer.width, this.app.renderer.height);\n            this.renderTexture2 = PIXI.RenderTexture.create(this.app.renderer.width, this.app.renderer.height);\n            this.currentTexture = this.renderTexture;\n            this.outputSprite = new PIXI.Sprite(this.currentTexture);\n            this.outputSprite.x = 400;\n            this.outputSprite.y = 300;\n            this.outputSprite.anchor.set(0.5);\n            this.app.stage.addChild(this.outputSprite);\n            this.stuffContainer = new PIXI.Container();\n            this.stuffContainer.x = 400;\n            this.stuffContainer.y = 300;\n            this.app.stage.addChild(this.stuffContainer);\n            var fruits = [\n                \"required/assets/spinObj_01.png\",\n                \"required/assets/spinObj_02.png\",\n                \"required/assets/spinObj_03.png\",\n                \"required/assets/spinObj_04.png\",\n                \"required/assets/spinObj_05.png\",\n                \"required/assets/spinObj_06.png\",\n                \"required/assets/spinObj_07.png\",\n                \"required/assets/spinObj_08.png\"\n            ];\n            this.items = [];\n            for (var i = 0; i < 20; i++) {\n                var item = PIXI.Sprite.fromImage(fruits[i % fruits.length]);\n                item.x = Math.random() * 400 - 200;\n                item.y = Math.random() * 400 - 200;\n                item.anchor.set(0.5);\n                this.stuffContainer.addChild(item);\n                this.items.push(item);\n            }\n            this.count = 0;\n            this.app.ticker.add(function () {\n                for (var i = 0; i < _this.items.length; i++) {\n                    var item = _this.items[i];\n                    item.rotation += 0.1;\n                }\n                _this.count += 0.01;\n                var temp = _this.renderTexture;\n                _this.renderTexture = _this.renderTexture2;\n                _this.renderTexture2 = temp;\n                _this.outputSprite.texture = _this.renderTexture;\n                _this.stuffContainer.rotation -= 0.01;\n                _this.outputSprite.scale.set(1 + Math.sin(_this.count) * 0.2);\n                _this.app.renderer.render(_this.app.stage, _this.renderTexture2, false);\n            });\n        }\n        return RenderTextureDemo;\n    }());\n    demos.RenderTextureDemo = RenderTextureDemo;\n    var StripDemo = (function () {\n        function StripDemo() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            document.body.appendChild(this.app.view);\n            this.count = 0;\n            var ropeLength = 918 / 20;\n            this.points = [];\n            for (var i = 0; i < 20; i++) {\n                this.points.push(new PIXI.Point(i * ropeLength, 0));\n            }\n            this.strip = new PIXI.mesh.Rope(PIXI.Texture.fromImage(\"required/assets/snake.png\"), this.points);\n            this.strip.x = -459;\n            this.snakeContainer = new PIXI.Container();\n            this.snakeContainer.position.x = 400;\n            this.snakeContainer.position.y = 300;\n            this.snakeContainer.scale.set(800 / 1100);\n            this.snakeContainer.addChild(this.strip);\n            this.app.stage.addChild(this.snakeContainer);\n            this.app.ticker.add(function () {\n                _this.count += 0.1;\n                for (var i = 0; i < _this.points.length; i++) {\n                    _this.points[i].y = Math.sin((i * 0.5) + _this.count) * 30;\n                    _this.points[i].x = i * ropeLength + Math.cos((i * 0.3) + _this.count) * 20;\n                }\n            });\n        }\n        return StripDemo;\n    }());\n    demos.StripDemo = StripDemo;\n    var TextDemo = (function () {\n        function TextDemo() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            document.body.appendChild(this.app.view);\n            PIXI.loader\n                .add(\"desyrel\", \"required/assets/desyrel.xml\")\n                .load(function () {\n                _this.bitmapFontText = new PIXI.extras.BitmapText(\"bitmap fonts are\\n now supported!\", { font: \"35px Desyrel\", align: \"right\" });\n                _this.bitmapFontText.x = _this.app.renderer.width - _this.bitmapFontText.textWidth - 20;\n                _this.bitmapFontText.y = 20;\n                _this.app.stage.addChild(_this.bitmapFontText);\n            });\n            this.background = PIXI.Sprite.fromImage(\"required/assets/textDemoBG.jpg\");\n            this.background.width = this.app.renderer.width;\n            this.background.height = this.app.renderer.height;\n            this.app.stage.addChild(this.background);\n            this.textSample = new PIXI.Text(\"Pixi.js can has\\n multiline text!\", {\n                fontFamily: \"Snippet\",\n                fontSize: 35,\n                fill: \"white\",\n                align: \"left\"\n            });\n            this.textSample.position.set(20);\n            this.spinningText = new PIXI.Text(\"I\\\"m fun!\", {\n                fontWeight: \"bold\",\n                fontSize: 60,\n                fontFamily: \"Arial\",\n                fill: \"#cc00ff\",\n                align: \"center\",\n                stroke: \"#FFFFFF\",\n                strokeThickness: 6\n            });\n            this.spinningText.anchor.set(0.5);\n            this.spinningText.x = this.app.renderer.width / 2;\n            this.spinningText.y = this.app.renderer.height / 2;\n            this.countingText = new PIXI.Text(\"COUNT 4Elet: 0\", {\n                fontWeight: \"bold\",\n                fontStyle: \"italic\",\n                fontSize: 60,\n                fontFamily: \"Arvo\",\n                fill: \"#3e1707\",\n                align: \"center\",\n                stroke: \"#a4410e\",\n                strokeThickness: 7\n            });\n            this.countingText.x = this.app.renderer.width / 2;\n            this.countingText.y = 500;\n            this.countingText.anchor.x = 0.5;\n            this.app.stage.addChild(this.textSample, this.spinningText, this.countingText);\n            this.count = 0;\n            this.app.ticker.add(function () {\n                _this.count += 0.05;\n                _this.countingText.text = \"COUNT 4Elet: \" + Math.floor(_this.count);\n                _this.spinningText.rotation += 0.03;\n            });\n        }\n        return TextDemo;\n    }());\n    demos.TextDemo = TextDemo;\n    var TextureRotate = (function () {\n        function TextureRotate() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            document.body.appendChild(this.app.view);\n            this.bol = false;\n            PIXI.loader.add(\"flowerTop\", \"required/assets/flowerTop.png\");\n            PIXI.loader.load(function (loader, resources) {\n                _this.texture = resources.flowerTop.texture;\n                _this.init();\n            });\n        }\n        TextureRotate.prototype.init = function () {\n            var textures = [this.texture];\n            var D8 = PIXI.GroupD8;\n            for (var rotate = 1; rotate < 16; rotate++) {\n                var h = D8.isSwapWidthHeight(rotate) ? this.texture.frame.width : this.texture.frame.height;\n                var w = D8.isSwapWidthHeight(rotate) ? this.texture.frame.height : this.texture.frame.width;\n                var frame = this.texture.frame;\n                var crop = new PIXI.Rectangle(this.texture.frame.x, this.texture.frame.y, w, h);\n                var trim = crop;\n                var rotatedTexture = void 0;\n                if (rotate % 2 === 0) {\n                    rotatedTexture = new PIXI.Texture(this.texture.baseTexture, frame, crop, trim, rotate);\n                }\n                else {\n                    rotatedTexture = new PIXI.Texture(this.texture.baseTexture, frame, crop, trim, rotate - 1);\n                    rotatedTexture.rotate++;\n                }\n                textures.push(rotatedTexture);\n            }\n            var offsetX = this.app.renderer.width / 16 | 0;\n            var offsetY = this.app.renderer.height / 8 | 0;\n            var gridW = this.app.renderer.width / 4 | 0;\n            var gridH = this.app.renderer.height / 5 | 0;\n            for (var i = 0; i < 16; i++) {\n                var dude = new PIXI.Sprite(textures[i < 8 ? i * 2 : (i - 8) * 2 + 1]);\n                dude.scale.x = 0.5;\n                dude.scale.y = 0.5;\n                dude.x = offsetX + gridW * (i % 4);\n                dude.y = offsetY + gridH * (i / 4 | 0);\n                this.app.stage.addChild(dude);\n                var text = new PIXI.Text(\"rotate = \" + dude.texture.rotate, { fontFamily: \"Courier New\", fontSize: \"12px\", fill: \"white\", align: \"left\" });\n                text.x = dude.x;\n                text.y = dude.y - 20;\n                this.app.stage.addChild(text);\n            }\n        };\n        return TextureRotate;\n    }());\n    demos.TextureRotate = TextureRotate;\n    var TextureSwap = (function () {\n        function TextureSwap() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            document.body.appendChild(this.app.view);\n            this.bol = false;\n            this.texture = PIXI.Texture.fromImage(\"required/assets/flowerTop.png\");\n            this.secondTexture = PIXI.Texture.fromImage(\"required/assets/eggHead.png\");\n            this.dude = new PIXI.Sprite(this.texture);\n            this.dude.anchor.set(0.5);\n            this.dude.x = this.app.renderer.width / 2;\n            this.dude.y = this.app.renderer.height / 2;\n            this.dude.interactive = true;\n            this.dude.buttonMode = true;\n            this.app.stage.addChild(this.dude);\n            this.dude.on(\"pointertap\", function () {\n                _this.bol = !_this.bol;\n                if (_this.bol) {\n                    _this.dude.texture = _this.secondTexture;\n                }\n                else {\n                    _this.dude.texture = _this.texture;\n                }\n            });\n            this.app.ticker.add(function () {\n                _this.dude.rotation += 0.1;\n            });\n        }\n        return TextureSwap;\n    }());\n    demos.TextureSwap = TextureSwap;\n    var Tinting = (function () {\n        function Tinting() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            document.body.appendChild(this.app.view);\n            this.aliens = [];\n            var totalDudes = 20;\n            var dudeTexture = PIXI.Texture.fromImage(\"required/assets/eggHead.png\");\n            for (var i = 0; i < totalDudes; i++) {\n                var dude = new Dude(dudeTexture);\n                dude.anchor.set(0.5);\n                dude.scale.set(0.8 + Math.random() * 0.3);\n                dude.x = Math.random() * this.app.renderer.width;\n                dude.y = Math.random() * this.app.renderer.height;\n                dude.tint = Math.random() * 0xFFFFFF;\n                dude.direction = Math.random() * Math.PI * 2;\n                dude.turningSpeed = Math.random() - 0.8;\n                dude.speed = 2 + Math.random() * 2;\n                this.aliens.push(dude);\n                this.app.stage.addChild(dude);\n            }\n            var dudeBoundsPadding = 100;\n            var dudeBounds = new PIXI.Rectangle(-dudeBoundsPadding, -dudeBoundsPadding, this.app.renderer.width + dudeBoundsPadding * 2, this.app.renderer.height + dudeBoundsPadding * 2);\n            this.app.ticker.add(function () {\n                for (var i = 0; i < _this.aliens.length; i++) {\n                    var dude = _this.aliens[i];\n                    dude.direction += dude.turningSpeed * 0.01;\n                    dude.x += Math.sin(dude.direction) * dude.speed;\n                    dude.y += Math.cos(dude.direction) * dude.speed;\n                    dude.rotation = -dude.direction - Math.PI / 2;\n                    if (dude.x < dudeBounds.x) {\n                        dude.x += dudeBounds.width;\n                    }\n                    else if (dude.x > dudeBounds.x + dudeBounds.width) {\n                        dude.x -= dudeBounds.width;\n                    }\n                    if (dude.y < dudeBounds.y) {\n                        dude.y += dudeBounds.height;\n                    }\n                    else if (dude.y > dudeBounds.y + dudeBounds.height) {\n                        dude.y -= dudeBounds.height;\n                    }\n                }\n            });\n        }\n        return Tinting;\n    }());\n    demos.Tinting = Tinting;\n    var TransparentBackground = (function () {\n        function TransparentBackground() {\n            var _this = this;\n            this.app = new PIXI.Application(800, 600, { transparent: true });\n            document.body.appendChild(this.app.view);\n            this.bunny = PIXI.Sprite.fromImage(\"required/assets/bunny.png\");\n            this.bunny.anchor.set(0.5);\n            this.bunny.x = this.app.renderer.width / 2;\n            this.bunny.y = this.app.renderer.height / 2;\n            this.app.stage.addChild(this.bunny);\n            this.app.ticker.add(function () {\n                _this.bunny.rotation += 0.1;\n            });\n        }\n        return TransparentBackground;\n    }());\n    demos.TransparentBackground = TransparentBackground;\n})(demos || (demos = {}));\nvar filters;\n(function (filters) {\n    var BlurFilter = (function () {\n        function BlurFilter() {\n            var _this = this;\n            this.app = new PIXI.Application(800, 600);\n            document.body.appendChild(this.app.view);\n            this.bg = PIXI.Sprite.fromImage(\"required/assets/depth_blur_BG.jpg\");\n            this.bg.width = this.app.renderer.width;\n            this.bg.height = this.app.renderer.height;\n            this.app.stage.addChild(this.bg);\n            this.littleDudes = PIXI.Sprite.fromImage(\"required/assets/depth_blur_dudes.jpg\");\n            this.littleDudes.x = (this.app.renderer.width / 2) - 315;\n            this.littleDudes.y = 200;\n            this.app.stage.addChild(this.littleDudes);\n            this.littleRobot = PIXI.Sprite.fromImage(\"required/assets/depth_blur_moby.jpg\");\n            this.littleRobot.x = (this.app.renderer.width / 2) - 200;\n            this.littleRobot.y = 100;\n            this.app.stage.addChild(this.littleRobot);\n            this.blurFilter1 = new PIXI.filters.BlurFilter();\n            this.blurFilter2 = new PIXI.filters.BlurFilter();\n            this.littleDudes.filters = [this.blurFilter1];\n            this.littleRobot.filters = [this.blurFilter2];\n            this.count = 0;\n            this.app.ticker.add(function () {\n                _this.count += 0.005;\n                var blurAmount = Math.cos(_this.count);\n                var blurAmount2 = Math.sin(_this.count);\n                _this.blurFilter1.blur = 20 * (blurAmount);\n                _this.blurFilter2.blur = 20 * (blurAmount2);\n            });\n        }\n        return BlurFilter;\n    }());\n    filters.BlurFilter = BlurFilter;\n    var DisplacementMap = (function () {\n        function DisplacementMap() {\n            var _this = this;\n            this.onPointerMove = function (eventData) {\n                _this.ring.visible = true;\n                _this.displacementSprite.x = eventData.data.global.x - 100;\n                _this.displacementSprite.y = eventData.data.global.y - _this.displacementSprite.height / 2;\n                _this.ring.x = eventData.data.global.x - 25;\n                _this.ring.y = eventData.data.global.y;\n            };\n            this.app = new PIXI.Application(800, 600);\n            this.app.stage.interactive = true;\n            document.body.appendChild(this.app.view);\n            this.container = new PIXI.Container();\n            this.app.stage.addChild(this.container);\n            var padding = 100;\n            var bounds = new PIXI.Rectangle(-padding, -padding, this.app.renderer.width + padding * 2, this.app.renderer.height + padding * 2);\n            this.maggots = [];\n            for (var i = 0; i < 20; i++) {\n                var maggot = new DisplacementMapDude();\n                maggot.anchor.set(0.5);\n                this.container.addChild(maggot);\n                maggot.direction = Math.random() * Math.PI * 2;\n                maggot.speed = 1;\n                maggot.turnSpeed = Math.random() - 0.8;\n                maggot.position.x = Math.random() * bounds.width;\n                maggot.position.y = Math.random() * bounds.height;\n                maggot.scale.set(1 + Math.random() * 0.3);\n                maggot.original = maggot.scale.clone();\n                this.maggots.push(maggot);\n            }\n            this.displacementSprite = PIXI.Sprite.fromImage(\"required/assets/displace.png\");\n            var displacementFilter = new PIXI.filters.DisplacementFilter(this.displacementSprite);\n            this.app.stage.addChild(this.displacementSprite);\n            this.container.filters = [displacementFilter];\n            displacementFilter.scale.x = 110;\n            displacementFilter.scale.y = 110;\n            this.ring = PIXI.Sprite.fromImage(\"required/assets/ring.png\");\n            this.ring.anchor.set(0.5);\n            this.ring.visible = false;\n            this.app.stage.addChild(this.ring);\n            this.bg = PIXI.Sprite.fromImage(\"required/assets/bkg-grass.jpg\");\n            this.bg.width = this.app.renderer.width;\n            this.bg.height = this.app.renderer.height;\n            this.bg.alpha = 0.4;\n            this.container.addChild(this.bg);\n            this.count = 0;\n            this.app.stage\n                .on(\"mousemove\", this.onPointerMove)\n                .on(\"touchmove\", this.onPointerMove);\n            this.app.ticker.add(function () {\n                _this.count += 0.05;\n                for (var i = 0; i < _this.maggots.length; i++) {\n                    var maggot = _this.maggots[i];\n                    maggot.direction += maggot.turnSpeed * 0.01;\n                    maggot.x += Math.sin(maggot.direction) * maggot.speed;\n                    maggot.y += Math.cos(maggot.direction) * maggot.speed;\n                    maggot.rotation = -maggot.direction - Math.PI / 2;\n                    maggot.scale.x = maggot.original.x + Math.sin(_this.count) * 0.2;\n                    if (maggot.x < bounds.x) {\n                        maggot.x += bounds.width;\n                    }\n                    else if (maggot.x > bounds.x + bounds.width) {\n                        maggot.x -= bounds.width;\n                    }\n                    if (maggot.y < bounds.y) {\n                        maggot.y += bounds.height;\n                    }\n                    else if (maggot.y > bounds.y + bounds.height) {\n                        maggot.y -= bounds.height;\n                    }\n                }\n            });\n        }\n        return DisplacementMap;\n    }());\n    filters.DisplacementMap = DisplacementMap;\n    var DisplacementMapDude = (function (_super) {\n        __extends(DisplacementMapDude, _super);\n        function DisplacementMapDude() {\n            var _this = _super.call(this, PIXI.Texture.fromImage(\"../../_assets/maggot.png\")) || this;\n            _this.direction = 0;\n            _this.speed = 0;\n            _this.turnSpeed = 0;\n            _this.original = new PIXI.Point();\n            return _this;\n        }\n        return DisplacementMapDude;\n    }(PIXI.Sprite));\n    filters.DisplacementMapDude = DisplacementMapDude;\n    var Filter = (function () {\n        function Filter() {\n            var _this = this;\n            this.app = new PIXI.Application();\n            this.app.stage.interactive = true;\n            document.body.appendChild(this.app.view);\n            this.bg = PIXI.Sprite.fromImage(\"required/assets/BGrotate.jpg\");\n            this.bg.anchor.set(0.5);\n            this.bg.x = this.app.renderer.width / 2;\n            this.bg.y = this.app.renderer.height / 2;\n            this.filter = new PIXI.filters.ColorMatrixFilter();\n            this.container = new PIXI.Container();\n            this.container.position.x = this.app.renderer.width / 2;\n            this.container.position.y = this.app.renderer.height / 2;\n            this.app.stage.addChild(this.container);\n            this.bgFront = PIXI.Sprite.fromImage(\"required/assets/SceneRotate.jpg\");\n            this.bgFront.anchor.set(0.5);\n            this.container.addChild(this.bgFront);\n            this.light2 = PIXI.Sprite.fromImage(\"required/assets/LightRotate2.png\");\n            this.light2.anchor.set(0.5);\n            this.container.addChild(this.light2);\n            this.light1 = PIXI.Sprite.fromImage(\"../../_assets/LightRotate1.png\");\n            this.light1.anchor.set(0.5);\n            this.container.addChild(this.light1);\n            this.panda = PIXI.Sprite.fromImage(\"required/assets/panda.png\");\n            this.panda.anchor.set(0.5);\n            this.container.addChild(this.panda);\n            this.app.stage.filters = [this.filter];\n            this.count = 0;\n            this.enabled = true;\n            this.app.stage.on(\"pointertap\", function () {\n                _this.enabled = !_this.enabled;\n                _this.app.stage.filters = _this.enabled ? [_this.filter] : null;\n            });\n            this.help = new PIXI.Text(\"Click or tap to turn filters on / off.\", {\n                fontFamily: \"Arial\",\n                fontSize: 12,\n                fontWeight: \"bold\",\n                fill: \"white\"\n            });\n            this.help.y = this.app.renderer.height - 25;\n            this.help.x = 10;\n            this.app.stage.addChild(this.help);\n            this.app.ticker.add(function (delta) {\n                _this.bg.rotation += 0.01;\n                _this.bgFront.rotation -= 0.01;\n                _this.light1.rotation += 0.02;\n                _this.light2.rotation += 0.01;\n                _this.panda.scale.x = 1 + Math.sin(_this.count) * 0.04;\n                _this.panda.scale.y = 1 + Math.cos(_this.count) * 0.04;\n                _this.count += 0.1;\n                var matrix = _this.filter.matrix;\n                matrix[1] = Math.sin(_this.count) * 3;\n                matrix[2] = Math.cos(_this.count);\n                matrix[3] = Math.cos(_this.count) * 1.5;\n                matrix[4] = Math.sin(_this.count / 3) * 2;\n                matrix[5] = Math.sin(_this.count / 2);\n                matrix[6] = Math.sin(_this.count / 4);\n            });\n        }\n        return Filter;\n    }());\n    filters.Filter = Filter;\n})(filters || (filters = {}));\nvar Animyst;\n(function (Animyst) {\n    var SpriteSheetAnimation = (function () {\n        function SpriteSheetAnimation(id, framerate) {\n            if (framerate === void 0) { framerate = 60; }\n            this.time = 0;\n            this.playTime = 0;\n            this.currentFrame = 0;\n            this.id = id;\n            this.animations = {};\n            this.spritesheets = {};\n            this.framerate = framerate;\n        }\n        SpriteSheetAnimation.prototype.addSheet = function (sheetData) {\n            this.spritesheets[sheetData.name] = sheetData;\n        };\n        SpriteSheetAnimation.prototype.getSheet = function (sheetID) {\n            return this.spritesheets[sheetID];\n        };\n        ;\n        SpriteSheetAnimation.prototype.addAnimation = function (name, prefix, sheetID, params) {\n            if (params === void 0) { params = {}; }\n            var anim = {};\n            var spritesheet = this.getSheet(sheetID);\n            anim.name = name;\n            anim.prefix = prefix;\n            anim.sheetID = sheetID;\n            anim.useFrames = params.useFrames || false;\n            anim.frames = spritesheet.getFrames(anim.prefix);\n            anim.currentFrameIndex = 0;\n            anim.totalFrames = anim.frames.length;\n            anim.duration = params.duration || anim.useFrames ? anim.totalFrames * (this.framerate / 60) : 1000 / this.framerate * anim.totalFrames;\n            anim.loop = params.loop || false;\n            anim.repeat = params.repeat || 0;\n            anim.elapsed = 0;\n            anim.framecount = 0;\n            this.animations[anim.name] = anim;\n        };\n        SpriteSheetAnimation.prototype.getAnimation = function (name) {\n            return this.animations[name];\n        };\n        ;\n        SpriteSheetAnimation.prototype.play = function (name) {\n            if (this.currentAnim == name)\n                return;\n            var anim = this.getAnimation(name);\n            this.currentAnim = name;\n            this.playing = true;\n        };\n        ;\n        SpriteSheetAnimation.prototype.stop = function () {\n        };\n        SpriteSheetAnimation.prototype.pause = function () {\n        };\n        SpriteSheetAnimation.prototype.resume = function () {\n        };\n        SpriteSheetAnimation.prototype.setIdle = function (name) {\n            // body...  \n        };\n        ;\n        SpriteSheetAnimation.prototype.animate = function (delta) {\n            if (delta === void 0) { delta = 0; }\n            if (this.playing) {\n                //console.log(delta, time, this.time, this.playTime, this.currentFrame, this.sourceFile)\n                var anim = this.getAnimation(this.currentAnim);\n                if (anim.useFrames) {\n                }\n                else {\n                }\n            }\n        };\n        ;\n        return SpriteSheetAnimation;\n    }());\n    Animyst.SpriteSheetAnimation = SpriteSheetAnimation;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var SpriteSheetData = (function (_super) {\n        __extends(SpriteSheetData, _super);\n        function SpriteSheetData(name, data) {\n            var _this = _super.call(this) || this;\n            _this.name = name;\n            _this.data = data;\n            _this.parse();\n            return _this;\n        }\n        SpriteSheetData.prototype.parse = function () {\n            for (var k in this.data.frames) {\n                this.addFrame(k, this.data.frames[k]);\n            }\n        };\n        SpriteSheetData.prototype.addFrame = function (frameID, data) {\n            var frame = new FrameData(frameID, data);\n            this.create(frame, frameID, data);\n        };\n        SpriteSheetData.prototype.getFrame = function (frameID) {\n            return this.getItem(frameID);\n        };\n        SpriteSheetData.prototype.getFrames = function (framePrefix) {\n            if (!this.hasCategory(framePrefix)) {\n                var ctx = {};\n                ctx.framePrefix = framePrefix;\n                this.addCategory(framePrefix, function (frame) {\n                    return frame.id.indexOf(this.framePrefix) == 0;\n                }, FrameData, ctx);\n            }\n            var frames = this.getItemsInCategory(framePrefix);\n            frames.sort(this._sortCaseInsensitive);\n            return frames;\n        };\n        SpriteSheetData.prototype._sortCaseInsensitive = function (a, b) {\n            if (a.toLowerCase() < b.toLowerCase())\n                return -1;\n            if (a.toLowerCase() > b.toLowerCase())\n                return 1;\n            return 0;\n        };\n        return SpriteSheetData;\n    }(Animyst.Database));\n    Animyst.SpriteSheetData = SpriteSheetData;\n    var FrameData = (function (_super) {\n        __extends(FrameData, _super);\n        function FrameData(id, params) {\n            return _super.call(this, id, params) || this;\n        }\n        FrameData.prototype.setup = function (params) {\n            this.frame = params.frame;\n            this.rotated = params.rotated;\n            this.trimmed = params.trimmed;\n            this.spriteSourceSize = params.spriteSourceSize;\n            this.sourceSize = params.sourceSize;\n            this.pivot = params.pivot;\n            _super.prototype.setup.call(this, params);\n        };\n        ;\n        return FrameData;\n    }(Animyst.Item));\n    Animyst.FrameData = FrameData;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var CoreProcess = (function (_super) {\n        __extends(CoreProcess, _super);\n        function CoreProcess(id) {\n            return _super.call(this, id) || this;\n        }\n        CoreProcess.prototype.setup = function () {\n            Animyst.Log.output(\"[CoreProcess] Core Process Initialize\");\n            _super.prototype.setup.call(this);\n            this._inputData = new Animyst.InputData();\n            var config = this.appScope.config;\n            var input = new Animyst.Input(this._inputData);\n            input.startup({ element: document.body, keyboardSettings: config.settings.keyboard });\n            this.addSystem(\"input\", input);\n            this.appScope.addDatabase(CoreProcess.INPUT, this._inputData);\n        };\n        CoreProcess.prototype.start = function () {\n            Animyst.Log.output(\"[CoreProcess] Start\");\n            _super.prototype.start.call(this);\n        };\n        CoreProcess.prototype.update = function (delta, time) {\n            //console.log(\"[Game] Updating...\")\n            _super.prototype.update.call(this, delta, time);\n        };\n        CoreProcess.prototype.pause = function () {\n            _super.prototype.pause.call(this);\n        };\n        CoreProcess.prototype.resume = function () {\n            _super.prototype.resume.call(this);\n        };\n        CoreProcess.prototype.kill = function () {\n            _super.prototype.kill.call(this);\n        };\n        CoreProcess.prototype.restart = function () {\n            _super.prototype.restart.call(this);\n        };\n        return CoreProcess;\n    }(Animyst.AppState));\n    CoreProcess.ID = \"core\";\n    CoreProcess.INPUT = \"input\";\n    Animyst.CoreProcess = CoreProcess;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var ArrayUtil = (function () {\n        function ArrayUtil(argument) {\n            // code...\n        }\n        /**\n        * Searches through any array for an element with a specific property\n        * @param  {any} property Property to check\n        * @param  {any} value    Value of the property\n        * @param  {any} array    Array of elements\n        * @return {any}          First element found with given property value. Returns null if nothing is found\n        */\n        ArrayUtil.search = function (property, value, array) {\n            for (var i = 0; i < array.length; i++) {\n                var obj = array[i];\n                if (obj[property] && obj[property] === value) {\n                    return obj;\n                }\n            }\n            return null;\n        };\n        /**\n        * Searches through any array for all elements with a specific property\n        * @param  {any} property Property to check\n        * @param  {any} value    Value of the property\n        * @param  {any} array    Array of elements\n        * @return {any}          First element found with given property value. Returns null if nothing is found\n        */\n        ArrayUtil.searchAll = function (property, value, array, output) {\n            if (output === void 0) { output = []; }\n            for (var i = 0; i < array.length; i++) {\n                var obj = array[i];\n                if (obj[property] && obj[property] === value) {\n                    output.push(obj);\n                }\n            }\n            return output;\n        };\n        /**\n        * Pushes an element to an array as long as it is not already included in the array\n        * @param {any}   element [description]\n        * @param {any[]} array   [description]\n        */\n        ArrayUtil.include = function (element, array) {\n            if (array.indexOf(element) == -1)\n                array.push(element);\n        };\n        /**\n        * Splices an element out of an array\n        * @param {any}   element [description]\n        * @param {any[]} array   [description]\n        */\n        ArrayUtil.remove = function (element, array) {\n            var index = array.indexOf(element);\n            if (index >= 0)\n                array.splice(index, 1);\n        };\n        /**\n        * Traverses array and executes a call on each element\n        * @param {any[]}     array   [description]\n        * @param {any}       command [description]\n        * @param {number =       0}           startIndex [description]\n        * @param {number =       1}           inc        [description]\n        * @param {any}       ctx     [description]\n        */\n        ArrayUtil.traverse = function (array, command, startIndex, inc, ctx) {\n            if (startIndex === void 0) { startIndex = 0; }\n            if (inc === void 0) { inc = 1; }\n            if (ctx === void 0) { ctx = null; }\n            for (var i = startIndex; i < array.length; i += inc) {\n                command.call(ctx, array[i]);\n            }\n        };\n        return ArrayUtil;\n    }());\n    Animyst.ArrayUtil = ArrayUtil;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var MathUtil = (function () {\n        function MathUtil() {\n        }\n        MathUtil.loopSum = function (v, inc, max, min) {\n            if (min === void 0) { min = 0; }\n            var result = (v + inc) % (max + 1) + min;\n            if (result < min)\n                result = (max + 1) - Math.abs(result - min);\n            return result;\n        };\n        MathUtil.constrain = function (v, min, max) {\n            return Math.max(min, Math.min(v, max));\n        };\n        MathUtil.findClosestDivisable = function (value, divisor) {\n            if (value <= divisor)\n                return divisor;\n            if (value % divisor > divisor / 2) {\n                return value + (divisor - (value % divisor));\n            }\n            else {\n                return value - (value % divisor);\n            }\n        };\n        MathUtil.findNextDivisable = function (value, divisor) {\n            if (value <= divisor)\n                return divisor;\n            return value + (divisor - (value % divisor));\n        };\n        MathUtil.interpolate = function (a, b, percent) {\n            return a + (b - a) * percent;\n        };\n        return MathUtil;\n    }());\n    Animyst.MathUtil = MathUtil;\n})(Animyst || (Animyst = {}));\nvar Animyst;\n(function (Animyst) {\n    var ObjectUtil = (function () {\n        function ObjectUtil() {\n        }\n        /**\n         * Inverts the properties and keys of an object\n         * @param  {any} object Object to invert\n         * @return {any}        Inverted copy of object\n         */\n        ObjectUtil.invert = function (object) {\n            var obj = {};\n            for (var k in object) {\n                obj[object[k]] = k;\n            }\n            return obj;\n        };\n        /**\n         * Returns copy of an object\n         * @param  {any} obj    Object to copy\n         * @param  {any} target Target object to copy to\n         * @return {any}        [description]\n         */\n        ObjectUtil.copy = function (obj, target) {\n            target = target || {};\n            for (var k in obj) {\n                if (obj[k] instanceof Object) {\n                    if (Array.isArray(obj[k])) {\n                        target[k] = obj[k].concat();\n                    }\n                    else {\n                        target[k] = ObjectUtil.copy(obj[k]);\n                    }\n                }\n                else {\n                    target[k] = obj[k];\n                }\n            }\n            return target;\n        };\n        return ObjectUtil;\n    }());\n    Animyst.ObjectUtil = ObjectUtil;\n})(Animyst || (Animyst = {}));\n","module Animyst {\r\n    export class Application {\r\n\r\n    \tprivate _appStateList:any[];\r\n    \tprivate _appStateLib:any;\r\n    \tprivate _stats:any;\r\n    \tprivate _startParams:any;\r\n\r\n    \tprivate _lastFrame:number = 0;\r\n    \tprivate _framerate:number = 60;\r\n    \tpublic get framerate():number { return this._framerate;};\r\n    \t\r\n    \tprivate _framecount:number = 0;\r\n    \tpublic get framecount():number{return this._framecount};\r\n\r\n    \tprivate _timestep:number = 1000 / this._framerate;\r\n    \tpublic get timestep():number { return this._timestep;};\r\n    \tpublic set timestep(v:number) { this._timestep = v;};\r\n\r\n    \tpublic appScope:AppScope;\r\n    \tpublic initSignal:any;\r\n    \tpublic config:any;\r\n    \tpublic runtime:number = 0;\r\n    \t\r\n    \tconstructor(argument) {\r\n    \t\tthis._appStateList  = [];\r\n\t\t\tthis._appStateLib   = {};\r\n\r\n\t\t\tthis.appScope = new AppScope();\r\n\r\n\t\t\tthis.initSignal = new Signal();\r\n    \t}\r\n\r\n    \tpublic startup(params:any):void{\r\n    \t\tLog.output(\"===================================================\");\r\n\t\t\tLog.output(\"   ----- AnimystJS: (v \" + VERSION + \") by ~Saykrd -----   \");\r\n\t\t\tLog.output(\"===================================================\");\r\n\t\t\tLog.output(\"Browser:\", Environment.browserName);\r\n\t\t\tLog.output(\"Version:\", Environment.browserVersion);\r\n\t\t\tLog.output(\"Platform:\", Environment.platformName);\r\n\t\t\tLog.output(\"===================================================\");\r\n\r\n\t\t\tthis._startParams = params;\r\n\r\n\t\t\t// Load all configuration files and and assets first\r\n\t\t\tDataLoad.startup({});\r\n\t\t\tDataLoad.loadAsset({\"id\" : \"config\", \"src\" : \"config.json\"}, (type, evt) => this.onLoading(type, evt));\r\n    \t}\r\n\r\n\r\n    \tprivate onLoading(type:number, evt:any):void{\r\n    \t\tif(type == DataLoad.FILE_LOADED){\r\n\r\n\t\t\t\tswitch(evt.item.id){\r\n\t\t\t\t\tcase \"config\":\r\n\t\t\t\t\t\tLog.output(\"[Application] Config json loaded\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.config = DataLoad.getAsset(\"config\");\r\n\t\t\t\t\t\tthis.appScope.config = this.config;\r\n\r\n\t\t\t\t\t\tDataLoad.loadFromManifest([\r\n\t\t\t\t\t\t\t{\"id\" : \"assets\", \"src\" : this.config.assets}, \r\n\t\t\t\t\t\t\t{\"id\" : \"strings\", \"src\" : this.config.strings}\r\n\t\t\t\t\t\t]);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"assets\":\r\n\t\t\t\t\t\tLog.output(\"[Application] Assets json loaded\");\r\n\t\t\t\t\t\tvar assets = DataLoad.getAsset(\"assets\");\r\n\t\t\t\t\t\tDataLoad.listAssets(assets.manifest);\r\n\t\t\t\t\t\t//Log.output(DataLoad._assetList);\r\n\r\n\t\t\t\t\t\tif(assets.initialLoad){\r\n\t\t\t\t\t\t\tDataLoad.loadFromManifest(assets.initialLoad);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"strings\":\r\n\t\t\t\t\t\tLog.output(\"[Application] Strings json loaded\");\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t} else if(type == DataLoad.LOAD_COMPLETE){\r\n\t\t\t\t//DataLoad.removeLoadHandler(this._load);\r\n\t\t\t\tthis.init();\r\n\t\t\t}\r\n    \t}\r\n\r\n    \tprivate init():void{\r\n    \t\tvar params = this._startParams;\r\n\r\n\t\t\tLOGGING = this.config.settings.logging || LOGGING;\r\n\t\t\tDEBUG   = this.config.settings.debug   || DEBUG;\r\n\r\n\t\t\t//window[\"Paper\"] = {};\r\n\t\t\t//paper.install(window[\"Paper\"]);\r\n\r\n\t\t\tLog.output(\"[Application] Application Started\")\r\n\r\n\t\t\tif(this.config.settings.debug){\r\n\t\t\t\tif(window[\"Stats\"] && !Environment.isCocoonJS){\r\n\t\t\t\t\tthis._stats = new window[\"Stats\"]();\r\n\t\t\t\t\tthis._stats.domElement.style.position = 'absolute';\r\n\t\t\t\t\tthis._stats.domElement.style.left = '0px';\r\n\t\t\t\t\tthis._stats.domElement.style.top = '0px';\r\n\r\n\t\t\t\t\tdocument.body.appendChild( this._stats.domElement );\r\n\t\t\t\t\tLog.output(\"[Application] Stats Enabled\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(window[\"dat\"] && !Environment.isCocoonJS){\r\n\t\t\t\t\tAnimyst.GUI = new window[\"dat\"].GUI();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\r\n\t\t\tvar coreprocess = new CoreProcess(CoreProcess.ID);\r\n\t\t\tthis.run(coreprocess);\r\n\r\n\t\t\tthis.timestep = this.config.settings.timestep || this.timestep;\r\n\r\n\t\t\tsetInterval(() => this.fixedUpdate, this.timestep);\r\n\r\n\t\t\tif(window[\"view\"]){\r\n\t\t\t\twindow[\"view\"].onFrame = this.frameUpdate.bind(this);\t\r\n\t\t\t} else {\r\n\t\t\t\tthis.initFrame();\r\n\t\t\t}\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\tthis.initSignal.dispatch();\r\n    \t}\r\n\r\n    \tprivate initFrame():void{\r\n    \t\trequestAnimationFrame(() => this.initFrame());\r\n\t\t\tthis.frameUpdate();\r\n    \t}\r\n\r\n    \tpublic run(appState:AppState):void{\r\n    \t\tif(!this._appStateLib[appState.id]){\r\n\t\t\t\tthis._appStateLib[appState.id] = appState;\r\n\r\n\t\t\t\tthis._appStateList.push(appState);\r\n\r\n\t\t\t\tappState.setScope(this.appScope);\r\n\t\t\t\tappState.framerate = this.framerate;\r\n\t\t\t\tappState.timestep = this.timestep;\r\n\t\t\t\tappState.setup();\r\n\t\t\t\tappState.start();\r\n\t\t\t}\r\n    \t}\r\n\r\n\r\n    \tpublic halt(appStateID:string):void{\r\n    \t\tif(!this._appStateLib[appStateID]){\r\n\t\t\t\tthis._appStateLib[appStateID].pause();\r\n\t\t\t}\r\n    \t}\r\n\r\n    \tpublic resume(appStateID:string):void{\r\n    \t\tif(!this._appStateLib[appStateID]){\r\n\t\t\t\tthis._appStateLib[appStateID].resume();\r\n\t\t\t}\r\n    \t}\r\n\r\n    \tpublic end(appStateID):void{\r\n    \t\tif(!this._appStateLib[appStateID]){\r\n\t\t\t\tvar appState = this._appStateLib[appStateID]\r\n\r\n\t\t\t\tappState.kill();\r\n\r\n\t\t\t\tthis._appStateLib[appState.id] = null;\r\n\r\n\r\n\t\t\t\tfor(var i = 0; i < this._appStateList.length; i++){\r\n\t\t\t\t\tvar state = this._appStateList[i];\r\n\t\t\t\t\tif(state.id == appState.id){\r\n\t\t\t\t\t\tthis._appStateList.splice(i,1);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n    \t}\r\n\r\n    \tpublic endAll():void{\r\n    \t\tfor(var k in this._appStateLib){\r\n\t\t\t\tthis.end(k)\r\n\t\t\t}\r\n    \t}\r\n\r\n    \tpublic fixedUpdate():void{\r\n    \t\tthis.runtime += this.timestep;\r\n\r\n\t\t\tfor(var i = 0; i < this._appStateList.length; i++){\r\n\t\t\t\tvar state:AppState = this._appStateList[i];\r\n\t\t\t\tstate.fixedUpdate(this.timestep, this.runtime);\r\n\t\t\t}\r\n    \t}\r\n\r\n    \tpublic frameUpdate(event?:any):void{\r\n    \t\t// Calculate time intervals\r\n\t\t\tvar delta = 0;\r\n\t\t\tvar time  = 0;\r\n\r\n\t\t\tif(event){\r\n\t\t\t\tdelta = event.delta;\r\n\t\t\t\ttime  = event.time;\r\n\t\t\t} else {\r\n\t\t\t\ttime  = Date.now();\r\n\t\t\t\tdelta = time - (this._lastFrame || Date.now());\r\n\t\t\t\tthis._lastFrame = time;\r\n\t\t\t}\r\n\r\n\t\t\tif(this._stats){\r\n\t\t\t\tthis._stats.begin();\r\n\t\t\t}\r\n\r\n\t\t\tfor(var i = 0; i < this._appStateList.length; i++){\r\n\t\t\t\tvar state:AppState = this._appStateList[i];\r\n\t\t\t\tstate.update(delta, this._framecount);\r\n\t\t\t}\r\n\r\n\t\t\tthis._framecount++;\r\n\r\n\t\t\tif(this._stats){\r\n\t\t\t\tthis._stats.end();\r\n\t\t\t}\r\n    \t}\r\n    }\r\n}","module Animyst {\r\n    export class AppScope {\r\n\r\n\t\tpublic databases:any = {};\r\n\t\tpublic config:any;\r\n\r\n\r\n    \tconstructor() {\r\n    \t\t// code...\r\n    \t}\r\n\r\n    \tpublic addDatabase (id:string, database:Database):void{\r\n\t\t\tthis.databases[id] = database;\r\n\t\t}\r\n\r\n\t\tpublic getDatabase (id:string):Database{\r\n\t\t\treturn this.databases[id];\r\n\t\t}\r\n    }\r\n}","module Animyst {\r\n    export class AppState {\r\n    \t\r\n\r\n    \tprivate _id:string;\r\n    \tpublic get id():string{return this._id};\r\n\r\n    \tprivate _systemList:any[] = [];\r\n    \tprivate _systemLib:any = [];\r\n\r\n    \tpublic active:boolean;\r\n    \tpublic paused:boolean;\r\n    \tpublic appScope:AppScope;\r\n    \tprivate _framerate:number = 60;\r\n    \tpublic get framerate():number { return this._framerate};\r\n    \tpublic set framerate(v:number){this._framerate = v};\r\n\r\n    \tpublic _timestep:number = 1000/this.framerate;\r\n    \tpublic get timestep():number { return this._timestep};\r\n    \tpublic set timestep(v:number){this._timestep = v};\r\n\r\n\t\tpublic setScope (appScope):void{\r\n\t\t\tthis.appScope = appScope;\r\n\t\t}\r\n\r\n\r\n\t\tpublic clearScope ():void{\r\n\t\t\tthis.appScope = null;\r\n\t\t}\r\n\r\n\r\n\t\tpublic setup ():void{\r\n\r\n\t\t}\r\n\r\n\t\tpublic start ():void{\r\n\t\t\tthis.active = true;\r\n\t\t}\r\n\r\n\t\tpublic stop ():void{\r\n\t\t\tthis.active = false;\r\n\t\t\tfor(var i = 0 ; i < this._systemList.length; i++){\r\n\t\t\t\tvar system = this._systemList[i];\r\n\t\t\t\tsystem.shutdown();\t\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic update (delta:number, framecount:number):void{\r\n\t\t\t//console.log(\"[AppState] Updating...\", this);\r\n\t\t\tif(this.active && !this.paused){\r\n\t\t\t\tfor(var i = 0 ; i < this._systemList.length; i++){\r\n\t\t\t\t\tvar system = this._systemList[i];\r\n\t\t\t\t\tif(system.started && !system.paused){\r\n\t\t\t\t\t\tsystem.update(delta, framecount);\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic fixedUpdate (timestep:number, time:number):void{\r\n\t\t\t//console.log(\"[AppState] Updating...\", this);\r\n\t\t\tif(this.active && !this.paused){\r\n\t\t\t\tfor(var i = 0 ; i < this._systemList.length; i++){\r\n\t\t\t\t\tvar system = this._systemList[i];\r\n\t\t\t\t\tif(system.started && !system.paused){\r\n\t\t\t\t\t\tsystem.fixedUpdate(timestep, time);\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic pause ():void{\r\n\t\t\tthis.paused = true;\r\n\t\t}\r\n\r\n\t\tpublic resume ():void{\r\n\t\t\tthis.paused = false;\r\n\t\t}\r\n\r\n\t\tpublic kill ():void{\r\n\t\t\tthis.stop();\r\n\t\t\tthis.clearScope();\r\n\t\t\t\r\n\t\t\tthis._systemList = null;\r\n\t\t\tthis._systemLib  = null;\r\n\t\t}\r\n\r\n\t\tpublic restart ():void{\r\n\r\n\t\t}\r\n\r\n\t\tpublic addSystem (id, system):void{\r\n\t\t\tif(!this._systemList[id]){\r\n\t\t\t\tthis._systemLib[id] = system;\r\n\t\t\t\tthis._systemList.push(system);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic getSystem (id):void{\r\n\t\t\tif(!this._systemList[id]){\r\n\t\t\t\treturn this._systemLib[id];\r\n\t\t\t}\r\n\r\n\t\t\tconsole.error(\"[AppState] !! No system found with ID: \" + id);\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n    \tconstructor(id:string) {\r\n    \t\tthis._id = id;\r\n    \t}\r\n    }\r\n}","module Animyst {\r\n    export class Database {\r\n\r\n    \tstatic ADDED:string   = 'added';\r\n\t\tstatic REMOVED:string = 'removed';\r\n\r\n\t\tprivate _itemCount = 0;\r\n\t\tprivate _items = {};\r\n\t\tprivate _itemList = [];\r\n\t\tprivate _categoryLists  = {};\r\n\t\tprivate _categoryChecks = {};\r\n\r\n\t\tpublic signal = new Signal();\r\n    \t\r\n    \tconstructor() {\r\n    \t\t// code...\r\n    \t}\r\n\r\n    \t/**\r\n\t\t * Adds an item category list to keep track of specific items\r\n\t\t * @param {string} name    Name of category\r\n\t\t * @param {function} check   A function evaluating the item. Ex: \"function (item) { if(shouldBeInList) return true; return false}\"\r\n\t\t * @param {class} cls     The class type the item should belong to\r\n\t\t * @param {ctx} context The 'this' variable to be used with the check\r\n\t\t */\r\n\t\tpublic addCategory (name:string, check:any, cls?:any, context?:any){\r\n\t\t\tthis._categoryLists[name] = [];\r\n\t\t\tthis._categoryChecks[name] = { check: check, context: context, cls: cls};\r\n\r\n\t\t\tthis.traverse(this.list, this);\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Checks if a category exists\r\n\t\t * @param {string} name [description]\r\n\t\t */\r\n\t\tpublic hasCategory (name:string){\r\n\t\t\treturn this._categoryLists[name] != null;\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Adds item into all category lists that it belongs to\r\n\t\t * @param {Item} item [description]\r\n\t\t */\r\n\t\tpublic list (item:Item){\r\n\t\t\tfor (var k in this._categoryLists) {\r\n\t\t\t\tvar data = this._categoryChecks[k];\r\n\t\t\t\tif (item instanceof data.cls && data.check.call(data.context, item)) {\r\n\t\t\t\t\tArrayUtil.include(item.id, this._categoryLists[k]);\r\n\t\t\t\t}\r\n\t\t\t}  \r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Removes item from all categories \r\n\t\t * @param {string} itemID [description]\r\n\t\t */\r\n\t\tpublic unlist (itemID:string){\r\n\t\t\tfor (var k in this._categoryLists) {\r\n\t\t\t\tfor (var i = 0; i < this._categoryLists[k].length; i++) {\r\n\t\t\t\t\tArrayUtil.remove(itemID, this._categoryLists[k]);\r\n\t\t\t\t}\r\n\t\t\t} \r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Returns the list of item ID's in a given category\r\n\t\t * @param {string} category [description]\r\n\t\t */\r\n\t\tpublic getItemsInCategory (category:string){\r\n\t\t\tvar items = this._categoryLists[category] || [];\r\n\r\n\t\t\tfor (var i = items.length - 1; i >= 0 && items.length > 0; i--) {\r\n\t\t\t\tvar item = this.getItem(items[i]);\r\n\t\t\t\tif (!item) {\r\n\t\t\t\t\titems.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn items; \r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Evaluates whether an item is listed in a specific category\r\n\t\t * @param  {string}  itemID   [description]\r\n\t\t * @param  {string}  category [description]\r\n\t\t */\r\n\t\tpublic isInCategory (itemID:string, category:string){\r\n\t\t\tvar list = this._categoryLists[category];\r\n\t\t\treturn list.indexOf(itemID) > -1;  \r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Traverses a category of items or all items in this database and executes a command on all of them\r\n\t\t * @param  {function} command  Command to execute on all items (\"function(item){//...}\")\r\n\t\t * @param  {object} context  'this' variable for the command\r\n\t\t * @param  {string} category Category to traverse. Traverses entire database if no category is specified\r\n\t\t */\r\n\t\tpublic traverse (command:any, context:any, category:string = null){\r\n\t\t\tvar list = this._categoryLists[category] || this._itemList;\r\n\r\n\t\t\tfor (var i = 0; i < list.length; i++) {\r\n\t\t\t\tvar item = this.getItem(list[i]);\r\n\r\n\t\t\t\tif (item) {\r\n\t\t\t\t\tcommand.call(context, item);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlist.splice(i, 1);\r\n\t\t\t\t\ti--;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\t/**\r\n\t\t * Creates an item and adds it to the database\r\n\t\t * @param {object} cls   Class of the item\r\n\t\t * @param {string} id     Item ID\r\n\t\t * @param {object} params Params to initialize the item\r\n\t\t * @return {object} Returns the item that was added\r\n\t\t */\r\n\t\tpublic create (cls:any, id:string, params?:any):Item{\r\n\t\t \tif(!id){\r\n\t\t \t\tid = \"item\" + this._itemCount  \r\n\t\t \t}\r\n\r\n\t\t\tif(this._items[id]){\r\n\t\t\t\tid = id + this._itemCount;\r\n\t\t\t}\r\n\r\n\t\t\tvar item = new cls(id, params);\r\n\r\n\t\t\titem.id = id;\r\n\r\n\t\t\tthis._items[id] = item;\r\n\t\t\tthis._itemList.push(item.id);\r\n\r\n\t\t\tthis.list(item);\r\n\r\n\t\t\tthis._itemCount++;\r\n\r\n\t\t\titem.signal = this.signal;\r\n\r\n\t\t\tthis.signal.dispatch(Database.ADDED, item.id);\r\n\t\t\treturn item; \r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Removes item from database\r\n\t\t * @param {string} itemID [description]\r\n\t\t */\r\n\t\tpublic remove (itemID:string){\r\n\t\t\tif (!this._items[itemID]) return;\r\n\t\t\tvar item = this.getItem(itemID);\r\n\t\t\t\r\n\t\t\tthis.unlist(itemID);\r\n\t\t\tdelete this._items[itemID]\r\n\t\t\tthis.signal.dispatch(Database.REMOVED, itemID);  \r\n\t\t};\r\n\r\n\r\n\t\t/**\r\n\t\t * Removes all items in database\r\n\t\t */\r\n\t\tpublic removeAll (){\r\n\t\t\tthis.traverse(function(item) { this.remove(item.id) }, this);\r\n\t\t};\r\n\r\n\t\t\r\n\t\t/**\r\n\t\t * Returns item in database\r\n\t\t * @param {string} itemID [description]\r\n\t\t */\r\n\t\tpublic getItem (itemID:string){\r\n\t\t\treturn this._items[itemID];\r\n\t\t};\r\n\r\n\t\tpublic clear (){\r\n\r\n\t\t}\r\n\r\n\t\tpublic destroy (){\r\n\r\n\t\t}\r\n    }\r\n}\t\t\t","module Animyst {\r\n    export class DataLoad {\r\n\r\n    \tstatic LOAD_INITIALIZE:number = 0;\r\n\t\tstatic LOAD_STARTED:number    = 1;\r\n\t\tstatic LOAD_PROGRESS:number   = 2;\r\n\t\tstatic LOAD_COMPLETE:number   = 3;\r\n\t\tstatic LOAD_ERROR:number      = 4;\r\n\t\tstatic FILE_STARTED:number    = 5;\r\n\t\tstatic FILE_PROGRESS:number   = 6;\r\n\t\tstatic FILE_LOADED:number     = 7;\r\n\t\tstatic FILE_ERROR:number      = 9;\r\n\r\n\r\n    \tstatic _assetList:any  = {};\r\n\t\tstatic _weakHandlers:any[] = []; // List of handlers to remove once the load is completed\r\n\t\tstatic _loadQueue:any  = null;   // CreateJS load queue\r\n\t\tstatic _loadSignal:Signal = null;\r\n\r\n\t\tstatic _fileStartedSignal:Signal  = null;\r\n\t\tstatic _fileProgressSignal:Signal = null;\r\n\t\tstatic _fileLoadedSignal:Signal   = null;\r\n\t\tstatic _fileErrorSignal:Signal    = null;\r\n\r\n\t\tstatic _queueStartedSignal:Signal  = null;\r\n\t\tstatic _queueProgressSignal:Signal = null;\r\n\t\tstatic _queueLoadedSignal:Signal   = null;\r\n\t\tstatic _queueErrorSignal:Signal    = null;\r\n\r\n\t\tstatic _busy:boolean = false;\r\n\r\n\t\tstatic LoadQueue:any;\r\n\r\n\t\tstatic startup(params):void{\r\n\t\t\tDataLoad.LoadQueue = window[\"createjs\"].LoadQueue;\r\n\t\t\tDataLoad._loadQueue  = new DataLoad.LoadQueue(true);\r\n\t\t\tDataLoad._loadSignal = new Signal();\r\n\r\n\t\t\tvar queue = DataLoad._loadQueue;\r\n\r\n\t\t\tqueue.on(\"fileload\",     DataLoad.handleFileLoaded);\r\n\t\t\tqueue.on(\"complete\",     DataLoad.handleLoadComplete);\r\n\t\t\tqueue.on(\"fileerror\",    DataLoad.handleFileError);\r\n\t\t\tqueue.on(\"error\",        DataLoad.handleLoaderError);\r\n\t\t\tqueue.on(\"filestart\",    DataLoad.handleFileStart);\r\n\t\t\tqueue.on(\"initialize\",   DataLoad.handleLoadInitialize);\r\n\t\t\tqueue.on(\"loadstart\",    DataLoad.handleLoadStart);\r\n\t\t\tqueue.on(\"fileprogress\", DataLoad.handleFileProgress);\r\n\t\t\tqueue.on(\"progress\",     DataLoad.handleOverallProgress);\r\n\r\n\t\t\tDataLoad._fileStartedSignal  = new Signal();;\r\n\t\t\tDataLoad._fileProgressSignal = new Signal();;\r\n\t\t\tDataLoad._fileLoadedSignal   = new Signal();;\r\n\t\t\tDataLoad._fileErrorSignal    = new Signal();;\r\n\r\n\t\t\tDataLoad._queueStartedSignal  = new Signal();;\r\n\t\t\tDataLoad._queueProgressSignal = new Signal();;\r\n\t\t\tDataLoad._queueLoadedSignal   = new Signal();;\r\n\t\t\tDataLoad._queueErrorSignal    = new Signal();;\r\n\r\n\r\n\t\t\tif(params.manifest != null){\r\n\t\t\t\t//DataLoad.loadManifest(params.manifest, params.callback)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tstatic listAssets(manifest):void{\r\n\t\t\tvar assetList = DataLoad._assetList;\r\n\t\t\tfor(var i = 0; i < manifest.length; i++){\r\n\t\t\t\tvar item = manifest[i];\r\n\t\t\t\tassetList[item.id] = item;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tstatic loadFromManifest(value:any, loadHandler?:any, persistant:boolean = false):void{\r\n\t\t\tvar queue     = DataLoad._loadQueue;\r\n\t\t\tvar manifest  = [];\r\n\t\t\tfor(var i = 0; i < value.length; i++){\r\n\t\t\t\tvar v = value[i];\r\n\t\t\t\tvar item;\r\n\r\n\t\t\t\tif(typeof v == \"string\"){\r\n\t\t\t\t\titem = {\"id\" : v, \"src\" : v};\r\n\t\t\t\t} else {\r\n\t\t\t\t\titem = {\"id\" : v.id, \"src\" :  v.src};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!DataLoad._assetList[item.id]){\r\n\t\t\t\t\tDataLoad._assetList[item.id] = item\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmanifest.push(DataLoad._assetList[item.id]);\r\n\t\t\t}\r\n\r\n\t\t\tDataLoad.addLoadHandler(loadHandler, persistant);\r\n\t\t\tDataLoad._busy = true;\r\n\t\t\tqueue.loadManifest(manifest)\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tstatic loadAsset(value:any, loadHandler?:any, persistant:boolean = false):void{\r\n\t\t\tvar queue = DataLoad._loadQueue;\r\n\t\t\tvar item; \r\n\r\n\t\t\tif(typeof value == \"string\"){\r\n\t\t\t\titem = {\"id\" : value, \"src\" : value};\r\n\t\t\t} else {\r\n\t\t\t\titem = {\"id\" : value.id, \"src\" : value.src};\r\n\t\t\t}\r\n\r\n\t\t\tif(!DataLoad._assetList[item.id]){\r\n\t\t\t\tDataLoad._assetList[item.id] = item\r\n\t\t\t}\r\n\r\n\t\t\tDataLoad.addLoadHandler(loadHandler, persistant);\r\n\t\t\tDataLoad._busy = true;\r\n\t\t\tqueue.loadFile(DataLoad._assetList[item.id]);\r\n\t\t}\r\n\r\n\t\tstatic getAsset(id):any{\r\n\t\t\treturn DataLoad._loadQueue.getResult(id);\r\n\t\t}\r\n\r\n\t\tstatic getData(id):any{\r\n\t\t\treturn DataLoad._assetList[id];\r\n\t\t}\r\n\r\n\r\n//=========== HANDLER MANAGEMENT =========\r\n\t\t\r\n\t\tstatic addLoadHandler(handler:any, persistant:boolean = false):void{\r\n\t\t\tif(!handler) return;\r\n\t\t\tif(!persistant){\r\n\t\t\t\tDataLoad._weakHandlers.push(handler);\r\n\t\t\t}\r\n\r\n\t\t\tDataLoad._loadSignal.add(handler);\r\n\t\t}\r\n\r\n\t\tstatic removeLoadHandler(handler:any):void{\r\n\t\t\tfor(var i = DataLoad._weakHandlers.length - 1; i >= 0 && DataLoad._weakHandlers.length > 0; i--){\r\n\t\t\t\tvar h = DataLoad._weakHandlers[i];\r\n\t\t\t\tif(h == handler){\r\n\t\t\t\t\tDataLoad._weakHandlers.splice(i, 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tDataLoad._loadSignal.remove(handler);\t\r\n\t\t}\r\n\r\n\t\tstatic removeWeakHandlers(handlers:any[]):void{\r\n\t\t\tvar loadSignal = DataLoad._loadSignal;\r\n\t\t\twhile(handlers.length > 0){\r\n\t\t\t\tvar handler = handlers.shift();\r\n\t\t\t\tDataLoad.removeLoadHandler(handler);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tstatic addCommand(commandID:number, command:any, addOnce:boolean = false):void{\r\n\t\t\tvar signal;\r\n\t\t\tswitch(commandID){\r\n\t\t\t\tcase DataLoad.LOAD_STARTED:\r\n\t\t\t\t\tsignal = DataLoad._queueStartedSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.FILE_STARTED:\r\n\t\t\t\t\tsignal = DataLoad._fileStartedSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.LOAD_PROGRESS:\r\n\t\t\t\t\tsignal = DataLoad._queueProgressSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.FILE_PROGRESS:\r\n\t\t\t\t\tsignal = DataLoad._fileProgressSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.LOAD_COMPLETE:\r\n\t\t\t\t\tsignal = DataLoad._queueLoadedSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.FILE_LOADED:\r\n\t\t\t\t\tsignal = DataLoad._fileLoadedSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.LOAD_ERROR:\r\n\t\t\t\t\tsignal = DataLoad._queueErrorSignal;\t\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.FILE_ERROR:\r\n\t\t\t\t\tsignal = DataLoad._fileErrorSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif(addOnce){\r\n\t\t\t\tsignal.addOnce(command);\r\n\t\t\t} else {\r\n\t\t\t\tsignal.add(command);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tstatic removeCommand(commandID:number, command:any):void{\r\n\t\t\tvar signal;\r\n\t\t\tswitch(commandID){\r\n\t\t\t\tcase DataLoad.LOAD_STARTED:\r\n\t\t\t\t\tsignal = DataLoad._queueStartedSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.FILE_STARTED:\r\n\t\t\t\t\tsignal = DataLoad._fileStartedSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.LOAD_PROGRESS:\r\n\t\t\t\t\tsignal = DataLoad._queueProgressSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.FILE_PROGRESS:\r\n\t\t\t\t\tsignal = DataLoad._fileProgressSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.LOAD_COMPLETE:\r\n\t\t\t\t\tsignal = DataLoad._queueLoadedSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.FILE_LOADED:\r\n\t\t\t\t\tsignal = DataLoad._fileLoadedSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.LOAD_ERROR:\r\n\t\t\t\t\tsignal = DataLoad._queueErrorSignal;\t\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DataLoad.FILE_ERROR:\r\n\t\t\t\t\tsignal = DataLoad._fileErrorSignal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tsignal.remove(command);\r\n\t\t}\r\n\r\n//=========== LOAD EVENTS =========\r\n\r\n\t\tstatic handleLoadInitialize(event:any):void{\r\n\t\t\tvar loadSignal = DataLoad._loadSignal;\r\n\t\t\tloadSignal.dispatch(DataLoad.LOAD_INITIALIZE, event)\r\n\t\t}\r\n\r\n\t\tstatic handleLoadStart(event:any):void{\r\n\t\t\tLog.output(\"[DataLoad] Load Started!\");\r\n\t\t\tvar loadSignal = DataLoad._loadSignal;\r\n\t\t\tloadSignal.dispatch(DataLoad.LOAD_STARTED, event);\r\n\t\t\tDataLoad._queueStartedSignal.dispatch(event);\r\n\t\t}\r\n\r\n\t\tstatic handleFileStart(event:any):void{\r\n\t\t\tLog.output(\"[DataLoad] Loading File:\", event.item.id, \"from:\", event.item.src);\r\n\t\t\tvar loadSignal = DataLoad._loadSignal;\r\n\t\t\tloadSignal.dispatch(DataLoad.FILE_STARTED, event)\r\n\t\t\tDataLoad._fileStartedSignal.dispatch(event);\r\n\t\t}\r\n\r\n\t\tstatic handleFileLoaded(event:any):void{\r\n\t\t\tLog.output(\"[DataLoad] File Loaded:\", event.item.id, \"from:\", event.item.src);\r\n\t\t\tvar loadSignal = DataLoad._loadSignal;\r\n\t\t\tloadSignal.dispatch(DataLoad.FILE_LOADED, event)\r\n\t\t\tDataLoad._fileLoadedSignal.dispatch(event);\r\n\t\t}\r\n\r\n\t\tstatic handleLoadComplete(event:any):void{\r\n\t\t\tLog.output(\"[DataLoad] Load Completed!\");\r\n\t\t\tvar loadSignal       = DataLoad._loadSignal;\r\n\t\t\tvar handlersToRemove = DataLoad._weakHandlers.concat();\r\n\r\n\t\t\tloadSignal.dispatch(DataLoad.LOAD_COMPLETE, event);\r\n\t\t\tDataLoad._queueLoadedSignal.dispatch(event);\r\n\t\t\tDataLoad.removeWeakHandlers(handlersToRemove);\r\n\t\t}\r\n\r\n\t\tstatic handleFileProgress(event:any):void{\r\n\t\t\tvar loadSignal = DataLoad._loadSignal;\r\n\t\t\tloadSignal.dispatch(DataLoad.FILE_PROGRESS, event);\r\n\t\t\tDataLoad._fileProgressSignal.dispatch(event);\r\n\t\t}\r\n\r\n\t\tstatic handleOverallProgress(event:any):void{\r\n\t\t\tvar loadSignal = DataLoad._loadSignal;\r\n\t\t\tloadSignal.dispatch(DataLoad.LOAD_PROGRESS, event);\r\n\t\t\tDataLoad._queueProgressSignal.dispatch(event);\r\n\t\t}\r\n\r\n\t\tstatic handleFileError(event:any):void{\r\n\t\t\tvar loadSignal = DataLoad._loadSignal;\r\n\t\t\tloadSignal.dispatch(DataLoad.FILE_ERROR, event);\r\n\t\t\tDataLoad._fileErrorSignal.dispatch(event);\r\n\t\t}\r\n\r\n\t\tstatic handleLoaderError(event:any):void{\r\n\t\t\tvar loadSignal = DataLoad._loadSignal;\r\n\t\t\tloadSignal.dispatch(DataLoad.LOAD_ERROR, event);\r\n\t\t\tDataLoad._queueErrorSignal.dispatch(event);\r\n\t\t}\r\n\r\n\r\n    \tconstructor(argument) {\r\n    \t\t// code...\r\n    \t}\r\n    }\r\n}","module Animyst {\r\n    export class Environment {\r\n\r\n    \t//========================================\r\n\t\t//------------- Platform -----------------\r\n\t\t//========================================\r\n\r\n\t\tstatic isDesktop:boolean  = false;\r\n\t\tstatic isMobile:boolean   = false;\r\n\t\tstatic isIOS:boolean      = false;\r\n\t\tstatic isAndroid:boolean  = false;\r\n\t\tstatic isChromeOS:boolean = false;\r\n\t\tstatic isMacOS:boolean    = false;\r\n\t\tstatic isWindows:boolean  = false;\r\n\t\tstatic isLinux:boolean    = false;\r\n\r\n\t\tstatic platformName:string = \"\";\r\n\r\n\r\n\r\n\t\t//========================================\r\n\t\t//------------- Device -------------------\r\n\t\t//========================================\r\n\r\n\t\tstatic pixelRatio:number   = 1;\r\n\t\tstatic colorDepth:number   = -1;\r\n\t\tstatic screenWidth:number  = -1;\r\n\t\tstatic screenHeight:number = -1;\r\n\r\n\t\t//========================================\r\n\t\t//------------- Browser ------------------\r\n\t\t//========================================\r\n\r\n\t\tstatic isChrome:boolean   = false;\r\n\t\tstatic isFirefox:boolean  = false;\r\n\t\tstatic isIE:boolean       = false;\r\n\t\tstatic isEdge:boolean     = false;\r\n\t\tstatic isSafari:boolean   = false;\r\n\t\tstatic isWebApp:boolean   = false;\r\n\t\tstatic isCocoonJS:boolean = false;\r\n\r\n\t\tstatic browserVersion:string = \"\";\r\n\t\tstatic browserName:string    = \"\";\r\n\t\tstatic browserDetails:any    = {};\r\n\r\n\t\tstatic url:string         = \"\";\r\n\t\tstatic host:string        = \"\";\r\n\t\tstatic path:string        = \"\";\r\n\t\tstatic port:string        = \"\";\r\n\t\tstatic queryString:string = \"\";\r\n\r\n\t\t//========================================\r\n\r\n\t\tstatic _setup():void{\r\n\t\t\tEnvironment._checkBrowser();\r\n\t\t\tEnvironment._checkPlatform();\r\n\t\t\tEnvironment._checkDevice();\r\n\t\t}\r\n\r\n\t\tstatic _checkPlatform():void{\r\n\t\t\tvar userAgent = navigator.userAgent;\r\n\r\n\t\t\tif(/Linux/.test(userAgent)){\r\n\t\t\t\tEnvironment.platformName = \"Linux\";\r\n\t\t\t\tEnvironment.isLinux = true;\r\n\t\t\t}\r\n\r\n\t\t\tif(/Android/.test(userAgent)){\r\n\t\t\t\tEnvironment.platformName = \"Android\";\r\n\t\t\t\tEnvironment.isAndroid = true;\r\n\t\t\t}\r\n\r\n\t\t\tif(/CrOS/.test(userAgent)){\r\n\t\t\t\tEnvironment.platformName = \"ChromeOS\";\r\n\t\t\t\tEnvironment.isChromeOS = true;\r\n\t\t\t}\r\n\r\n\t\t\tif(/iP[ao]d|iPhone/i.test(userAgent)){\r\n\t\t\t\tEnvironment.platformName = \"iOS\";\r\n\t\t\t\tEnvironment.isIOS = true;\r\n\t\t\t}\r\n\r\n\t\t\tif(/Mac OS/.test(userAgent)){\r\n\t\t\t\tEnvironment.platformName = \"Mac\";\r\n\t\t\t\tEnvironment.isMacOS = true;\r\n\t\t\t}\r\n\r\n\t\t\tif(/Windows/.test(userAgent)){\r\n\t\t\t\tEnvironment.platformName = \"Windows\";\r\n\t\t\t\tEnvironment.isWindows = true;\r\n\t\t\t}\r\n\r\n\t\t\tif(Environment.isWindows || Environment.isMacOS || Environment.isLinux){\r\n\t\t\t\tEnvironment.isDesktop = true;\r\n\t\t\t}\r\n\r\n\t\t\tif(Environment.isAndroid || Environment.isIOS || Environment.isWebApp){\r\n\t\t\t\tEnvironment.isMobile = true;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tstatic _checkDevice():void{\r\n\t\t\tEnvironment.pixelRatio = window.devicePixelRatio || 1;\r\n\t\t\tEnvironment.colorDepth = window.screen.colorDepth;\r\n\r\n\t\t\tif(Environment.isMobile){\r\n\t\t\t\tEnvironment.screenWidth  = window.screen.width  * Environment.pixelRatio;\r\n\t\t\t\tEnvironment.screenHeight = window.screen.height * Environment.pixelRatio;\r\n\t\t\t} else {\r\n\t\t\t\tEnvironment.screenWidth  = window.screen.width;\r\n\t\t\t\tEnvironment.screenHeight = window.screen.height;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tstatic _checkBrowser():void{\r\n\t\t\tvar userAgent = navigator.userAgent;\r\n\r\n\t\t\tif(/Safari/.test(userAgent)){\r\n\t\t\t\tEnvironment.browserName = \"Safari\";\r\n\t\t\t\tEnvironment.isSafari = true;\r\n\t\t\t\tEnvironment.browserVersion = (userAgent.indexOf(\"Version\") !=-1) ? userAgent.substring(userAgent.indexOf(\"Version\") + 8) : userAgent.substring(userAgent.indexOf(\"Safari\") + 7);\r\n\t\t\t}\r\n\r\n\t\t\tif(/Mobile(.*)Safari/.test(userAgent)){\r\n\t\t\t\tEnvironment.browserName = \"MobileSafari\";\r\n\t\t\t\tEnvironment.isSafari = true;\r\n\t\t\t\tEnvironment.browserVersion = (userAgent.indexOf(\"Version\") !=-1) ? userAgent.substring(userAgent.indexOf(\"Version\") + 8) : userAgent.substring(userAgent.indexOf(\"Safari\") + 7);\r\n\t\t\t}\r\n\r\n\t\t\tif(/Chrome/.test(userAgent)){\r\n\t\t\t\tEnvironment.browserName = \"Chrome\";\r\n\t\t\t\tEnvironment.isChrome = true;\r\n\t\t\t\tEnvironment.browserVersion = userAgent.substring(userAgent.indexOf(\"Chrome\") + 7, userAgent.indexOf(\" Safari\") || null);\r\n\t\t\t}\r\n\r\n\t\t\tif(/Firefox/.test(userAgent)){\r\n\t\t\t\tEnvironment.browserName = \"Firefox\";\r\n\t\t\t\tEnvironment.isFirefox = true;\r\n\t\t\t\tEnvironment.browserVersion = userAgent.substring(userAgent.indexOf(\"Firefox\") + 8);\r\n\t\t\t}\r\n\r\n\t\t\tif(/MSIE (\\d+\\.\\d+);/.test(userAgent)){\r\n\t\t\t\tEnvironment.browserName = \"MSIE\";\r\n\t\t\t\tEnvironment.isIE = true;\r\n\t\t\t\tEnvironment.browserVersion = userAgent.substring(userAgent.indexOf(\"MSIE\") + 5);\r\n\t\t\t}\r\n\r\n\t\t\tif(/Edge/.test(userAgent)){\r\n\t\t\t\tEnvironment.browserName = \"MSEdge\";\r\n\t\t\t\tEnvironment.isEdge = true;\r\n\t\t\t\tEnvironment.browserVersion = userAgent.substring(userAgent.indexOf(\"Edge\") + 5);\r\n\t\t\t}\r\n\r\n\t\t\tif(navigator['standalone']){\r\n\t\t\t\tEnvironment.browserName = \"WebApp\";\r\n\t\t\t\tEnvironment.isWebApp = true;\r\n\t\t\t}\r\n\r\n\t\t\tif(navigator['isCocoonJS']){\r\n\t\t\t\tEnvironment.browserName = \"CocoonJS\";\r\n\t\t\t\tEnvironment.isCocoonJS = true;\r\n\t\t\t}\r\n\r\n\r\n\t\t\tEnvironment.url = window.location.href;\r\n\t\t\tEnvironment.queryString = window.location.search;\r\n\t\t\tEnvironment.host = window.location.hostname;\r\n\t\t\tEnvironment.path = window.location.pathname;\r\n\t\t\tEnvironment.port = window.location.port;\r\n\r\n\t\t\tvar details = Environment.browserVersion.split(\".\");\r\n\t\t\tswitch(details.length){\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tEnvironment.browserDetails.major = parseInt(details[0]);\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tEnvironment.browserDetails.major = parseInt(details[0]);\r\n\t\t\t\t\tEnvironment.browserDetails.minor = parseInt(details[1]);\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tEnvironment.browserDetails.major = parseInt(details[0]);\r\n\t\t\t\t\tEnvironment.browserDetails.minor = parseInt(details[1]);\r\n\t\t\t\t\tEnvironment.browserDetails.build = parseInt(details[2]);\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tEnvironment.browserDetails.major = parseInt(details[0]);\r\n\t\t\t\t\tEnvironment.browserDetails.minor = parseInt(details[1]);\r\n\t\t\t\t\tEnvironment.browserDetails.build = parseInt(details[2]);\r\n\t\t\t\t\tEnvironment.browserDetails.revision = parseInt(details[3]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tstatic getURLParameterByName(name:string, escapeSpaces:boolean= false){\r\n\t\t\tif(escapeSpaces === null) escapeSpaces = true;\r\n\t\t\tvar match = new RegExp('[?&]' + name + '=([^&]*)').exec(Environment.queryString);\r\n\t\t\treturn (escapeSpaces) ? match && decodeURIComponent(match[1].replace(/\\/+/g, '')) : match && decodeURIComponent(match[1]);\r\n\t\t}\r\n    \t\r\n    \tconstructor(argument) {\r\n    \t\t// code...\r\n    \t}\r\n    }\r\n}","module Animyst {\r\n    export class Item {\r\n    \t\r\n    \tpublic id:string;\r\n    \tpublic startParams:any;\r\n\r\n    \tconstructor(id:string, params:any) {\r\n    \t\t// code...\r\n    \t\tthis.id = id;\r\n    \t\tthis.startParams = params;\r\n    \t\tthis.setup(params);\r\n    \t}\r\n\r\n    \tpublic setup(params:any):void{\r\n    \t}\r\n\r\n    \tpublic reset():void{\r\n    \t\tthis.setup(this.startParams);\r\n    \t}\r\n\r\n    \tpublic destroy():void{\r\n    \t\tthis.startParams = null;\r\n    \t}\r\n    }\r\n}\t\t\t","module Animyst {\r\n    export class Log {\r\n    \t\r\n\r\n    \tstatic output(...args):void{\r\n\t\t\tif(!LOGGING) return;\r\n\r\n\t\t\tvar logData = [];\r\n\r\n\t\t\tlogData.push(\":[LOG]:\");\r\n\r\n\t\t\tfor(var i = 0; i < args.length; i++){\r\n\t\t\t\tlogData.push(args[i]);\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log.apply(console, logData);\r\n\t\t}\r\n\r\n\t\tstatic error(...args):void{\r\n\t\t\tif(!LOGGING) return;\r\n\r\n\r\n\t\t\tvar logData = [];\r\n\r\n\t\t\tlogData.push(\":[ERROR]:\");\r\n\r\n\t\t\tfor(var i = 0; i < args.length; i++){\r\n\t\t\t\tlogData.push(args[i]);\r\n\t\t\t}\r\n\r\n\t\t\tconsole.error.apply(console, logData);\r\n\t\t}\r\n\r\n    \tconstructor() {\r\n    \t}\r\n    }\r\n}","/// <reference path=\"Signal.ts\" />\n\n/*\n*\t@desc   \tAn object that represents a binding between a Signal and a listener function.\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.kiwijs.org\n*\n*/\n\nmodule Animyst\n{\n\texport class SignalBinding\n\t{\n\t\t/**\n\t\t* Handler function bound to the signal.\n\t\t* @type Function\n\t\t* @private\n\t\t*/\n\t\tprivate _listener:any;\n\n\t\t/**\n\t\t* If binding should be executed just once.\n\t\t* @type boolean\n\t\t* @private\n\t\t*/\n\t\tprivate _isOnce:boolean;\n\n\t\t/**\n\t\t* Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n\t\t* @memberOf SignalBinding.prototype\n\t\t* @name context\n\t\t* @type Object|undefined|null\n\t\t*/\n\t\tpublic context:any;\n\n\t\t/**\n\t\t* Reference to Signal object that listener is currently bound to.\n\t\t* @type Signal\n\t\t* @private\n\t\t*/\n\t\tprivate _signal:Signal;\n\n\t\t/**\n\t\t* Listener priority\n\t\t* @type Number\n\t\t*/\n\t\tpublic priority:number;\n\n\t\t/**\n\t\t* If binding is active and should be executed.\n\t\t* @type boolean\n\t\t*/\n\t\tpublic active:boolean = true;\n\n\t\t/**\n\t\t* Default parameters passed to listener during `Signal.dispatch` and `SignalBinding.execute`. (curried parameters)\n\t\t* @type Array|null\n\t\t*/\n\t\tpublic params:any[] = null;\n\n\t\t/**\n\t\t* Object that represents a binding between a Signal and a listener function.\n\t\t* <br />- <strong>This is an internal constructor and shouldn't be called by regular users.</strong>\n\t\t* <br />- inspired by Joa Ebert AS3 SignalBinding and Robert Penner's Slot classes.\n\t\t* @author Miller Medeiros\n\t\t* @constructor\n\t\t* @internal\n\t\t* @name SignalBinding\n\t\t* @param {Signal} signal Reference to Signal object that listener is currently bound to.\n\t\t* @param {Function} listener Handler function bound to the signal.\n\t\t* @param {boolean} isOnce If binding should be executed just once.\n\t\t* @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n\t\t* @param {Number} [priority] The priority level of the event listener. (default = 0).\n\t\t*/\n\t\tconstructor(signal:Signal, listener:any, isOnce:boolean, listenerContext:any, priority:number = 0)\n\t\t{\n\n\t\t\tthis._listener = listener;\n\t\t\tthis._isOnce = isOnce;\n\t\t\tthis.context = listenerContext;\n\t\t\tthis._signal = signal;\n\t\t\tthis.priority = priority || 0;\n\n\t\t}\n\n\t\t/**\n\t\t* Call listener passing arbitrary parameters.\n\t\t* <p>If binding was added using `Signal.addOnce()` it will be automatically removed from signal dispatch queue, this method is used internally for the signal dispatch.</p>\n\t\t* @param {Array} [paramsArr] Array of parameters that should be passed to the listener\n\t\t* @return {*} Value returned by the listener.\n\t\t*/\n\t\tpublic execute(paramsArr?:any[])\n\t\t{\n\t\t\tvar handlerReturn;\n\t\t\tvar params;\n\n\t\t\tif (this.active && !!this._listener)\n\t\t\t{\n\t\t\t\tparams = this.params ? this.params.concat(paramsArr) : paramsArr;\n\n\t\t\t\thandlerReturn = this._listener.apply(this.context, params);\n\n\t\t\t\tif (this._isOnce)\n\t\t\t\t{\n\t\t\t\t\tthis.detach();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn handlerReturn;\n\t\t}\n\n\t\t/**\n\t\t* Detach binding from signal.\n\t\t* - alias to:mySignal.remove(myBinding.getListener());\n\t\t* @return {Function|null} Handler function bound to the signal or `null` if binding was previously detached.\n\t\t*/\n\t\tpublic detach()\n\t\t{\n\t\t\treturn this.isBound() ? this._signal.remove(this._listener, this.context) : null;\n\t\t}\n\n\t\t/**\n\t\t* @return {Boolean} `true` if binding is still bound to the signal and have a listener.\n\t\t*/\n\t\tpublic isBound():boolean\n\t\t{\n\t\t\treturn (!!this._signal && !!this._listener);\n\t\t}\n\n\t\t/**\n\t\t* @return {boolean} If SignalBinding will only be executed once.\n\t\t*/\n\t\tpublic isOnce():boolean\n\t\t{\n\t\t\treturn this._isOnce;\n\t\t}\n\n\t\t/**\n\t\t* @return {Function} Handler function bound to the signal.\n\t\t*/\n\t\tpublic getListener():any\n\t\t{\n\t\t\treturn this._listener;\n\t\t}\n\n\t\t/**\n\t\t* @return {Signal} Signal that listener is currently bound to.\n\t\t*/\n\t\tpublic getSignal():any\n\t\t{\n\t\t\treturn this._signal;\n\t\t}\n\n\t\t/**\n\t\t* Delete instance properties\n\t\t* @private\n\t\t*/\n\t\tpublic _destroy():void\n\t\t{\n\t\t\tdelete this._signal;\n\t\t\tdelete this._listener;\n\t\t\tdelete this.context;\n\t\t}\n\n\t\t/**\n\t\t* @return {string} String representation of the object.\n\t\t*/\n\t\tpublic toString():string\n\t\t{\n\t\t\treturn '[SignalBinding isOnce:' + this._isOnce + ', isBound:' + this.isBound() + ', active:' + this.active + ']';\n\t\t}\n\n\t}\n}","/// <reference path=\"SignalBinding.ts\" />\n\n/**\n*\t@desc       A TypeScript conversion of JS Signals by Miller Medeiros\n*               Released under the MIT license\n*\t\t\t\thttp://millermedeiros.github.com/js-signals/\n*\n*\t@version\t1.0 - 7th March 2013\n*\n*\t@author \tRichard Davey, TypeScript conversion\n*\t@author\t\tMiller Medeiros, JS Signals\n*\t@author\t\tRobert Penner, AS Signals\n*\n*\t@url\t\thttp://www.photonstorm.com\n*/\n\n/**\n* Custom event broadcaster\n* <br />- inspired by Robert Penner's AS3 Signals.\n* @name Signal\n* @author Miller Medeiros\n* @constructor\n*/\n\nmodule Animyst\n{\n\texport class Signal {\n\n\t\t/**\n\t\t* @property _bindings\n\t\t* @type Array\n\t\t* @private\n\t\t*/\n\t\tprivate _bindings:SignalBinding[] = [];\n\n\t\t/**\n\t\t* @property _prevParams\n\t\t* @type Any\n\t\t* @private\n\t\t*/\n\t\tprivate _prevParams = null;\n\n\t\t/**\n\t\t* Signals Version Number\n\t\t* @property VERSION\n\t\t* @type String\n\t\t* @const\n\t\t*/\n\t\tpublic static VERSION:string = '1.0.0';\n\n\t\t/**\n\t\t* If Signal should keep record of previously dispatched parameters and\n\t\t* automatically execute listener during `add()`/`addOnce()` if Signal was\n\t\t* already dispatched before.\n\t\t* @type boolean\n\t\t*/\n\t\tpublic memorize:boolean = false;\n\n\t\t/**\n\t\t* @type boolean\n\t\t* @private\n\t\t*/\n\t\tprivate _shouldPropagate:boolean = true;\n\n\t\t/**\n\t\t* If Signal is active and should broadcast events.\n\t\t* <p><strong>IMPORTANT:</strong> Setting this property during a dispatch will only affect the next dispatch, if you want to stop the propagation of a signal use `halt()` instead.</p>\n\t\t* @type boolean\n\t\t*/\n\t\tpublic active:boolean = true;\n\n\t\t/**\n\t\t* @method validateListener\n\t\t* @param {Any} listener\n\t\t* @param {Any} fnName\n\t\t*/\n\t\tpublic validateListener(listener, fnName) {\n\n\t\t\tif (typeof listener !== 'function')\n\t\t\t{\n\t\t\t\tthrow new Error('listener is a required param of {fn}() and should be a Function.'.replace('{fn}', fnName));\n\t\t\t}\n\n\t\t}\n\n\t\t/**\n\t\t* @param {Function} listener\n\t\t* @param {boolean} isOnce\n\t\t* @param {Object} [listenerContext]\n\t\t* @param {Number} [priority]\n\t\t* @return {SignalBinding}\n\t\t* @private\n\t\t*/\n\t\tprivate _registerListener(listener, isOnce:boolean, listenerContext, priority:number):SignalBinding {\n\n\t\t\tvar prevIndex:number = this._indexOfListener(listener, listenerContext);\n\t\t\tvar binding:SignalBinding;\n\n\t\t\tif (prevIndex !== -1)\n\t\t\t{\n\t\t\t\tbinding = this._bindings[prevIndex];\n\n\t\t\t\tif (binding.isOnce() !== isOnce)\n\t\t\t\t{\n\t\t\t\t\tthrow new Error('You cannot add' + (isOnce ? '' :'Once') + '() then add' + (!isOnce ? '' :'Once') + '() the same listener without removing the relationship first.');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbinding = new SignalBinding(this, listener, isOnce, listenerContext, priority);\n\n\t\t\t\tthis._addBinding(binding);\n\t\t\t}\n\n\t\t\tif (this.memorize && this._prevParams)\n\t\t\t{\n\t\t\t\tbinding.execute(this._prevParams);\n\t\t\t}\n\n\t\t\treturn binding;\n\n\t\t}\n\n\t\t/**\n\t\t* @method _addBinding\n\t\t* @param {SignalBinding} binding\n\t\t* @private\n\t\t*/\n\t\tprivate _addBinding(binding:SignalBinding) {\n\n\t\t\t//simplified insertion sort\n\n\t\t\tvar n:number = this._bindings.length;\n\n\t\t\tdo { --n; } while (this._bindings[n] && binding.priority <= this._bindings[n].priority);\n\n\t\t\tthis._bindings.splice(n + 1, 0, binding);\n\n\t\t}\n\n\t\t/**\n\t\t* @method _indexOfListener\n\t\t* @param {Function} listener\n\t\t* @return {number}\n\t\t* @private\n\t\t*/\n\t\tprivate _indexOfListener(listener, context):number {\n\n\t\t\tvar n:number = this._bindings.length;\n\t\t\tvar cur:SignalBinding;\n\n\t\t\twhile (n--)\n\t\t\t{\n\t\t\t\tcur = this._bindings[n];\n\n\t\t\t\tif (cur.getListener() === listener && cur.context === context)\n\t\t\t\t{\n\t\t\t\t\treturn n;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn -1;\n\n\t\t}\n\n\t\t/**\n\t\t* Check if listener was attached to Signal.\n\t\t* @param {Function} listener\n\t\t* @param {Object} [context]\n\t\t* @return {boolean} if Signal has the specified listener.\n\t\t*/\n\t\tpublic has(listener, context?:any):boolean {\n\n\t\t\treturn this._indexOfListener(listener, context) !== -1;\n\n\t\t}\n\n\t\t/**\n\t\t* Add a listener to the signal.\n\t\t* @param {Function} listener Signal handler function.\n\t\t* @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n\t\t* @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n\t\t* @return {SignalBinding} An Object representing the binding between the Signal and listener.\n\t\t*/\n\t\tpublic add(listener, listenerContext?:any, priority:number = 0):SignalBinding {\n\n\t\t\tthis.validateListener(listener, 'add');\n\n\t\t\treturn this._registerListener(listener, false, listenerContext, priority);\n\n\t\t}\n\n\t\t/**\n\t\t* Add listener to the signal that should be removed after first execution (will be executed only once).\n\t\t* @param {Function} listener Signal handler function.\n\t\t* @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n\t\t* @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n\t\t* @return {SignalBinding} An Object representing the binding between the Signal and listener.\n\t\t*/\n\t\tpublic addOnce(listener, listenerContext?:any, priority:number = 0):SignalBinding {\n\n\t\t\tthis.validateListener(listener, 'addOnce');\n\n\t\t\treturn this._registerListener(listener, true, listenerContext, priority);\n\n\t\t}\n\n\t\t/**\n\t\t* Remove a single listener from the dispatch queue.\n\t\t* @param {Function} listener Handler function that should be removed.\n\t\t* @param {Object} [context] Execution context (since you can add the same handler multiple times if executing in a different context).\n\t\t* @return {Function} Listener handler function.\n\t\t*/\n\t\tpublic remove(listener, context?:any) {\n\n\t\t\tthis.validateListener(listener, 'remove');\n\n\t\t\tvar i:number = this._indexOfListener(listener, context);\n\n\t\t\tif (i !== -1)\n\t\t\t{\n\t\t\t\tthis._bindings[i]._destroy(); //no reason to a SignalBinding exist if it isn't attached to a signal\n\t\t\t\tthis._bindings.splice(i, 1);\n\t\t\t}\n\n\t\t\treturn listener;\n\n\t\t}\n\n\t\t/**\n\t\t* Remove all listeners from the Signal.\n\t\t*/\n\t\tpublic removeAll() {\n\n\t\t\tvar n:number = this._bindings.length;\n\n\t\t\twhile (n--)\n\t\t\t{\n\t\t\t\tthis._bindings[n]._destroy();\n\t\t\t}\n\n\t\t\tthis._bindings.length = 0;\n\n\t\t}\n\n\t\t/**\n\t\t* @return {number} Number of listeners attached to the Signal.\n\t\t*/\n\t\tpublic getNumListeners():number {\n\n\t\t\treturn this._bindings.length;\n\n\t\t}\n\n\t\t/**\n\t\t* Stop propagation of the event, blocking the dispatch to next listeners on the queue.\n\t\t* <p><strong>IMPORTANT:</strong> should be called only during signal dispatch, calling it before/after dispatch won't affect signal broadcast.</p>\n\t\t* @see Signal.prototype.disable\n\t\t*/\n\t\tpublic halt() {\n\n\t\t\tthis._shouldPropagate = false;\n\n\t\t}\n\n\t\t/**\n\t\t* Dispatch/Broadcast Signal to all listeners added to the queue.\n\t\t* @param {...*} [params] Parameters that should be passed to each handler.\n\t\t*/\n\t\tpublic dispatch(...paramsArr:any[]) {\n\n\t\t\tif (!this.active)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar n:number = this._bindings.length;\n\t\t\tvar bindings:SignalBinding[];\n\n\t\t\tif (this.memorize)\n\t\t\t{\n\t\t\t\tthis._prevParams = paramsArr;\n\t\t\t}\n\n\t\t\tif (!n)\n\t\t\t{\n\t\t\t\t//should come after memorize\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tbindings = this._bindings.slice(0); //clone array in case add/remove items during dispatch\n\n\t\t\tthis._shouldPropagate = true; //in case `halt` was called before dispatch or during the previous dispatch.\n\n\t\t\t//execute all callbacks until end of the list or until a callback returns `false` or stops propagation\n\t\t\t//reverse loop since listeners with higher priority will be added at the end of the list\n\t\t\tdo { n--; } while (bindings[n] && this._shouldPropagate && bindings[n].execute(paramsArr) !== false);\n\n\t\t}\n\n\t\t/**\n\t\t* Forget memorized arguments.\n\t\t* @see Signal.memorize\n\t\t*/\n\t\tpublic forget() {\n\n\t\t\tthis._prevParams = null;\n\n\t\t}\n\n\t\t/**\n\t\t* Remove all bindings from signal and destroy any reference to external objects (destroy Signal object).\n\t\t* <p><strong>IMPORTANT:</strong> calling any method on the signal instance after calling dispose will throw errors.</p>\n\t\t*/\n\t\tpublic dispose() {\n\n\t\t\tthis.removeAll();\n\n\t\t\tdelete this._bindings;\n\t\t\tdelete this._prevParams;\n\n\t\t}\n\n\t\t/**\n\t\t* @return {string} String representation of the object.\n\t\t*/\n\t\tpublic toString():string {\n\n\t\t\treturn '[Signal active:' + this.active + ' numListeners:' + this.getNumListeners() + ']';\n\n\t\t}\n\n\t}\n}\n","module Animyst {\r\n    export class System {\r\n\r\n    \tprotected _paused:boolean;\r\n    \tpublic get paused():boolean{return this._paused};\r\n\r\n    \tprotected _started:boolean;\r\n    \tpublic get started():boolean{return this._started};\r\n\r\n    \tprivate _startupParams:any;\r\n\r\n\r\n\t\tpublic startup(params?:any):void{\r\n\t\t\tthis._started = true;\r\n\t\t\tthis._startupParams = params;\r\n\t\t}\r\n\r\n\t\tpublic shutdown():void{\r\n\t\t\tthis._started = false;\r\n\r\n\t\t}\r\n\r\n\t\tpublic update(delta:number, framecount:number):void{\r\n\r\n\t\t}\r\n\r\n\t\tpublic fixedUpdate(timestep:number, time:number):void{\r\n\r\n\t\t}\r\n\r\n\r\n    \tconstructor() {\r\n    \t}\r\n    }\r\n}","module Animyst {\r\n    export class View3D extends Database {\r\n    \t\r\n    \tpublic viewAngle:number;\r\n    \tpublic near:number;\r\n    \tpublic far:number;\r\n    \t\r\n    \tprivate _scene:THREE.Scene;\r\n    \tprivate _renderer:THREE.WebGLRenderer;\r\n    \tprivate _camera:THREE.Camera;\r\n    \tprivate _container:any;\r\n    \tprivate _settings:any;\r\n    \tprivate _resize:boolean;\r\n    \tprivate _ui:any;\r\n    \tprivate _view:any;\r\n    \tprivate _context2d:CanvasRenderingContext2D;\r\n\r\n    \tpublic get aspect():number{ return this.width / this.height};\r\n\r\n\r\n    \tpublic width:number;\r\n    \tpublic height:number;\r\n\r\n\r\n\r\n    \tconstructor() {\r\n    \t\tsuper();\r\n    \t}\r\n\r\n\t\tpublic clear():void{\r\n\r\n\t\t\tDatabase.prototype.clear.call(this);\r\n\t\t}\r\n\r\n\t\tpublic destroy():void{\r\n\r\n\t\t\tDatabase.prototype.destroy.call(this);\r\n\t\t}\r\n\r\n\t\tpublic initDisplay(params:any):void{\r\n\t\t\tif(!params){\r\n\t\t\t\tLog.error(\"[View3D] No initialization params specified\");\r\n\t\t\t \treturn;\t\r\n\t\t\t} \r\n\r\n\t\t\tthis.viewAngle = params.viewAngle || this.viewAngle;\r\n\t\t\tthis.near = params.near || this.near;\r\n\t\t\tthis.far = params.far || this.far;\r\n\t\t\tthis._resize = params.resize;\r\n\r\n\t\t\tthis._scene    = this._scene || new THREE.Scene();\r\n\t\t\tthis._renderer = new THREE.WebGLRenderer();\r\n\t\t\tthis._camera   = new THREE.PerspectiveCamera(this.viewAngle, this.aspect, this.near, this.far);\r\n\r\n\t\t\tthis._scene.add(this._camera);\r\n\r\n\t\t\tthis._camera.lookAt(this._scene.position);\r\n\r\n\t\t\tif(params.container){\r\n\t\t\t\tvar container = document.getElementById(params.container);\r\n\t\t\t\tif(container)\t{\r\n\t\t\t\t\tcontainer.appendChild(this._renderer.domElement);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tLog.error(\"[View3D] Container ID\", params.container, \"doesn't exist\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._camera.position.x = params.cameraX || 500;\r\n\t\t\tthis._camera.position.y = params.cameraY || 500;\r\n\t\t\tthis._camera.position.z = params.cameraZ || 500;\r\n\r\n\t\t\tthis._camera.lookAt(this._scene.position);\r\n\r\n\t\t\tthis._renderer.setClearColor(params.rendererColor || 0x888888);\r\n\t\t\tthis._renderer.setSize(this.width, this.height);\r\n\t\t\t//this._renderer.shadowMapEnabled = false;\r\n\r\n\t\t\t/*var geom = new THREE.PlaneGeometry(this.width, this.height, 32 );\r\n\t\t\tvar texture = new PIXITexture(new PIXI.Stage(0xFFFFFF), new PIXI.WebGLRenderer(this.width, this.height, {transparent : true}));\r\n\t\t\tvar matr = new THREE.MeshBasicMaterial({map:texture, side:THREE.DoubleSide});\r\n\t\t\tmatr.transparent = true;\r\n\t\t\tthis.ui = new THREE.Mesh( geom, matr);\r\n\r\n\t\t\tlet vFOV = this.camera.fov * (Math.PI / 180);\r\n\t\t\tlet distance =  this.height / (2 * Math.tan(vFOV / 2));\r\n\r\n\t\t\tthis.ui.position.set(0,0, -distance);\r\n\t\t\tthis.scene.add(this.ui);\r\n\r\n\t\t\tthis.camera.add(this.ui);*/\r\n\r\n\r\n\t\t\t/*this.stage    = new PIXI.Stage(0xFFFFFF);\r\n\t\t\tthis.uiRenderer = new PIXI.WebGLRenderer(this.width, this.height, {transparent : true});\r\n\r\n\t\t\tthis.image = this.renderer.view;\r\n\r\n\t\t\tlet graphics = new PIXI.Graphics();\r\n\t\t\tgraphics.lineStyle(2, 0xFF00FF, 1);\r\n\t\t\tgraphics.beginFill(0xFF00BB, 0.25);\r\n\t\t\tgraphics.drawCircle(this.width/2, this.height/2, 100, 100);\r\n\t\t\tgraphics.endFill();\r\n\r\n\t\t\tlet texture = PIXI.Texture.fromCanvas(DataLoad.getAsset('samusftilt'));\r\n\t\t\tlet sprite = new PIXI.Sprite(texture);\r\n\t\t\tthis.stage.addChild(sprite);\r\n\r\n\t\t\tthis.stage.addChild(graphics);\r\n\r\n\t\t \tthis.uiRenderer.render(this.stage);*/\r\n\r\n\t\t\tif(params.addAxis){\r\n\t\t\t\tvar axis = new THREE.AxisHelper(20);\r\n\t\t\t\tthis._scene.add(axis);\r\n\t\t\t}\r\n\r\n\t\t\tif(params.debugControls){\r\n\t\t\t\tvar controls = new THREE.OrbitControls(this._camera);\r\n\r\n\t\t\t\tif(GUI){\r\n\t\t\t\t\tvar displayControls = GUI.addFolder(\"Viewport3D\");\r\n\t\t\t\t\tvar c_folder = displayControls.addFolder(\"camera\");\r\n\r\n\t\t\t\t\tc_folder.add(this._camera.position, \"x\", -1000, 1000).listen();\r\n\t\t\t\t\tc_folder.add(this._camera.position, \"y\", -1000, 1000).listen();\r\n\t\t\t\t\tc_folder.add(this._camera.position, \"z\", -1000, 1000).listen();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\r\n\t\t\tif(params.resize){\r\n\t\t\t\tAnimyst.Window.resizeSignal.add(this.onResize, this);\r\n\t\t\t}\r\n\r\n\t\t\tthis._view = document.createElement('canvas');\r\n\t\t\tthis._view.width = this.width;\r\n\t\t\tthis._view.height = this.height;\r\n\t\t\tthis._context2d = this._view.getContext('2d');\r\n\r\n\t\t}\r\n\r\n\r\n\t\tpublic append(containerID):void{\r\n\r\n\t\t\tif(!containerID){\r\n\t\t\t\tdocument.body.appendChild(this._renderer.domElement);\r\n\t\t\t\t//document.body.appendChild(this.view);\r\n\t\t\t} else {\r\n\t\t\t\tvar container = document.getElementById(containerID);\r\n\t\t\t\tif(container)\t{\r\n\t\t\t\t\tcontainer.appendChild(this._renderer.domElement);\r\n\t\t\t\t\t//container.appendChild(this.view);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tLog.error(\"[Viewport3D] Container ID\", containerID, \"doesn't exist\");\r\n\t\t\t\t}\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\r\n\t\tpublic render():void{\r\n\t\t\tthis._renderer.render(this._scene, this._camera);\r\n\r\n\t\t\t//this.context2d.clearRect(0,0, this.view.width, this.view.height);\r\n\t\t\t//this.context2d.drawImage(this.renderer.domElement, 0, 0);\r\n\t\t\t//this.context2d.drawImage(this.uiRenderer.view, 0, 0);\r\n\t\t}\r\n\r\n\t\tpublic update():void{\r\n\t\t}\r\n\r\n\t\tpublic onResize():void{\r\n\t\t\t//this.renderer.setSize(Animyst.)\r\n\t\t}\r\n\r\n\r\n    }\r\n}","module Animyst {\r\n    export class Window {\r\n    \tstatic get orientation():any{return window.orientation};\r\n    \tstatic get isLandscape():boolean{return window.innerWidth > window.innerHeight};\r\n    \tstatic get isPortrait():boolean{return window.innerHeight > window.innerWidth};\r\n    \tstatic get width():number{return document.documentElement.clientWidth};\r\n    \tstatic get height():number{return document.documentElement.clientHeight};\r\n    \tstatic resizeSignal:Signal = new Signal();\r\n    \tstatic _onResize(evt:any):void{\r\n    \t\tLog.output(\"[Window] onResize!\")\r\n\t\t\tWindow.resizeSignal.dispatch(evt);\r\n    \t}\r\n\r\n    \tstatic _onWindowLoad(evt:any):void{\r\n    \t\tLog.output(\"[Window] Window loaded:\" , \"w:\", Window.width, \"h:\", Window.height)\r\n    \t}\r\n\r\n    \tstatic _setup():void{\r\n    \t\twindow.addEventListener(\"resize\", Window._onResize);\r\n\t\t\twindow.addEventListener(\"load\", Window._onWindowLoad);\r\n    \t}\r\n    }\r\n}\r\n\r\nAnimyst.Window._setup();\r\n","module Animyst {\r\n\texport var LOGGING:boolean = true;\r\n\texport var DEBUG:boolean = true;\r\n\texport var GUI:any;\r\n\r\n\texport var MAJOR:number = 0;\r\n\texport var MINOR:number = 0;\r\n\texport var BUILD:number = 0;\r\n\texport var DATA:string = \"\";\r\n\r\n\texport var VERSION:string = MAJOR + \".\" + MINOR + \".\" + BUILD;\r\n}","module Animyst {\r\n    export class Sound  {\r\n    \t\r\n    \tconstructor() {\r\n    \t}\r\n    }\r\n}","module Animyst {\r\n    export class PIXITexture extends THREE.Texture {\r\n\r\n    \tpublic stage:any;\r\n    \tpublic renderer:any;\r\n    \tpublic shouldUpdate:boolean;\r\n    \tpublic width:number;\r\n    \tpublic height:number\r\n\r\n    \tpublic _init(){\r\n\t\t\tthis.image = this.renderer.view;\r\n\r\n\t\t\tlet graphics = new PIXI.Graphics();\r\n\t\t\tgraphics.lineStyle(2, 0xFF00FF, 1);\r\n\t\t\tgraphics.beginFill(0xFF00BB, 0.25);\r\n\t\t\tgraphics.drawCircle(this.width/2, this.height/2, 100);\r\n\t\t\tgraphics.endFill();\r\n\r\n\t\t\tlet texture = PIXI.Texture.fromCanvas(DataLoad.getAsset('samusftilt'));\r\n\t\t\tlet sprite = new PIXI.Sprite(texture);\r\n\t\t\tthis.stage.addChild(sprite);\r\n\r\n\t\t\tthis.stage.addChild(graphics);\r\n\r\n\t\t\tthis.invalidate();\r\n\t\t\tthis.update();\r\n\t\t}\r\n\r\n\t\tpublic invalidate(){\r\n\t\t\t this.shouldUpdate = true; \r\n\t\t};\r\n\r\n\t\tpublic update(){\r\n\t\t\t if(this.shouldUpdate){\r\n\t\t\t \tthis.renderer.render(this.stage);\r\n\t\t\t \tthis.needsUpdate = true;\r\n\t\t\t \tthis.shouldUpdate = false;\r\n\t\t\t } \r\n\t\t};\r\n\r\n    \t\r\n    \tconstructor(stage:any, renderer:any) {\r\n    \t\tsuper();\r\n\r\n    \t\tthis.stage = stage;\r\n    \t\tthis.renderer = renderer;\r\n\r\n    \t\tthis.width = renderer.view.width;\r\n    \t\tthis.height = renderer.view.height;\r\n    \t\tthis._init();\r\n    \t}\r\n    }\r\n}","module Animyst {\r\n    export class SpriteSheetTexture extends THREE.Texture {\r\n    \t\r\n    \tpublic atlas:any;\r\n    \tpublic frames:any[];\r\n    \tpublic stage:PIXI.Container;\r\n    \tpublic renderer:any;\r\n    \tpublic playTime:number = 0;\r\n    \tpublic time:number = 0;\r\n    \tpublic loop:boolean;\r\n    \tpublic currentFrame:number = 0;\r\n    \tpublic currentFrameID:string = \"\";\r\n    \tpublic sprite:any = null;\r\n    \tpublic renderWidth:number = 0;\r\n    \tpublic renderHeight:number = 0;\r\n    \tpublic sourceFile:string = \"\";\r\n    \tpublic playing:boolean;\r\n    \tpublic timePassed:number = 0;\r\n\r\n    \tconstructor(atlas:any) {\r\n    \t\tsuper();\r\n\r\n\t\t\tthis.addSheet(atlas); \r\n    \t}\r\n\r\n    \tprivate _initSprite(startFrame):void{\r\n\r\n\t\t\tthis.stage    = new PIXI.Container();\r\n\t\t\tthis.renderer = PIXI.autoDetectRenderer(256, 256, {transparent : true});\r\n\t\t\tthis.sprite   = new PIXI.Sprite(PIXI.Texture.fromFrame(startFrame));\r\n\r\n\t\t\tthis.image = this.renderer.view;\r\n\r\n\t\t\tthis.stage.addChild(this.sprite);\r\n\t\t\tthis.renderer.render(this.stage);\r\n\r\n\t\t\tthis.needsUpdate = true;\r\n\t\t} \r\n\r\n\t\tpublic addSheet(atlas:any):void{\r\n\t\t\tthis.atlas = atlas;\r\n\t\t\tthis.frames = [];\r\n\r\n\r\n\t\t\tfor(var k in atlas.frames){\r\n\t\t\t\tvar frame = atlas.frames[k];\r\n\r\n\t\t\t\tif(frame.frame.w > this.renderWidth){\r\n\t\t\t\t\tthis.renderWidth = frame.frame.w % 2 == 0 ? frame.frame.w : frame.frame.w + 1;\r\n\r\n\t\t\t\t} \r\n\r\n\t\t\t\tif(frame.frame.h > this.renderHeight){\r\n\t\t\t\t\tthis.renderHeight = frame.frame.h % 2 == 0 ? frame.frame.h : frame.frame.h + 1;\r\n\t\t\t\t} \r\n\r\n\t\t\t\tthis.frames.push(k);\r\n\t\t\t}\r\n\r\n\t\t\tif(!this.sprite){\r\n\t\t\t\tthis._initSprite(this.frames[0]);\r\n\t\t\t\tthis.currentFrameID = this.frames[0];\r\n\t\t\t\tthis.currentFrame = 0;\r\n\t\t\t} \r\n\t\t}\r\n\r\n\t\tpublic showFrame(frame?:number):void{\r\n\t\t\tif(this.frames.length <= 0) return;\r\n\t\t\tif(!frame) frame = this.currentFrame || 0;\r\n\r\n\t\t\tvar thisFrame\r\n\r\n\t\t\tif(typeof frame == \"string\"){\r\n\t\t\t\tthisFrame = frame;\r\n\t\t\t} else if(typeof frame == \"number\"){\r\n\t\t\t\tthisFrame = this.frames[frame];\r\n\t\t\t}\r\n\r\n\t\t\tthis.sprite.setTexture(PIXI.Texture.fromFrame(thisFrame));\r\n\t\t\tthis.renderer.render(this.stage);\r\n\t\t\tthis.needsUpdate = true;\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tpublic play(time:number, loop:boolean):void{\r\n\t\t\tif(this.frames.length <= 0) return;\r\n\t\t\tthis.playing  = true;\r\n\t\t\tthis.loop     = loop;\r\n\t\t\tthis.playTime = time;\r\n\t\t\tthis.time     = 0;\r\n\r\n\t\t}\r\n\r\n\t\tpublic stop():void{\r\n\t\t\tthis.playing = false;\r\n\t\t\tthis.timePassed = 0;\r\n\t\t}\r\n\r\n\t\tpublic animate(delta:number, runtime?:number):void{\r\n\t\t\tif(this.playing){\r\n\t\t\t\t//console.log(delta, time, this.time, this.playTime, this.currentFrame, this.sourceFile)\r\n\t\t\t\tif(this.time >= this.playTime){\r\n\r\n\t\t\t\t\tif(this.loop){\r\n\t\t\t\t\t\tthis.time = 0;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.playing = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis.time += delta;\r\n\t\t\t\t\tthis.currentFrame = Math.round((this.time / this.playTime) * (this.frames.length - 1))\r\n\t\t\t\t\tif(this.currentFrame >= this.frames.length) this.currentFrame = this.frames.length - 1;\r\n\r\n\t\t\t\t\tthis.showFrame();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n    }\r\n}","module Animyst {\r\n    export class Input extends System {\r\n\r\n\t\tstatic KEY_DOWN:number      = 0;\r\n\t\tstatic KEY_UP:number        = 1;\r\n\r\n\t\tstatic TOUCH_START:number   = 0;\r\n\t\tstatic TOUCH_MOVE:number    = 1;\r\n\t\tstatic TOUCH_RELEASE:number = 2;\r\n\t\tstatic TOUCH_ENTER:number   = 3;\r\n\t\tstatic TOUCH_LEAVE:number   = 4;\r\n\r\n\t\tstatic MOUSE_DOWN:number    = 5;\r\n\t\tstatic MOUSE_UP:number      = 6;\r\n\t\tstatic MOUSE_DRAG:number    = 7;\r\n\t\tstatic MOUSE_MOVE:number    = 8;\r\n\t\tstatic MOUSE_ENTER:number   = 9;\r\n\t\tstatic MOUSE_LEAVE:number   = 10;\r\n\t\tstatic MOUSE_CLICK:number   = 11;\r\n    \t\r\n    \tpublic inputData:any;\r\n    \tpublic keyboardSettings:any;\r\n\r\n    \tconstructor(inputData:any) {\r\n    \t\tsuper();\r\n    \t\tthis.inputData = inputData;\r\n    \t}\r\n\r\n    \tpublic startup(params){\r\n\t\t\tvar element = params.element;\r\n\t\t\tvar tool    = params.tool;\r\n\t\t\tthis.keyboardSettings = params.keyboardSettings;\r\n\r\n\t\t\tif(tool){\r\n\t\t\t\ttool.onKeyUp     = this.onKeyUp.bind(this);\r\n\t\t\t\ttool.onKeyDown   = this.onKeyDown.bind(this);\r\n\t\t\t\ttool.onMouseDown = this.onMouseDown.bind(this);\r\n\t\t\t\ttool.onMouseUp   = this.onMouseUp.bind(this);\t\r\n\t\t\t\ttool.onMouseDrag = this.onMouseDrag.bind(this);\r\n\t\t\t\ttool.onMouseMove = this.onMouseMove.bind(this);\t\t\r\n\t\t\t}\r\n\r\n\t\t\tif(element){\r\n\t\t\t\telement.addEventListener('touchstart', this.onTouchStart.bind(this));\r\n\t\t\t\telement.addEventListener('touchmove', this.onTouchMove.bind(this));\r\n\t\t\t\telement.addEventListener('touchend', this.onTouchRelease.bind(this));\r\n\t\t\t\telement.addEventListener('touchenter', this.onTouchEnter.bind(this));\r\n\t\t\t\telement.addEventListener('touchleave', this.onTouchLeave.bind(this));\r\n\r\n\t\t\t\telement.addEventListener('mousedown', this.onMouseDown.bind(this));\r\n\t\t\t\telement.addEventListener('mouseup', this.onMouseUp.bind(this));\r\n\t\t\t\telement.addEventListener('mousemove', this.onMouseMove.bind(this));\r\n\t\t\t\telement.addEventListener('mouseenter', this.onMouseEnter.bind(this));\r\n\t\t\t\telement.addEventListener('mouseleave', this.onMouseLeave.bind(this));\r\n\r\n\t\t\t\telement.addEventListener('keydown', this.onKeyDown.bind(this));\r\n\t\t\t\telement.addEventListener('keyup', this.onKeyUp.bind(this));\r\n\t\t\t}\r\n\r\n\t\t\tSystem.prototype.startup.call(this, params);\r\n\t\t}\r\n\r\n\t\tpublic shutdown():void{\r\n\t\t\tthis.inputData = null;\r\n\t\t\tSystem.prototype.shutdown.call(this);\r\n\t\t}\r\n\r\n\t\tpublic update(delta:number, runtime:number):void{\r\n\t\t\tthis.inputData.onTick(delta);\r\n\t\t}\r\n\r\n\t\t//=============== TOUCH EVENTS ======================//\r\n\r\n\t\tpublic onTouchStart(evt):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Touch Start!\");\r\n\t\t\tthis.handleTouchInput(Input.TOUCH_START, evt);\r\n\t\t}\r\n\r\n\t\tpublic onTouchMove(evt):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Touch Move!\");\r\n\t\t\tthis.handleTouchInput(Input.TOUCH_MOVE, evt);\r\n\t\t}\r\n\r\n\t\tpublic onTouchRelease(evt):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Touch Release!\");\r\n\t\t\tthis.handleTouchInput(Input.TOUCH_RELEASE, evt);\r\n\t\t}\r\n\r\n\t\tpublic onTouchEnter(evt):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Touch Enter!\");\r\n\t\t\tthis.handleTouchInput(Input.TOUCH_ENTER, evt);\r\n\t\t}\r\n\r\n\t\tpublic onTouchLeave(evt):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Touch Leave!\");\r\n\t\t\tthis.handleTouchInput(Input.TOUCH_LEAVE, evt);\r\n\t\t}\r\n\r\n\r\n\t\t//================= MOUSE EVENTS =====================//\r\n\r\n\t\tpublic onClick(evt:any):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Click!\");\r\n\t\t\tthis.handleMouseInput(Input.MOUSE_CLICK, evt);\r\n\t\t}\r\n\r\n\t\tpublic onMouseDown(evt:any):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Down!\");\r\n\t\t\tthis.handleMouseInput(Input.MOUSE_DOWN, evt);\r\n\t\t}\r\n\r\n\t\tpublic onMouseDrag(evt:any):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Drag!\");\r\n\t\t\tthis.handleMouseInput(Input.MOUSE_DRAG, evt);\r\n\t\t}\r\n\r\n\t\tpublic onMouseMove(evt:any):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Move!\");\r\n\t\t\tthis.handleMouseInput(Input.MOUSE_MOVE, evt);\r\n\t\t}\r\n\r\n\t\tpublic onMouseUp(evt:any):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Up!\");\r\n\t\t\tthis.handleMouseInput(Input.MOUSE_UP, evt);\r\n\t\t}\r\n\r\n\t\tpublic onMouseEnter(evt:any):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Enter!\");\r\n\t\t\tthis.handleMouseInput(Input.MOUSE_ENTER, evt);\r\n\t\t}\r\n\r\n\t\tpublic onMouseLeave(evt:any):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Mouse Leave!\");\r\n\t\t\tthis.handleMouseInput(Input.MOUSE_LEAVE, evt);\r\n\t\t}\r\n\r\n\t\t//================ KEYBOARD EVENTS ===================//\r\n\r\n\t\tpublic onKeyUp(evt:any):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Released Key:\", evt.key || InputData.KEY_NAMES[evt.keyCode]);\r\n\t\t\tif(!this.keyboardSettings.allowDefault[evt.key || InputData.KEY_NAMES[evt.keyCode]]){\r\n\t\t\t\tevt.preventDefault();\r\n\t\t\t}\r\n\t\t\tthis.handleKeyInput(Input.KEY_UP, evt.keyCode || InputData.KEY_CODES[evt.key]);\r\n\t\t}\r\n\r\n\r\n\t\tpublic onKeyDown(evt:any):void{\r\n\t\t\tif(Animyst.LOGGING) console.log(\"[Input] Pressed Key:\", evt.key || InputData.KEY_NAMES[evt.keyCode]);\r\n\t\t\tif(!this.keyboardSettings.allowDefault[evt.key || InputData.KEY_NAMES[evt.keyCode]]){\r\n\t\t\t\tevt.preventDefault();\r\n\t\t\t}\r\n\r\n\t\t\tthis.handleKeyInput(Input.KEY_DOWN, evt.keyCode || InputData.KEY_CODES[evt.key]);\r\n\t\t}\r\n\r\n\t\t//====================================================//\r\n\r\n\t\tpublic handleMouseInput(type:number, evt:any):void{\r\n\t\t \t//console.log(evt);\r\n\t\t \tvar down;\r\n\r\n\t\t \tif(type == Input.MOUSE_DOWN || type == Input.MOUSE_DRAG){\r\n\t\t \t\tdown = true;\r\n\t\t \t}\r\n\r\n\t\t \tif(type == Input.MOUSE_UP || type == Input.MOUSE_LEAVE){\r\n\t\t \t\tdown = false;\r\n\t\t \t}\r\n\r\n\t\t \tthis.inputData.setMouseInput(evt, down);\r\n\t\t}\r\n\r\n\t\tpublic handleKeyInput(type:number, keyCode:number):void{\r\n\t\t\tthis.inputData.setKeyInput(keyCode, type == Input.KEY_DOWN)\r\n\t\t}\r\n\r\n\t\tpublic handleTouchInput(type:number, evt:any){\r\n\t\t\tswitch(type){\r\n\t\t\t\tcase Input.TOUCH_START:\r\n\t\t\t\t\tthis.inputData.addTouches(evt.changedTouches);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Input.TOUCH_MOVE:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Input.TOUCH_RELEASE:\r\n\t\t\t\t\tthis.inputData.removeTouches(evt.touches);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Input.TOUCH_ENTER:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Input.TOUCH_LEAVE:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tthis.inputData.updateTouches(evt.changedTouches);\r\n\t\t}\r\n\r\n\r\n    }\r\n}","module Animyst {\r\n    export class InputData extends Database {\r\n\r\n    \tstatic TOUCH_HISTORY_LIMIT:number = 12;\r\n\t\tstatic TOUCH_PROPERTIES:any[]     = [\"identifier\", \"screenX\", \"screenY\", \"clientX\", \"clientY\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t   \"pageX\", \"pageY\", \"radiusX\", \"radiusY\", \"rotationAngle\", \r\n\t\t\t\t\t\t\t\t\t\t\t\t   \"force\", \"webkitForce\", \"target\"];\r\n\t\tstatic MOUSE_PROPERTIES:any[]     = [\"clientX\", \"clientY\", \"screenX\", \"screenY\",\"type\", \"point\", \r\n\t\t\t\t\t\t\t\t\t\t\t\t\"lastPoint\", \"downPoint\", \"middlePoint\", \"count\", \"item\", \"modifiers\"];\r\n\r\n\t\tstatic KEY_CODES:any =  {\r\n\t\t    'backspace': 8,\r\n\t\t    'tab': 9,\r\n\t\t    'enter': 13,\r\n\t\t    'shift': 16,\r\n\t\t    'ctrl': 17,\r\n\t\t    'alt': 18,\r\n\t\t    'pause': 19,\r\n\t\t    'capslock': 20,\r\n\t\t    'numlock': 144,\r\n\t\t    'esc': 27,\r\n\t\t    'pageup': 33,\r\n\t\t    'pagedown': 34,\r\n\t\t    'end': 35,\r\n\t\t    'home': 36,\r\n\t\t    'leftarrow': 37,\r\n\t\t    'uparrow': 38,\r\n\t\t    'rightarrow': 39,\r\n\t\t    'downarrow': 40,\r\n\t\t    'insert': 45,\r\n\t\t    'delete': 46,\r\n\t\t    'clear':12,\r\n\t\t    '0': 48,\r\n\t\t    '1': 49,\r\n\t\t    '2': 50,\r\n\t\t    '3': 51,\r\n\t\t    '4': 52,\r\n\t\t    '5': 53,\r\n\t\t    '6': 54,\r\n\t\t    '7': 55,\r\n\t\t    '8': 56,\r\n\t\t    '9': 57,\r\n\t\t    'a': 65,\r\n\t\t    'b': 66,\r\n\t\t    'c': 67,\r\n\t\t    'd': 68,\r\n\t\t    'e': 69,\r\n\t\t    'f': 70,\r\n\t\t    'g': 71,\r\n\t\t    'h': 72,\r\n\t\t    'i': 73,\r\n\t\t    'j': 74,\r\n\t\t    'k': 75,\r\n\t\t    'l': 76,\r\n\t\t    'm': 77,\r\n\t\t    'n': 78,\r\n\t\t    'o': 79,\r\n\t\t    'p': 80,\r\n\t\t    'q': 81,\r\n\t\t    'r': 82,\r\n\t\t    's': 83,\r\n\t\t    't': 84,\r\n\t\t    'u': 85,\r\n\t\t    'v': 86,\r\n\t\t    'w': 87,\r\n\t\t    'x': 88,\r\n\t\t    'y': 89,\r\n\t\t    'z': 90,\r\n\t\t    'numpad0': 96,\r\n\t\t    'numpad1': 97,\r\n\t\t    'numpad2': 98,\r\n\t\t    'numpad3': 99,\r\n\t\t    'numpad4': 100,\r\n\t\t    'numpad5': 101,\r\n\t\t    'numpad6': 102,\r\n\t\t    'numpad7': 103,\r\n\t\t    'numpad8': 104,\r\n\t\t    'numpad9': 105,\r\n\t\t    'multiply': 106,\r\n\t\t    'plus': 107,\r\n\t\t    'minus': 109,\r\n\t\t    'dot': 110,\r\n\t\t    'divide': 111,\r\n\t\t    'f1': 112,\r\n\t\t    'f2': 113,\r\n\t\t    'f3': 114,\r\n\t\t    'f4': 115,\r\n\t\t    'f5': 116,\r\n\t\t    'f6': 117,\r\n\t\t    'f7': 118,\r\n\t\t    'f8': 119,\r\n\t\t    'f9': 120,\r\n\t\t    'f10': 121,\r\n\t\t    'f11': 122,\r\n\t\t    'f12': 123,\r\n\t\t    '=': 187,\r\n\t\t    ',': 188,\r\n\t\t    '.': 190,\r\n\t\t    '/': 191,\r\n\t\t    'backslash': 220,\r\n\t\t    \";\":186,\r\n\t\t    \"'\":222,\r\n\t\t    \"[\":219,\r\n\t\t    \"]\":221,\r\n\t\t    \"-\":189,\r\n\t\t    \"space\":32 ,\r\n\t\t    \"~\":192\r\n\t\t};\r\n\r\n\t\tstatic KEY_NAMES = ObjectUtil.invert(InputData.KEY_CODES);\r\n\r\n\t\tstatic MOUSE = 0;\r\n\t\tstatic TOUCH = 1;\r\n\t\tstatic KEY   = 2;\r\n\r\n\t\tstatic TOUCH_ADDED   = 0;\r\n\t\tstatic TOUCH_REMOVED = 1;\r\n\t\tstatic TOUCH_UPDATED = 2;\r\n\r\n\t\tstatic MOUSE_DOWN = 0;\r\n\t\tstatic MOUSE_UP   = 1;\r\n\t\tstatic MOUSE_MOVE = 2;\r\n\r\n\t\tstatic KEY_ACTIVE   = 0;\r\n\t\tstatic KEY_INACTIVE = 1;\r\n\r\n    \tpublic map:any                = {};\r\n\t\tpublic touches:any[]          = [];\r\n\t\tpublic touchHistory:any[]     = [];\r\n\t\tpublic mouse:any              = {};\r\n\t\tpublic mouseHistory:any[]     = [];\r\n\t\tpublic totalTouchCount:number = 0;\r\n\t\tpublic time:number            = 0;\r\n    \t\r\n    \tconstructor() {\r\n    \t\tsuper();\r\n    \t}\r\n\r\n    \tpublic clear():void{\r\n\r\n\t\t\tthis.map             = {};\r\n\t\t\tthis.touches         = [];\r\n\t\t\tthis.touchHistory    = [];\r\n\t\t\tthis.totalTouchCount = 0;\r\n\r\n\t\t\tsuper.clear();\r\n\t\t}\r\n\r\n\t\tpublic destroy():void{\r\n\r\n\t\t\tthis.map             = null;\r\n\t\t\tthis.touches         = null;\r\n\t\t\tthis.touchHistory    = null;\r\n\t\t\tthis.totalTouchCount = 0;\r\n\r\n\t\t\tsuper.destroy();\r\n\t\t}\r\n\r\n\t\tpublic onTick(delta:number):void{\r\n\t\t\tthis.time += delta;\r\n\r\n\t\t\tif(this.mouse.down){\r\n\t\t\t\tthis.mouse.clickTime += delta;\r\n\t\t\t}\r\n\r\n\t\t\tfor(var k in this.map){\r\n\t\t\t\tvar data = this.map[k];\r\n\r\n\t\t\t\tif(data.active){\r\n\t\t\t\t\tdata.time = (data.time || 0) + delta;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor(var i = 0; i < this.touches.length; i++){\r\n\t\t\t\tvar touchData = this.touches[i];\r\n\t\t\t\ttouchData.time += delta;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic isKeyDown(keyName:string):boolean{\r\n\t\t\tvar keyCode = InputData.KEY_CODES[keyName];\r\n\t\t\treturn (this.map[keyCode] && this.map[keyCode].active) ? true : false;\r\n\t\t}\r\n\r\n\t\tpublic setKeyInput(keyCode:number, active?:boolean):void{\r\n\t\t\tvar data = this.map[keyCode] || {};\r\n\t\t\tvar evtType;\r\n\r\n\t\t\tif(active && !data.active){\r\n\t\t\t\tdata.time = 0;\r\n\t\t\t\tevtType = InputData.KEY_ACTIVE;\r\n\t\t\t}\r\n\r\n\t\t\tif(!active && data.active){\r\n\t\t\t\tdata.lastInput = {};\r\n\t\t\t\tdata.lastInput.endTime   = this.time;\r\n\t\t\t\tdata.lastInput.duration  = data.time;\r\n\t\t\t\tdata.lastInput.startTime = this.time - data.time;\r\n\r\n\t\t\t\tdata.time = 0;\r\n\t\t\t\tevtType = InputData.KEY_INACTIVE\r\n\t\t\t}\r\n\r\n\t\t\tdata.active = active === true;\r\n\r\n\t\t\tif(!this.map[keyCode]){\r\n\t\t\t\tthis.map[keyCode] = data;\r\n\t\t\t}\r\n\r\n\t\t\tif(evtType) this.signal.dispatch(InputData.KEY, evtType, data);\r\n\r\n\r\n\t\t}\r\n\r\n\t\tpublic setMouseInput(evt:any, down?:boolean):void{\r\n\t\t\tif(this.touches.length > 0 && down) down = false;\r\n\t\t\tif(typeof(down) != \"boolean\") down = this.mouse.down;\r\n\r\n\r\n\t\t\tvar lastClick  = this.mouse.down && !down ? this.mouse.lastClick || {} : null;\r\n\t\t\tvar clickStart = !this.mouse.down && down ? {} : null;\r\n\t\t\tvar evtType = InputData.MOUSE_MOVE;\r\n\t\t\t\r\n\r\n\t\t\tfor(var i = 0; i < InputData.MOUSE_PROPERTIES.length; i++){\r\n\t\t\t\tvar k = InputData.MOUSE_PROPERTIES[i];\r\n\t\t\t\tif(evt[k]){\r\n\t\t\t\t\tthis.mouse[k] = evt[k];\r\n\t\t\t\t\tif(lastClick) lastClick[k] = evt[k];\r\n\t\t\t\t\tif(clickStart) clickStart[k] = evt[k];\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(clickStart){\r\n\t\t\t\tif(Animyst.LOGGING) console.log(\"[InputData] Click Start!\");\r\n\t\t\t\tthis.mouse.clickStart = clickStart\r\n\t\t\t\tthis.mouse.clickTime = 0;\r\n\t\t\t\tevtType = InputData.MOUSE_DOWN;\r\n\t\t\t}\r\n\r\n\t\t\tif(lastClick){\r\n\t\t\t\tif(Animyst.LOGGING) console.log(\"[InputData] Click Ended!\", this.mouse.clickTime);\r\n\t\t\t\tlastClick.clickStart = this.mouse.clickStart;\r\n\t\t\t\tlastClick.clickTime  = this.mouse.clickTime;\r\n\t\t\t\t\r\n\t\t\t\tthis.mouse.clickStart = null;\r\n\t\t\t\tthis.mouse.lastClick = lastClick;\r\n\t\t\t\tevtType = InputData.MOUSE_UP;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.mouse.down = down;\r\n\r\n\t\t\tthis.signal.dispatch(InputData.MOUSE, evtType, this.mouse);\r\n\t\t}\r\n\r\n\t\tpublic getTouches():any{\r\n\t\t\treturn this.touches.concat();\r\n\t\t}\r\n\r\n\t\tpublic addTouches(touches:any[]):void{\r\n\t\t\tfor(var i = 0; i < touches.length; i++){\r\n\t\t\t\tvar touch = touches[i];\r\n\t\t\t\tvar isNew = true;\r\n\r\n\t\t\t\tfor(var j = 0; j < this.touches.length; j++){\r\n\t\t\t\t\tif(this.touches[j].identifier == touch.identifier){\r\n\t\t\t\t\t\tisNew = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(isNew){\r\n\t\t\t\t\tvar data:any = {};\r\n\t\t\t\t\tvar startData:any = {};\r\n\r\n\t\t\t\t\tfor(var j = 0; j < InputData.TOUCH_PROPERTIES.length; j++){\r\n\t\t\t\t\t\tvar k = InputData.TOUCH_PROPERTIES[j];\r\n\t\t\t\t\t\tdata[k]      = (typeof touch[k] != \"object\" || k == \"target\") ? touch[k] : null;\r\n\t\t\t\t\t\tstartData[k] = (typeof touch[k] != \"object\") ? touch[k] : null;\r\n\t\t\t\t\t} \r\n\r\n\t\t\t\t\tdata.time      = 0;        //Time Counter\r\n\t\t\t\t\tdata.timestamp = this.time //When the touch began\r\n\t\t\t\t\tdata.startData = startData //Data assosiated with the start of the touch\r\n\t\t\t\t\tdata.uid       = data.identifier + \"\" + this.totalTouchCount //Unique identifier for this touch that seperates it from past touches\r\n\r\n\t\t\t\t\tthis.touches.push(data);\r\n\t\t\t\t\tthis.totalTouchCount++;\r\n\t\t\t\t\tif(Animyst.LOGGING) console.log(\"[InputData] Adding Touch:\", data.uid);\r\n\r\n\t\t\t\t\tthis.signal.dispatch(InputData.TOUCH, InputData.TOUCH_ADDED, data);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\tpublic removeTouches(touches:any[]):void{\r\n\t\t\tfor(var i = this.touches.length - 1; i > -1 && this.touches.length > 0; i--){\r\n\t\t\t\tvar touchData = this.touches[i];\r\n\t\t\t\tvar isGone = true;\r\n\r\n\t\t\t\tfor(var j = 0; j < touches.length; j++){\r\n\t\t\t\t\tif(touches[j].identifier == touchData.identifier){\r\n\t\t\t\t\t\tisGone = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(isGone){\r\n\t\t\t\t\tif(Animyst.LOGGING) console.log(\"[InputData] Removing Touch:\", touchData.uid);\r\n\t\t\t\t\tthis.touchHistory.unshift(touchData);\r\n\t\t\t\t\tthis.touches.splice(i,1);\r\n\t\t\t\t\tif(this.touchHistory.length > InputData.TOUCH_HISTORY_LIMIT){\r\n\t\t\t\t\t\tthis.touchHistory.pop();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.signal.dispatch(InputData.TOUCH, InputData.TOUCH_REMOVED, touchData);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tpublic updateTouches(touches:any[]):void{\r\n\t\t\tfor(var i = 0; i < touches.length; i++){\r\n\t\t\t\tvar touch = touches[i];\r\n\t\t\t\tvar data\r\n\t\t\t\tfor(var j = 0; j < this.touches.length; j++){\r\n\t\t\t\t\tif(this.touches[j].identifier == touch.identifier){\r\n\t\t\t\t\t\tdata = this.touches[j];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(data){\r\n\t\t\t\t\tfor(var j = 0; j < InputData.TOUCH_PROPERTIES.length; j++){\r\n\t\t\t\t\t\tvar k = InputData.TOUCH_PROPERTIES[j];\r\n\t\t\t\t\t\tdata[k] = touch[k];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(Animyst.LOGGING) console.log(\"[InputData] Updated Touch:\", data.uid, Math.round(data.pageX), Math.round(data.pageY), Math.round(data.screenX), Math.round(data.screenY), data.force || data.webkitForce);\r\n\t\t\t\t\tthis.signal.dispatch(InputData.TOUCH, InputData.TOUCH_UPDATED, data);\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n    }\r\n}","/// <reference path=\"pixi.js.d.ts\" />\r\n\r\nnamespace basics {\r\n\r\n    export class Basics {\r\n\r\n        private app: PIXI.Application;\r\n\r\n        private bunny: PIXI.Sprite;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.bunny = PIXI.Sprite.fromImage(\"required/assets/basics/bunny.png\");\r\n            this.bunny.anchor.set(0.5);\r\n            this.bunny.x = this.app.renderer.width / 2;\r\n            this.bunny.y = this.app.renderer.height / 2;\r\n            this.app.stage.addChild(this.bunny);\r\n\r\n            this.app.ticker.add((delta: number): void => {\r\n                this.bunny.rotation += 0.1 / delta;\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class Click {\r\n\r\n        private app: PIXI.Application;\r\n\r\n        private sprite: PIXI.Sprite;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.sprite = PIXI.Sprite.fromImage(\"../../_assets/basics/bunny.png\");\r\n            this.sprite.texture.baseTexture.scaleMode = PIXI.SCALE_MODES.NEAREST;\r\n            this.sprite.anchor.set(0.5);\r\n            this.sprite.x = this.app.renderer.width / 2;\r\n            this.sprite.y = this.app.renderer.height / 2;\r\n            this.sprite.interactive = true;\r\n            this.sprite.buttonMode = true;\r\n            this.sprite.on(\"pointerdown\", (): void => {\r\n                this.sprite.scale.x *= 1.25;\r\n                this.sprite.scale.y *= 1.25;\r\n            });\r\n            this.app.stage.addChild(this.sprite);\r\n\r\n        }\r\n    }\r\n\r\n    export class ContainerPivot {\r\n\r\n        private app: PIXI.Application;\r\n        private container: PIXI.Container;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.container = new PIXI.Container();\r\n            this.app.stage.addChild(this.container);\r\n\r\n            let texture = PIXI.Texture.fromImage(\"../../_assets/basics/bunny.png\");\r\n\r\n            for (let i = 0; i < 25; i++) {\r\n\r\n                let bunny = new PIXI.Sprite(texture);\r\n                bunny.anchor.set(0.5);\r\n                bunny.x = (i % 5) * 40;\r\n                bunny.y = Math.floor(i / 5) * 40;\r\n                this.container.addChild(bunny);\r\n\r\n            }\r\n\r\n            this.container.x = this.app.renderer.width / 2;\r\n            this.container.y = this.app.renderer.height / 2;\r\n\r\n            this.container.pivot.x = this.container.width / 2;\r\n            this.container.pivot.y = this.container.height / 2;\r\n\r\n            this.app.ticker.add((delta: number): void => {\r\n                this.container.rotation -= 0.01 / delta;\r\n            });\r\n\r\n        }\r\n    }\r\n\r\n    export class Container {\r\n\r\n        private app: PIXI.Application;\r\n        private container: PIXI.Container;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.container = new PIXI.Container();\r\n            this.app.stage.addChild(this.container);\r\n\r\n            let texture = PIXI.Texture.fromImage(\"../../_assets/basics/bunny.png\");\r\n\r\n            for (let i = 0; i < 25; i++) {\r\n\r\n                let bunny = new PIXI.Sprite(texture);\r\n                bunny.anchor.set(0.5);\r\n                bunny.x = (i % 5) * 40;\r\n                bunny.y = Math.floor(i / 5) * 40;\r\n                this.container.addChild(bunny);\r\n\r\n            }\r\n\r\n            this.container.x = this.app.renderer.width / 2;\r\n            this.container.y = this.app.renderer.height / 2;\r\n\r\n        }\r\n    }\r\n\r\n    export class CustomizedFilter extends PIXI.Filter {\r\n\r\n        constructor(fragmentSource: string) {\r\n            super(null, fragmentSource, {\r\n                customUniform: {\r\n                    type: \"1f\",\r\n                    value: 0\r\n                }\r\n            });\r\n        }\r\n\r\n    }\r\n    export class CustomFilter {\r\n\r\n        private app: PIXI.Application;\r\n        private background: PIXI.Sprite;\r\n        private filter: CustomizedFilter;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.background = PIXI.Sprite.fromImage(\"required/assets/bkg-grass.jpg\");\r\n            this.background.width = this.app.renderer.width;\r\n            this.background.height = this.app.renderer.height;\r\n            this.app.stage.addChild(this.background);\r\n\r\n            this.app.stop();\r\n\r\n            PIXI.loader.add(\"shader\", \"_assets/basics/shader.frag\")\r\n\r\n                .load((loader: PIXI.loaders.Loader, resource: any): void => {\r\n\r\n                    this.filter = new PIXI.Filter(null, resource.shader.data);\r\n                    this.background.filters = [this.filter];\r\n                    this.app.start();\r\n\r\n                    this.app.ticker.add((delta: number) => {\r\n                        this.filter.uniforms.customUniform += 0.04 / delta;\r\n                    });\r\n\r\n                });\r\n\r\n        }\r\n    }\r\n\r\n    export class Graphics {\r\n\r\n        private app: PIXI.Application;\r\n        private graphics: PIXI.Graphics;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { antialias: true });\r\n            document.body.appendChild(this.app.view);\r\n\r\n            let graphics = new PIXI.Graphics();\r\n\r\n            // set a fill and line style\r\n            graphics.beginFill(0xFF3300);\r\n            graphics.lineStyle(4, 0xffd900, 1);\r\n\r\n            // draw a shape\r\n            graphics.moveTo(50, 50);\r\n            graphics.lineTo(250, 50);\r\n            graphics.lineTo(100, 100);\r\n            graphics.lineTo(50, 50);\r\n            graphics.endFill();\r\n\r\n            // set a fill and a line style again and draw a rectangle\r\n            graphics.lineStyle(2, 0x0000FF, 1);\r\n            graphics.beginFill(0xFF700B, 1);\r\n            graphics.drawRect(50, 250, 120, 120);\r\n\r\n            // draw a rounded rectangle\r\n            graphics.lineStyle(2, 0xFF00FF, 1);\r\n            graphics.beginFill(0xFF00BB, 0.25);\r\n            graphics.drawRoundedRect(150, 450, 300, 100, 15);\r\n            graphics.endFill();\r\n\r\n            // draw a circle, set the lineStyle to zero so the circle doesn\"t have an outline\r\n            graphics.lineStyle(0);\r\n            graphics.beginFill(0xFFFF0B, 0.5);\r\n            graphics.drawCircle(470, 90, 60);\r\n            graphics.endFill();\r\n\r\n            this.graphics = graphics;\r\n\r\n            this.app.stage.addChild(this.graphics);\r\n        }\r\n    }\r\n\r\n    export class RenderTexture {\r\n\r\n        private app: PIXI.Application;\r\n        private container: PIXI.Container;\r\n        private renderTexture: PIXI.RenderTexture;\r\n        private sprite: PIXI.Sprite;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.container = new PIXI.Container();\r\n            this.app.stage.addChild(this.container);\r\n\r\n            let texture = PIXI.Texture.fromImage(\"required/assets/basics/bunny.png\");\r\n\r\n            for (let i = 0; i < 25; i++) {\r\n                let bunny = new PIXI.Sprite(texture);\r\n                bunny.x = (i % 5) * 30;\r\n                bunny.y = Math.floor(i / 5) * 30;\r\n                bunny.rotation = Math.random() * (Math.PI * 2);\r\n                this.container.addChild(bunny);\r\n            }\r\n\r\n            let brt = new PIXI.BaseRenderTexture(300, 300, PIXI.SCALE_MODES.LINEAR, 1);\r\n            let rt = new PIXI.RenderTexture(brt);\r\n\r\n            this.sprite = new PIXI.Sprite(rt);\r\n            this.sprite.x = 450;\r\n            this.sprite.y = 60;\r\n            this.app.stage.addChild(this.sprite);\r\n\r\n            this.container.x = 100;\r\n            this.container.y = 60;\r\n\r\n            this.app.ticker.add((delta: number) => {\r\n                this.app.renderer.render(this.container, rt);\r\n            });\r\n\r\n        }\r\n    }\r\n\r\n    export class SpriteSheet {\r\n\r\n        private app: PIXI.Application;\r\n        private anim: PIXI.extras.AnimatedSprite;\r\n\r\n        constructor() {\r\n\r\n            PIXI.loader\r\n                .add(\"required/assets/basics/fighter.json\")\r\n                .load((loader: PIXI.loaders.Loader, resource: any) => {\r\n\r\n                    let frames = [];\r\n\r\n                    for (let i = 0; i < 30; i++) {\r\n\r\n                        let val = i < 10 ? \"0\" + i : i;\r\n\r\n                        frames.push(PIXI.Texture.fromFrame(\"rollSequence00\" + val + \".png\"));\r\n\r\n                    }\r\n\r\n                    this.anim = new PIXI.extras.AnimatedSprite(frames);\r\n\r\n                    this.anim.x = this.app.renderer.width / 2;\r\n                    this.anim.y = this.app.renderer.height / 2;\r\n                    this.anim.anchor.set(0.5);\r\n                    this.anim.animationSpeed = 0.5;\r\n                    this.anim.play();\r\n\r\n                    this.app.stage.addChild(this.anim);\r\n\r\n                    this.app.ticker.add((deltaTime: number) => {\r\n                        this.anim.rotation += 0.01;\r\n                    });\r\n\r\n                });\r\n        }\r\n\r\n    }\r\n\r\n    export class Text {\r\n\r\n        private app: PIXI.Application;\r\n        private basicText: PIXI.Text;\r\n        private richText: PIXI.Text;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.basicText = new PIXI.Text(\"Basic text in pixi\");\r\n            this.basicText.x = 30;\r\n            this.basicText.y = 90;\r\n            this.app.stage.addChild(this.basicText);\r\n\r\n            let style = new PIXI.TextStyle({\r\n                fontFamily: \"Arial\",\r\n                fontSize: 36,\r\n                fontStyle: \"italic\",\r\n                fontWeight: \"bold\",\r\n                fill: [\"#ffffff\", \"#fff0b5\"],\r\n                stroke: \"#4a1850\",\r\n                strokeThickness: 5,\r\n                dropShadow: true,\r\n                dropShadowColor: \"#000000\",\r\n                dropShadowBlur: 4,\r\n                dropShadowAngle: Math.PI / 6,\r\n                dropShadowDistance: 6,\r\n                wordWrap: true,\r\n                wordWrapWidth: 440\r\n            });\r\n\r\n            this.richText = new PIXI.Text(\"Rich text with a lot of options and across multiple lines\", style);\r\n            this.richText.x = 30;\r\n            this.richText.y = 180;\r\n            this.app.stage.addChild(this.richText);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class TexturedMesh {\r\n\r\n        private app: PIXI.Application;\r\n        private count: number;\r\n        private points: PIXI.Point[];\r\n        private strip: PIXI.mesh.Rope;\r\n        private graphics: PIXI.Graphics;\r\n\r\n        constructor() {\r\n\r\n            let ropeLength = 918 / 20;\r\n\r\n            for (let i = 0; i < 25; i++) {\r\n                this.points.push(new PIXI.Point(i * ropeLength, 0));\r\n            }\r\n\r\n            this.strip = new PIXI.mesh.Rope(PIXI.Texture.fromImage(\"required/assets/snake.png\"), this.points);\r\n            this.strip.x = -40;\r\n            this.strip.y = 300;\r\n            this.app.stage.addChild(this.strip);\r\n\r\n            this.graphics = new PIXI.Graphics();\r\n            this.graphics.x = this.strip.x;\r\n            this.graphics.y = this.strip.y;\r\n            this.app.stage.addChild(this.graphics);\r\n\r\n            // start animating\r\n            this.app.ticker.add((deltaTime: number) => {\r\n\r\n                this.count += 0.1;\r\n\r\n                // make the snake\r\n                for (let i = 0; i < this.points.length; i++) {\r\n                    this.points[i].y = Math.sin((i * 0.5) + this.count) * 30;\r\n                    this.points[i].x = i * ropeLength + Math.cos((i * 0.3) + this.count) * 20;\r\n                }\r\n                this.renderPoints();\r\n\r\n            });\r\n\r\n        }\r\n\r\n        private renderPoints(): void {\r\n\r\n            this.graphics.clear();\r\n            this.graphics.lineStyle(2, 0xffc2c2);\r\n            this.graphics.moveTo(this.points[0].x, this.points[0].y);\r\n\r\n            for (let i = 1; i < this.points.length; i++) {\r\n                this.graphics.lineTo(this.points[i].x, this.points[i].y);\r\n            }\r\n\r\n            for (let i = 1; i < this.points.length; i++) {\r\n                this.graphics.beginFill(0xff0022);\r\n                this.graphics.drawCircle(this.points[i].x, this.points[i].y, 10);\r\n                this.graphics.endFill();\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class TilingSprite {\r\n\r\n        private app: PIXI.Application;\r\n        private tilingSprite: PIXI.extras.TilingSprite;\r\n        private count: number;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            document.body.appendChild(this.app.view);\r\n\r\n            let texture = PIXI.Texture.fromImage(\"required/assets/p2.jpeg\");\r\n\r\n            this.tilingSprite = new PIXI.extras.TilingSprite(\r\n                texture,\r\n                this.app.renderer.width,\r\n                this.app.renderer.height\r\n            );\r\n            this.app.stage.addChild(this.tilingSprite);\r\n\r\n            this.count = 0;\r\n\r\n            this.app.ticker.add((deltaTime: number): void => {\r\n\r\n                this.count += 0.005;\r\n\r\n                this.tilingSprite.tileScale.x = 2 + Math.sin(this.count);\r\n                this.tilingSprite.tileScale.y = 2 + Math.cos(this.count);\r\n                this.tilingSprite.tilePosition.x += 1;\r\n                this.tilingSprite.tilePosition.y += 1;\r\n\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class Video {\r\n\r\n        private app: PIXI.Application;\r\n        private button: PIXI.Graphics;\r\n        private videoSprite: PIXI.Sprite;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { transparent: true });\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.button = new PIXI.Graphics()\r\n                .beginFill(0x0, 0.5)\r\n                .drawRoundedRect(0, 0, 100, 100, 10)\r\n                .endFill()\r\n                .beginFill(0xffffff)\r\n                .moveTo(36, 30)\r\n                .lineTo(36, 70)\r\n                .lineTo(70, 50);\r\n\r\n            // Position the button\r\n            this.button.x = (this.app.renderer.width - this.button.width) / 2;\r\n            this.button.y = (this.app.renderer.height - this.button.height) / 2;\r\n\r\n            // Enable interactivity on the button\r\n            this.button.interactive = true;\r\n            this.button.buttonMode = true;\r\n\r\n            // Add to the stage\r\n            this.app.stage.addChild(this.button);\r\n\r\n            this.button.on(\"pointertap\", (): void => {\r\n\r\n                this.button.destroy();\r\n\r\n                let texture = PIXI.Texture.fromVideo(\"required/assets/testVideo.mp4\");\r\n\r\n                this.videoSprite = new PIXI.Sprite(texture);\r\n                this.videoSprite.width = this.app.renderer.width;\r\n                this.videoSprite.height = this.app.renderer.height;\r\n                this.app.stage.addChild(this.videoSprite);\r\n\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nnamespace demos {\r\n\r\n    export class AlphaMask {\r\n\r\n        private app: PIXI.Application;\r\n        private bg: PIXI.Container;\r\n        private cells: PIXI.Sprite;\r\n        private mask: PIXI.Sprite;\r\n        private target: PIXI.Point;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            this.app.stage.interactive = true;\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.bg = PIXI.Sprite.fromImage(\"required/assets/bkg.jpg\");\r\n            this.app.stage.addChild(this.bg);\r\n\r\n            this.cells = PIXI.Sprite.fromImage(\"required/assets/cells.png\");\r\n            this.cells.scale.set(1.5);\r\n\r\n            this.mask = PIXI.Sprite.fromImage(\"required/assets/flowerTop.png\");\r\n            this.mask.anchor.set(0.5);\r\n            this.mask.x = 310;\r\n            this.mask.y = 190;\r\n\r\n            this.cells.mask = this.mask;\r\n\r\n            this.app.stage.addChild(this.mask, this.cells);\r\n\r\n            this.target = new PIXI.Point();\r\n\r\n            this.reset();\r\n\r\n            this.app.ticker.add((deltaTime: number): void => {\r\n\r\n                this.mask.position.x += (this.target.x - this.mask.x) * 0.1;\r\n                this.mask.position.y += (this.target.y - this.mask.y) * 0.1;\r\n\r\n                if (Math.abs(this.mask.x - this.target.x) < 1) {\r\n                    this.reset();\r\n                }\r\n\r\n\r\n            });\r\n\r\n        }\r\n\r\n        private reset(): void {\r\n\r\n            this.target.x = Math.floor(Math.random() * 550);\r\n            this.target.y = Math.floor(Math.random() * 300);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class AnimatedSpriteDemo {\r\n\r\n        private app: PIXI.Application;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            this.app.stop();\r\n            document.body.appendChild(this.app.view);\r\n\r\n            PIXI.loader\r\n                .add(\"spritesheet\", \"required/assets/mc.json\")\r\n                .load((): void => {\r\n\r\n                    let explosionTextures: PIXI.Texture[] = [];\r\n                    let i: number;\r\n\r\n                    for (i = 0; i < 26; i++) {\r\n                        let texture = PIXI.Texture.fromFrame(\"Explosion_Sequence_A \" + (i + 1) + \".png\");\r\n                        explosionTextures.push(texture);\r\n                    }\r\n\r\n                    for (i = 0; i < 50; i++) {\r\n\r\n                        let explosion = new PIXI.extras.AnimatedSprite(explosionTextures);\r\n\r\n                        explosion.x = Math.random() * this.app.renderer.width;\r\n                        explosion.y = Math.random() * this.app.renderer.height;\r\n                        explosion.anchor.set(0.5);\r\n                        explosion.rotation = Math.random() * Math.PI;\r\n                        explosion.scale.set(0.75 + Math.random() * 0.5);\r\n                        explosion.gotoAndPlay(Math.random() * 27);\r\n                        this.app.stage.addChild(explosion);\r\n                    }\r\n\r\n                    this.app.start();\r\n\r\n                });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class Batch {\r\n\r\n        private app: PIXI.Application;\r\n        private sprites: PIXI.particles.ParticleContainer;\r\n        private maggots: Dude[];\r\n        private dudeBounds: PIXI.Rectangle;\r\n        private tick: number;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.sprites = new PIXI.particles.ParticleContainer(10000, {\r\n                scale: true,\r\n                position: true,\r\n                rotation: true,\r\n                uvs: true,\r\n                alpha: true\r\n            });\r\n            this.app.stage.addChild(this.sprites);\r\n\r\n            this.maggots = [];\r\n\r\n            let totalSprites = this.app.renderer instanceof PIXI.WebGLRenderer ? 10000 : 100;\r\n\r\n            let dudeTexture = PIXI.Texture.fromImage(\"required/assets/tinyMaggot.png\");\r\n\r\n            for (let i = 0; i < totalSprites; i++) {\r\n\r\n                let dude = new Dude(dudeTexture);\r\n                dude.tint = Math.random() * 0xE8D4CD;\r\n                dude.anchor.set(0.5);\r\n                dude.scale.set(0.8 + Math.random() * 0.3);\r\n                dude.x = Math.random() * this.app.renderer.width;\r\n                dude.y = Math.random() * this.app.renderer.height;\r\n                dude.direction = Math.random() * Math.PI * 2;\r\n                dude.turningSpeed = Math.random() - 0.8;\r\n                dude.speed = (2 + Math.random() * 2) * 0.2;\r\n                dude.offset = Math.random() * 100;\r\n\r\n                this.maggots.push(dude);\r\n                this.sprites.addChild(dude);\r\n\r\n            }\r\n\r\n            let dudeBoundsPadding = 100;\r\n            this.dudeBounds = new PIXI.Rectangle(\r\n                -dudeBoundsPadding,\r\n                -dudeBoundsPadding,\r\n                this.app.renderer.width + dudeBoundsPadding * 2,\r\n                this.app.renderer.height + dudeBoundsPadding * 2\r\n            );\r\n\r\n            this.tick = 0;\r\n\r\n            this.app.ticker.add((): void => {\r\n\r\n                for (let i = 0; i < this.maggots.length; i++) {\r\n\r\n                    let dude = this.maggots[i];\r\n                    dude.scale.y = 0.95 + Math.sin(this.tick + dude.offset) * 0.05;\r\n                    dude.direction += dude.turningSpeed * 0.01;\r\n                    dude.x += Math.sin(dude.direction) * (dude.speed * dude.scale.y);\r\n                    dude.y += Math.cos(dude.direction) * (dude.speed * dude.scale.y);\r\n                    dude.rotation = -dude.direction + Math.PI;\r\n\r\n                    // wrap the maggots\r\n                    if (dude.x < this.dudeBounds.x) {\r\n                        dude.x += this.dudeBounds.width;\r\n                    }\r\n                    else if (dude.x > this.dudeBounds.x + this.dudeBounds.width) {\r\n                        dude.x -= this.dudeBounds.width;\r\n                    }\r\n\r\n                    if (dude.y < this.dudeBounds.y) {\r\n                        dude.y += this.dudeBounds.height;\r\n                    }\r\n                    else if (dude.y > this.dudeBounds.y + this.dudeBounds.height) {\r\n                        dude.y -= this.dudeBounds.height;\r\n                    }\r\n                }\r\n\r\n                this.tick += 0.1;\r\n\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n    export class Dude extends PIXI.Sprite {\r\n\r\n        direction: number = 0;\r\n        speed: number = 0;\r\n        turningSpeed: number = 0;\r\n        offset: number = 0;\r\n\r\n        constructor(texture: PIXI.Texture) {\r\n            super(texture);\r\n        }\r\n\r\n    }\r\n\r\n    export class BlendModes {\r\n\r\n        private app: PIXI.Application;\r\n        private background: PIXI.Sprite;\r\n        private dudeArray: Dude[];\r\n        private dudeBounds: PIXI.Rectangle;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.background = PIXI.Sprite.fromImage(\"required/assets/BGrotate.jpg\");\r\n            this.app.stage.addChild(this.background);\r\n\r\n            this.dudeArray = [];\r\n\r\n            let totalDudes = 20;\r\n            let dudeTexture = PIXI.Texture.fromImage(\"required/assets/flowerTop.png\");\r\n\r\n            for (let i = 0; i < totalDudes; i++) {\r\n\r\n                let dude = new Dude(dudeTexture);\r\n                dude.anchor.set(0.5);\r\n                dude.scale.set(0.8 + Math.random() * 0.3);\r\n                dude.x = Math.floor(Math.random() * this.app.renderer.width);\r\n                dude.y = Math.floor(Math.random() * this.app.renderer.height);\r\n                dude.blendMode = PIXI.BLEND_MODES.ADD;\r\n                dude.direction = Math.random() * Math.PI * 2;\r\n                dude.turningSpeed = Math.random() - 0.8;\r\n                dude.speed = 2 + Math.random() * 2;\r\n\r\n                this.dudeArray.push(dude);\r\n                this.app.stage.addChild(dude);\r\n\r\n            }\r\n\r\n            let dudeBoundsPadding = 100;\r\n            this.dudeBounds = new PIXI.Rectangle(\r\n                -dudeBoundsPadding,\r\n                -dudeBoundsPadding,\r\n                this.app.renderer.width + dudeBoundsPadding * 2,\r\n                this.app.renderer.height + dudeBoundsPadding * 2\r\n            );\r\n\r\n            this.app.ticker.add((): void => {\r\n\r\n                for (let i = 0; i < this.dudeArray.length; i++) {\r\n\r\n                    let dude = this.dudeArray[i];\r\n                    dude.direction += dude.turningSpeed * 0.01;\r\n                    dude.x += Math.sin(dude.direction) * dude.speed;\r\n                    dude.y += Math.cos(dude.direction) * dude.speed;\r\n                    dude.rotation = -dude.direction - Math.PI / 2;\r\n\r\n                    // wrap the dudes by testing their bounds...\r\n                    if (dude.x < this.dudeBounds.x) {\r\n                        dude.x += this.dudeBounds.width;\r\n                    }\r\n                    else if (dude.x > this.dudeBounds.x + this.dudeBounds.width) {\r\n                        dude.x -= this.dudeBounds.width;\r\n                    }\r\n\r\n                    if (dude.y < this.dudeBounds.y) {\r\n                        dude.y += this.dudeBounds.height;\r\n                    }\r\n                    else if (dude.y > this.dudeBounds.y + this.dudeBounds.height) {\r\n                        dude.y -= this.dudeBounds.height;\r\n                    }\r\n                }\r\n\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class CacheAsBitmap {\r\n\r\n        private app: PIXI.Application;\r\n        private aliens: PIXI.Sprite[];\r\n        private count: number;\r\n        private alienContainer: PIXI.Container;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            this.app.stage.interactive = true;\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.app.stop();\r\n\r\n            this.aliens = [];\r\n            let alienFrames = [\r\n                \"eggHead.png\",\r\n                \"flowerTop.png\",\r\n                \"helmlok.png\",\r\n                \"skully.png\"\r\n            ];\r\n\r\n            this.count = 0;\r\n\r\n            this.alienContainer = new PIXI.Container();\r\n            this.alienContainer.x = 400;\r\n            this.alienContainer.y = 300;\r\n            this.app.stage.addChild(this.alienContainer);\r\n\r\n            PIXI.loader\r\n                .add(\"spritesheet\", \"required/assets/monsters.json\")\r\n                .load((): void => {\r\n\r\n                    for (let i = 0; i < 100; i++) {\r\n\r\n                        let frameName = alienFrames[i % 4];\r\n\r\n                        let alien = PIXI.Sprite.fromFrame(frameName);\r\n                        alien.tint = Math.random() * 0xFFFFFF;\r\n                        alien.x = Math.random() * 800 - 400;\r\n                        alien.y = Math.random() * 600 - 300;\r\n                        alien.anchor.x = 0.5;\r\n                        alien.anchor.y = 0.5;\r\n                        this.aliens.push(alien);\r\n                        this.alienContainer.addChild(alien);\r\n                    }\r\n                    this.app.start();\r\n\r\n                    this.app.stage.on(\"pointerTap\", (event: PIXI.interaction.InteractionEvent): void => {\r\n                        this.alienContainer.cacheAsBitmap = !this.alienContainer.cacheAsBitmap;\r\n                    });\r\n                    this.app.ticker.add((): void => {\r\n\r\n                        // let\"s rotate the aliens a little bit\r\n                        for (let i = 0; i < 100; i++) {\r\n                            let alien = this.aliens[i];\r\n                            alien.rotation += 0.1;\r\n                        }\r\n\r\n                        this.count += 0.01;\r\n\r\n                        this.alienContainer.scale.x = Math.sin(this.count);\r\n                        this.alienContainer.scale.y = Math.sin(this.count);\r\n                        this.alienContainer.rotation += 0.01;\r\n\r\n                    });\r\n\r\n                });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class Dragging {\r\n\r\n        private app: PIXI.Application;\r\n        private data: PIXI.interaction.InteractionData;\r\n        private dragging: boolean;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { backgroundColor: 0x1099bb });\r\n            document.body.appendChild(this.app.view);\r\n\r\n            let texture = PIXI.Texture.fromImage(\"required/assets/bunny.png\");\r\n            texture.baseTexture.scaleMode = PIXI.SCALE_MODES.NEAREST;\r\n\r\n            for (let i = 0; i < 10; i++) {\r\n                this.createBunny(\r\n                    texture,\r\n                    Math.floor(Math.random() * this.app.renderer.width),\r\n                    Math.floor(Math.random() * this.app.renderer.height)\r\n                );\r\n            }\r\n\r\n        }\r\n\r\n        private createBunny(texture: PIXI.Texture, x: number, y: number): void {\r\n\r\n            let bunny = new PIXI.Sprite(texture);\r\n            bunny.interactive = true;\r\n            bunny.buttonMode = true;\r\n            bunny.anchor.set(0.5);\r\n            bunny.scale.set(3);\r\n            bunny\r\n                .on(\"pointerdown\", (event: PIXI.interaction.InteractionEvent): void => {\r\n\r\n                    this.data = event.data;\r\n                    bunny.alpha = 0.5;\r\n                    this.dragging = true;\r\n\r\n                })\r\n                .on(\"pointerup\", (event: PIXI.interaction.InteractionEvent): void => {\r\n\r\n                    this.data = null;\r\n                    bunny.alpha = 0.5;\r\n                    this.dragging = false;\r\n\r\n                })\r\n                .on(\"pointerupoutside\", (event: PIXI.interaction.InteractionEvent): void => {\r\n\r\n                    this.data = null;\r\n                    bunny.alpha = 0.5;\r\n                    this.dragging = false;\r\n\r\n                })\r\n                .on(\"pointermove\", (event: PIXI.interaction.InteractionEvent): void => {\r\n\r\n                    if (this.dragging) {\r\n                        let newPosition = this.data.getLocalPosition(bunny);\r\n                        bunny.x = newPosition.x;\r\n                        bunny.y = newPosition.y;\r\n                    }\r\n\r\n                });\r\n\r\n            bunny.x = x;\r\n            bunny.y = y;\r\n\r\n            this.app.stage.addChild(bunny);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class GraphicsDemo {\r\n\r\n        private app: PIXI.Application;\r\n        private graphics: PIXI.Graphics;\r\n        private thing: PIXI.Graphics;\r\n        private count: number;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { antialias: true });\r\n            this.app.stage.interactive = true;\r\n            document.body.appendChild(this.app.view);\r\n\r\n            let graphics = new PIXI.Graphics();\r\n\r\n            graphics.beginFill(0xFF3300);\r\n            graphics.lineStyle(10, 0xffd900, 1);\r\n\r\n            graphics.moveTo(50, 50);\r\n            graphics.lineTo(250, 50);\r\n            graphics.lineTo(100, 100);\r\n            graphics.lineTo(250, 220);\r\n            graphics.lineTo(50, 220);\r\n            graphics.lineTo(50, 50);\r\n            graphics.endFill();\r\n\r\n            graphics.lineStyle(10, 0xFF0000, 0.8);\r\n            graphics.beginFill(0xFF700B, 1);\r\n\r\n            graphics.moveTo(210, 300);\r\n            graphics.lineTo(450, 320);\r\n            graphics.lineTo(570, 350);\r\n            graphics.quadraticCurveTo(600, 0, 480, 100);\r\n            graphics.lineTo(330, 120);\r\n            graphics.lineTo(410, 200);\r\n            graphics.lineTo(210, 300);\r\n            graphics.endFill();\r\n\r\n            graphics.lineStyle(2, 0x0000FF, 1);\r\n            graphics.drawRect(50, 250, 100, 100);\r\n\r\n            graphics.lineStyle(0);\r\n            graphics.beginFill(0xFFFF0B, 0.5);\r\n            graphics.drawCircle(470, 200, 100);\r\n            graphics.endFill();\r\n\r\n            graphics.lineStyle(20, 0x33FF00);\r\n            graphics.moveTo(30, 30);\r\n            graphics.lineTo(600, 300);\r\n\r\n            this.graphics = graphics;\r\n\r\n            this.app.stage.addChild(this.graphics);\r\n\r\n            this.thing = new PIXI.Graphics();\r\n            this.thing.x = 800 / 2;\r\n            this.thing.y = 600 / 2;\r\n            this.app.stage.addChild(this.thing);\r\n\r\n            this.count = 0;\r\n\r\n            this.app.stage.on(\"pointertap\", (): void => {\r\n\r\n                this.graphics.lineStyle(Math.random() * 30, Math.random() * 0xFFFFFF, 1);\r\n                this.graphics.moveTo(Math.random() * 800, Math.random() * 600);\r\n                this.graphics.bezierCurveTo(\r\n                    Math.random() * 800, Math.random() * 600,\r\n                    Math.random() * 800, Math.random() * 600,\r\n                    Math.random() * 800, Math.random() * 600\r\n                );\r\n\r\n            });\r\n\r\n            this.app.ticker.add((): void => {\r\n\r\n                this.count += 0.1;\r\n\r\n                this.thing.clear();\r\n                this.thing.lineStyle(10, 0xff0000, 1);\r\n                this.thing.beginFill(0xffFF00, 0.5);\r\n\r\n                this.thing.moveTo(-120 + Math.sin(this.count) * 20, -100 + Math.cos(this.count) * 20);\r\n                this.thing.lineTo(120 + Math.cos(this.count) * 20, -100 + Math.sin(this.count) * 20);\r\n                this.thing.lineTo(120 + Math.sin(this.count) * 20, 100 + Math.cos(this.count) * 20);\r\n                this.thing.lineTo(-120 + Math.cos(this.count) * 20, 100 + Math.sin(this.count) * 20);\r\n                this.thing.lineTo(-120 + Math.sin(this.count) * 20, -100 + Math.cos(this.count) * 20);\r\n\r\n                this.thing.rotation = this.count * 0.1;\r\n\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class Interactivity {\r\n\r\n        private app: PIXI.Application;\r\n        private background: PIXI.Sprite;\r\n        private buttons: PIXI.Sprite[];\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            document.body.appendChild(this.app.view);\r\n\r\n            let background = PIXI.Sprite.fromImage(\"required/assets/button_test_BG.jpg\");\r\n            background.width = this.app.renderer.width;\r\n            background.height = this.app.renderer.height;\r\n            this.background = background;\r\n            this.app.stage.addChild(this.background);\r\n\r\n            this.buttons = [];\r\n\r\n            let buttonPositions = [\r\n                175, 75,\r\n                655, 75,\r\n                410, 325,\r\n                150, 465,\r\n                685, 445\r\n            ];\r\n\r\n            let textureButton = PIXI.Texture.fromImage(\"../../_assets/button.png\");\r\n            let textureButtonDown = PIXI.Texture.fromImage(\"../../_assets/buttonDown.png\");\r\n            let textureButtonOver = PIXI.Texture.fromImage(\"../../_assets/buttonOver.png\");\r\n\r\n            for (let i = 0; i < 5; i++) {\r\n\r\n                let button = new PIXI.Sprite(textureButton);\r\n                button.anchor.set(0.5);\r\n                button.x = buttonPositions[i * 2];\r\n                button.y = buttonPositions[i * 2 + 1];\r\n                button.interactive = true;\r\n                button.buttonMode = true;\r\n\r\n                button\r\n                    .on(\"pointerdown\", (): void => {\r\n                        // blah\r\n                    })\r\n                    .on(\"pointerup\", (): void => {\r\n                        // blah\r\n                    })\r\n                    .on(\"pointerupoutside\", (): void => {\r\n                        // blah\r\n                    })\r\n                    .on(\"pointerover\", (): void => {\r\n                        // blah\r\n                    })\r\n                    .on(\"pointerout\", (): void => {\r\n                        // blah\r\n                    });\r\n\r\n                this.app.stage.addChild(button);\r\n                this.buttons.push(button);\r\n            }\r\n\r\n            this.buttons[0].scale.set(1.2);\r\n            this.buttons[2].rotation = Math.PI / 10;\r\n            this.buttons[3].scale.set(0.8);\r\n            this.buttons[4].scale.set(0.8, 1.2);\r\n            this.buttons[4].rotation = Math.PI;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class Masking {\r\n\r\n        private app: PIXI.Application;\r\n        private bg: PIXI.Sprite;\r\n        private container: PIXI.Container;\r\n        private bgFront: PIXI.Sprite;\r\n        private light1: PIXI.Sprite;\r\n        private light2: PIXI.Sprite;\r\n        private panda: PIXI.Sprite;\r\n        private thing: PIXI.Graphics;\r\n        private count: number;\r\n        private help: PIXI.Text;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { antialias: true });\r\n            this.app.stage.interactive = true;\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.bg = PIXI.Sprite.fromImage(\"required/assets/BGrotate.jpg\");\r\n            this.bg.anchor.set(0.5);\r\n            this.bg.x = this.app.renderer.width / 2;\r\n            this.bg.y = this.app.renderer.height / 2;\r\n            this.app.stage.addChild(this.bg);\r\n\r\n            this.container = new PIXI.Container();\r\n            this.container.x = this.app.renderer.width / 2;\r\n            this.container.y = this.app.renderer.height / 2;\r\n            this.app.stage.addChild(this.container);\r\n\r\n            this.bgFront = PIXI.Sprite.fromImage(\"required/assets/SceneRotate.jpg\");\r\n            this.bgFront.anchor.set(0.5);\r\n\r\n            this.light2 = PIXI.Sprite.fromImage(\"required/assets/LightRotate2.png\");\r\n            this.light2.anchor.set(0.5);\r\n\r\n            this.light1 = PIXI.Sprite.fromImage(\"required/assets/LightRotate1.png\");\r\n            this.light1.anchor.set(0.5);\r\n\r\n            this.panda = PIXI.Sprite.fromImage(\"required/assets/panda.png\");\r\n            this.panda.anchor.set(0.5);\r\n\r\n            this.container.addChild(this.bgFront, this.light2, this.light1, this.panda);\r\n\r\n            this.app.stage.addChild(this.container);\r\n\r\n            this.thing = new PIXI.Graphics();\r\n            this.app.stage.addChild(this.thing);\r\n            this.thing.x = this.app.renderer.width / 2;\r\n            this.thing.y = this.app.renderer.height / 2;\r\n            this.thing.lineStyle(0);\r\n            this.container.mask = this.thing;\r\n\r\n            this.count = 0;\r\n\r\n            this.app.stage.on(\"pointertap\", (): void => {\r\n                if (!this.container.mask) {\r\n                    this.container.mask = this.thing;\r\n                }\r\n                else {\r\n                    this.container.mask = null;\r\n                }\r\n            });\r\n\r\n            this.app.ticker.add((): void => {\r\n\r\n                this.bg.rotation += 0.01;\r\n                this.bgFront.rotation -= 0.01;\r\n\r\n                this.light1.rotation += 0.02;\r\n                this.light2.rotation += 0.01;\r\n\r\n                this.panda.scale.x = 1 + Math.sin(this.count) * 0.04;\r\n                this.panda.scale.y = 1 + Math.cos(this.count) * 0.04;\r\n\r\n                this.count += 0.1;\r\n\r\n                this.thing.clear();\r\n\r\n                this.thing.beginFill(0x8bc5ff, 0.4);\r\n                this.thing.moveTo(-120 + Math.sin(this.count) * 20, -100 + Math.cos(this.count) * 20);\r\n                this.thing.lineTo(-320 + Math.cos(this.count) * 20, 100 + Math.sin(this.count) * 20);\r\n                this.thing.lineTo(120 + Math.cos(this.count) * 20, -100 + Math.sin(this.count) * 20);\r\n                this.thing.lineTo(120 + Math.sin(this.count) * 20, 100 + Math.cos(this.count) * 20);\r\n                this.thing.lineTo(-120 + Math.cos(this.count) * 20, 100 + Math.sin(this.count) * 20);\r\n                this.thing.lineTo(-120 + Math.sin(this.count) * 20, -300 + Math.cos(this.count) * 20);\r\n                this.thing.lineTo(-320 + Math.sin(this.count) * 20, -100 + Math.cos(this.count) * 20);\r\n                this.thing.rotation = this.count * 0.1;\r\n\r\n            });\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n    export class RenderTextureDemo {\r\n\r\n        private app: PIXI.Application;\r\n\r\n        private renderTexture: PIXI.RenderTexture;\r\n        private renderTexture2: PIXI.RenderTexture;\r\n        private currentTexture: PIXI.RenderTexture;\r\n\r\n        private outputSprite: PIXI.Sprite;\r\n        private stuffContainer: PIXI.Container;\r\n\r\n        private items: PIXI.Sprite[];\r\n\r\n        private count: number;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.renderTexture = PIXI.RenderTexture.create(\r\n                this.app.renderer.width,\r\n                this.app.renderer.height\r\n            );\r\n            this.renderTexture2 = PIXI.RenderTexture.create(\r\n                this.app.renderer.width,\r\n                this.app.renderer.height\r\n            );\r\n            this.currentTexture = this.renderTexture;\r\n\r\n            this.outputSprite = new PIXI.Sprite(this.currentTexture);\r\n            this.outputSprite.x = 400;\r\n            this.outputSprite.y = 300;\r\n            this.outputSprite.anchor.set(0.5);\r\n            this.app.stage.addChild(this.outputSprite);\r\n\r\n            this.stuffContainer = new PIXI.Container();\r\n            this.stuffContainer.x = 400;\r\n            this.stuffContainer.y = 300;\r\n            this.app.stage.addChild(this.stuffContainer);\r\n\r\n            let fruits = [\r\n                \"required/assets/spinObj_01.png\",\r\n                \"required/assets/spinObj_02.png\",\r\n                \"required/assets/spinObj_03.png\",\r\n                \"required/assets/spinObj_04.png\",\r\n                \"required/assets/spinObj_05.png\",\r\n                \"required/assets/spinObj_06.png\",\r\n                \"required/assets/spinObj_07.png\",\r\n                \"required/assets/spinObj_08.png\"\r\n            ];\r\n\r\n            this.items = [];\r\n\r\n            for (let i = 0; i < 20; i++) {\r\n                let item = PIXI.Sprite.fromImage(fruits[i % fruits.length]);\r\n                item.x = Math.random() * 400 - 200;\r\n                item.y = Math.random() * 400 - 200;\r\n                item.anchor.set(0.5);\r\n                this.stuffContainer.addChild(item);\r\n                this.items.push(item);\r\n            }\r\n\r\n            this.count = 0;\r\n\r\n            this.app.ticker.add((): void => {\r\n\r\n                for (let i = 0; i < this.items.length; i++) {\r\n                    let item = this.items[i];\r\n                    item.rotation += 0.1;\r\n                }\r\n\r\n                this.count += 0.01;\r\n\r\n                let temp = this.renderTexture;\r\n                this.renderTexture = this.renderTexture2;\r\n                this.renderTexture2 = temp;\r\n\r\n                this.outputSprite.texture = this.renderTexture;\r\n\r\n                this.stuffContainer.rotation -= 0.01;\r\n                this.outputSprite.scale.set(1 + Math.sin(this.count) * 0.2);\r\n\r\n                this.app.renderer.render(this.app.stage, this.renderTexture2, false);\r\n\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class StripDemo {\r\n\r\n        private app: PIXI.Application;\r\n        private count: number;\r\n        private points: PIXI.Point[];\r\n        private strip: PIXI.mesh.Rope;\r\n        private snakeContainer: PIXI.Container;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.count = 0;\r\n\r\n            let ropeLength = 918 / 20;\r\n\r\n            this.points = [];\r\n\r\n            for (let i = 0; i < 20; i++) {\r\n                this.points.push(new PIXI.Point(i * ropeLength, 0));\r\n            }\r\n\r\n            this.strip = new PIXI.mesh.Rope(PIXI.Texture.fromImage(\"required/assets/snake.png\"), this.points);\r\n            this.strip.x = -459;\r\n\r\n            this.snakeContainer = new PIXI.Container();\r\n            this.snakeContainer.position.x = 400;\r\n            this.snakeContainer.position.y = 300;\r\n            this.snakeContainer.scale.set(800 / 1100);\r\n            this.snakeContainer.addChild(this.strip);\r\n            this.app.stage.addChild(this.snakeContainer);\r\n\r\n            this.app.ticker.add((): void => {\r\n                this.count += 0.1;\r\n                for (let i = 0; i < this.points.length; i++) {\r\n                    this.points[i].y = Math.sin((i * 0.5) + this.count) * 30;\r\n                    this.points[i].x = i * ropeLength + Math.cos((i * 0.3) + this.count) * 20;\r\n                }\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class TextDemo {\r\n\r\n        private app: PIXI.Application;\r\n        private bitmapFontText: PIXI.extras.BitmapText;\r\n        private background: PIXI.Sprite;\r\n        private textSample: PIXI.Text;\r\n        private spinningText: PIXI.Text;\r\n        private countingText: PIXI.Text;\r\n        private count: number;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            document.body.appendChild(this.app.view);\r\n\r\n            PIXI.loader\r\n                .add(\"desyrel\", \"required/assets/desyrel.xml\")\r\n                .load((): void => {\r\n\r\n                    this.bitmapFontText = new PIXI.extras.BitmapText(\"bitmap fonts are\\n now supported!\", { font: \"35px Desyrel\", align: \"right\" });\r\n                    this.bitmapFontText.x = this.app.renderer.width - this.bitmapFontText.textWidth - 20;\r\n                    this.bitmapFontText.y = 20;\r\n                    this.app.stage.addChild(this.bitmapFontText);\r\n\r\n                });\r\n\r\n            this.background = PIXI.Sprite.fromImage(\"required/assets/textDemoBG.jpg\");\r\n            this.background.width = this.app.renderer.width;\r\n            this.background.height = this.app.renderer.height;\r\n            this.app.stage.addChild(this.background);\r\n\r\n            this.textSample = new PIXI.Text(\"Pixi.js can has\\n multiline text!\", {\r\n                fontFamily: \"Snippet\",\r\n                fontSize: 35,\r\n                fill: \"white\",\r\n                align: \"left\"\r\n            });\r\n            this.textSample.position.set(20);\r\n\r\n            this.spinningText = new PIXI.Text(\"I\\\"m fun!\", {\r\n                fontWeight: \"bold\",\r\n                fontSize: 60,\r\n                fontFamily: \"Arial\",\r\n                fill: \"#cc00ff\",\r\n                align: \"center\",\r\n                stroke: \"#FFFFFF\",\r\n                strokeThickness: 6\r\n            });\r\n            this.spinningText.anchor.set(0.5);\r\n            this.spinningText.x = this.app.renderer.width / 2;\r\n            this.spinningText.y = this.app.renderer.height / 2;\r\n\r\n            this.countingText = new PIXI.Text(\"COUNT 4Elet: 0\", {\r\n                fontWeight: \"bold\",\r\n                fontStyle: \"italic\",\r\n                fontSize: 60,\r\n                fontFamily: \"Arvo\",\r\n                fill: \"#3e1707\",\r\n                align: \"center\",\r\n                stroke: \"#a4410e\",\r\n                strokeThickness: 7\r\n            });\r\n\r\n            this.countingText.x = this.app.renderer.width / 2;\r\n            this.countingText.y = 500;\r\n            this.countingText.anchor.x = 0.5;\r\n\r\n            this.app.stage.addChild(this.textSample, this.spinningText, this.countingText);\r\n\r\n            this.count = 0;\r\n\r\n            this.app.ticker.add((): void => {\r\n\r\n                this.count += 0.05;\r\n                this.countingText.text = \"COUNT 4Elet: \" + Math.floor(this.count);\r\n\r\n                this.spinningText.rotation += 0.03;\r\n\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class TextureRotate {\r\n\r\n        private app: PIXI.Application;\r\n        private bol: boolean;\r\n        private texture: PIXI.Texture;\r\n        private secondTexture: PIXI.Texture;\r\n        private dude: PIXI.Sprite;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.bol = false;\r\n\r\n            PIXI.loader.add(\"flowerTop\", \"required/assets/flowerTop.png\");\r\n            PIXI.loader.load((loader: PIXI.loaders.Loader, resources: any) => {\r\n                this.texture = resources.flowerTop.texture;\r\n                this.init();\r\n            });\r\n\r\n        }\r\n\r\n        private init(): void {\r\n\r\n            let textures = [this.texture];\r\n            let D8 = PIXI.GroupD8;\r\n            for (let rotate = 1; rotate < 16; rotate++) {\r\n                let h = D8.isSwapWidthHeight(rotate) ? this.texture.frame.width : this.texture.frame.height;\r\n                let w = D8.isSwapWidthHeight(rotate) ? this.texture.frame.height : this.texture.frame.width;\r\n\r\n                let frame = this.texture.frame;\r\n                let crop = new PIXI.Rectangle(this.texture.frame.x, this.texture.frame.y, w, h);\r\n                let trim = crop;\r\n                let rotatedTexture: PIXI.Texture;\r\n                if (rotate % 2 === 0) {\r\n                    rotatedTexture = new PIXI.Texture(this.texture.baseTexture, frame, crop, trim, rotate);\r\n                } else {\r\n                    rotatedTexture = new PIXI.Texture(this.texture.baseTexture, frame, crop, trim, rotate - 1);\r\n                    rotatedTexture.rotate++;\r\n                }\r\n                textures.push(rotatedTexture);\r\n            }\r\n\r\n            let offsetX = this.app.renderer.width / 16 | 0;\r\n            let offsetY = this.app.renderer.height / 8 | 0;\r\n            let gridW = this.app.renderer.width / 4 | 0;\r\n            let gridH = this.app.renderer.height / 5 | 0;\r\n\r\n            for (let i = 0; i < 16; i++) {\r\n\r\n                let dude = new PIXI.Sprite(textures[i < 8 ? i * 2 : (i - 8) * 2 + 1]);\r\n                dude.scale.x = 0.5;\r\n                dude.scale.y = 0.5;\r\n                dude.x = offsetX + gridW * (i % 4);\r\n                dude.y = offsetY + gridH * (i / 4 | 0);\r\n                this.app.stage.addChild(dude);\r\n\r\n                let text = new PIXI.Text(\"rotate = \" + dude.texture.rotate, { fontFamily: \"Courier New\", fontSize: \"12px\", fill: \"white\", align: \"left\" });\r\n                text.x = dude.x;\r\n                text.y = dude.y - 20;\r\n                this.app.stage.addChild(text);\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class TextureSwap {\r\n\r\n        private app: PIXI.Application;\r\n        private bol: boolean;\r\n        private texture: PIXI.Texture;\r\n        private secondTexture: PIXI.Texture;\r\n        private dude: PIXI.Sprite;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.bol = false;\r\n\r\n            this.texture = PIXI.Texture.fromImage(\"required/assets/flowerTop.png\");\r\n\r\n            this.secondTexture = PIXI.Texture.fromImage(\"required/assets/eggHead.png\");\r\n\r\n            this.dude = new PIXI.Sprite(this.texture);\r\n            this.dude.anchor.set(0.5);\r\n            this.dude.x = this.app.renderer.width / 2;\r\n            this.dude.y = this.app.renderer.height / 2;\r\n            this.dude.interactive = true;\r\n            this.dude.buttonMode = true;\r\n            this.app.stage.addChild(this.dude);\r\n\r\n            this.dude.on(\"pointertap\", (): void => {\r\n                this.bol = !this.bol;\r\n                if (this.bol) {\r\n                    this.dude.texture = this.secondTexture;\r\n                }\r\n                else {\r\n                    this.dude.texture = this.texture;\r\n                }\r\n            });\r\n\r\n            this.app.ticker.add((): void => {\r\n                this.dude.rotation += 0.1;\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class Tinting {\r\n\r\n        private app: PIXI.Application;\r\n        private aliens: Dude[];\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.aliens = [];\r\n\r\n            let totalDudes = 20;\r\n\r\n            let dudeTexture = PIXI.Texture.fromImage(\"required/assets/eggHead.png\");\r\n\r\n            for (let i = 0; i < totalDudes; i++) {\r\n\r\n                let dude = new Dude(dudeTexture);\r\n                dude.anchor.set(0.5);\r\n                dude.scale.set(0.8 + Math.random() * 0.3);\r\n                dude.x = Math.random() * this.app.renderer.width;\r\n                dude.y = Math.random() * this.app.renderer.height;\r\n                dude.tint = Math.random() * 0xFFFFFF;\r\n                dude.direction = Math.random() * Math.PI * 2;\r\n                dude.turningSpeed = Math.random() - 0.8;\r\n                dude.speed = 2 + Math.random() * 2;\r\n\r\n                this.aliens.push(dude);\r\n                this.app.stage.addChild(dude);\r\n\r\n            }\r\n\r\n            let dudeBoundsPadding = 100;\r\n            let dudeBounds = new PIXI.Rectangle(-dudeBoundsPadding,\r\n                -dudeBoundsPadding,\r\n                this.app.renderer.width + dudeBoundsPadding * 2,\r\n                this.app.renderer.height + dudeBoundsPadding * 2);\r\n\r\n            this.app.ticker.add((): void => {\r\n\r\n                for (let i = 0; i < this.aliens.length; i++) {\r\n\r\n                    let dude = this.aliens[i];\r\n                    dude.direction += dude.turningSpeed * 0.01;\r\n                    dude.x += Math.sin(dude.direction) * dude.speed;\r\n                    dude.y += Math.cos(dude.direction) * dude.speed;\r\n                    dude.rotation = -dude.direction - Math.PI / 2;\r\n\r\n                    if (dude.x < dudeBounds.x) {\r\n                        dude.x += dudeBounds.width;\r\n                    }\r\n                    else if (dude.x > dudeBounds.x + dudeBounds.width) {\r\n                        dude.x -= dudeBounds.width;\r\n                    }\r\n\r\n                    if (dude.y < dudeBounds.y) {\r\n                        dude.y += dudeBounds.height;\r\n                    }\r\n                    else if (dude.y > dudeBounds.y + dudeBounds.height) {\r\n                        dude.y -= dudeBounds.height;\r\n                    }\r\n                }\r\n\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    export class TransparentBackground {\r\n\r\n        private app: PIXI.Application;\r\n        private bunny: PIXI.Sprite;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600, { transparent: true });\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.bunny = PIXI.Sprite.fromImage(\"required/assets/bunny.png\");\r\n\r\n            this.bunny.anchor.set(0.5);\r\n\r\n            this.bunny.x = this.app.renderer.width / 2;\r\n            this.bunny.y = this.app.renderer.height / 2;\r\n\r\n            this.app.stage.addChild(this.bunny);\r\n\r\n            this.app.ticker.add((): void => {\r\n                this.bunny.rotation += 0.1;\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nnamespace filters {\r\n\r\n    export class BlurFilter {\r\n\r\n        private app: PIXI.Application;\r\n        private bg: PIXI.Sprite;\r\n        private littleDudes: PIXI.Sprite;\r\n        private littleRobot: PIXI.Sprite;\r\n        private blurFilter1: PIXI.filters.BlurFilter;\r\n        private blurFilter2: PIXI.filters.BlurFilter;\r\n        private count: number;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600);\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.bg = PIXI.Sprite.fromImage(\"required/assets/depth_blur_BG.jpg\");\r\n            this.bg.width = this.app.renderer.width;\r\n            this.bg.height = this.app.renderer.height;\r\n            this.app.stage.addChild(this.bg);\r\n\r\n            this.littleDudes = PIXI.Sprite.fromImage(\"required/assets/depth_blur_dudes.jpg\");\r\n            this.littleDudes.x = (this.app.renderer.width / 2) - 315;\r\n            this.littleDudes.y = 200;\r\n            this.app.stage.addChild(this.littleDudes);\r\n\r\n            this.littleRobot = PIXI.Sprite.fromImage(\"required/assets/depth_blur_moby.jpg\");\r\n            this.littleRobot.x = (this.app.renderer.width / 2) - 200;\r\n            this.littleRobot.y = 100;\r\n            this.app.stage.addChild(this.littleRobot);\r\n\r\n            this.blurFilter1 = new PIXI.filters.BlurFilter();\r\n            this.blurFilter2 = new PIXI.filters.BlurFilter();\r\n\r\n            this.littleDudes.filters = [this.blurFilter1];\r\n            this.littleRobot.filters = [this.blurFilter2];\r\n\r\n            this.count = 0;\r\n\r\n            this.app.ticker.add((): void => {\r\n\r\n                this.count += 0.005;\r\n\r\n                let blurAmount = Math.cos(this.count);\r\n                let blurAmount2 = Math.sin(this.count);\r\n\r\n                this.blurFilter1.blur = 20 * (blurAmount);\r\n                this.blurFilter2.blur = 20 * (blurAmount2);\r\n\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class DisplacementMap {\r\n\r\n        private app: PIXI.Application;\r\n        private container: PIXI.Container;\r\n        private maggots: DisplacementMapDude[];\r\n        private displacementSprite: PIXI.Sprite;\r\n        private displacementFilter: PIXI.filters.DisplacementFilter;\r\n        private ring: PIXI.Sprite;\r\n        private bg: PIXI.Sprite;\r\n        private count: number;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application(800, 600);\r\n            this.app.stage.interactive = true;\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.container = new PIXI.Container();\r\n            this.app.stage.addChild(this.container);\r\n\r\n            let padding = 100;\r\n            let bounds = new PIXI.Rectangle(\r\n                -padding,\r\n                -padding,\r\n                this.app.renderer.width + padding * 2,\r\n                this.app.renderer.height + padding * 2\r\n            );\r\n            this.maggots = [];\r\n\r\n            for (let i = 0; i < 20; i++) {\r\n\r\n                let maggot = new DisplacementMapDude();\r\n                maggot.anchor.set(0.5);\r\n                this.container.addChild(maggot);\r\n\r\n                maggot.direction = Math.random() * Math.PI * 2;\r\n                maggot.speed = 1;\r\n                maggot.turnSpeed = Math.random() - 0.8;\r\n\r\n                maggot.position.x = Math.random() * bounds.width;\r\n                maggot.position.y = Math.random() * bounds.height;\r\n\r\n                maggot.scale.set(1 + Math.random() * 0.3);\r\n                maggot.original = maggot.scale.clone();\r\n                this.maggots.push(maggot);\r\n\r\n            }\r\n\r\n            this.displacementSprite = PIXI.Sprite.fromImage(\"required/assets/displace.png\");\r\n            let displacementFilter = new PIXI.filters.DisplacementFilter(this.displacementSprite);\r\n            this.app.stage.addChild(this.displacementSprite);\r\n\r\n            this.container.filters = [displacementFilter];\r\n\r\n            displacementFilter.scale.x = 110;\r\n            displacementFilter.scale.y = 110;\r\n\r\n            this.ring = PIXI.Sprite.fromImage(\"required/assets/ring.png\");\r\n            this.ring.anchor.set(0.5);\r\n            this.ring.visible = false;\r\n            this.app.stage.addChild(this.ring);\r\n\r\n            this.bg = PIXI.Sprite.fromImage(\"required/assets/bkg-grass.jpg\");\r\n            this.bg.width = this.app.renderer.width;\r\n            this.bg.height = this.app.renderer.height;\r\n            this.bg.alpha = 0.4;\r\n            this.container.addChild(this.bg);\r\n\r\n            this.count = 0;\r\n\r\n            this.app.stage\r\n                .on(\"mousemove\", this.onPointerMove)\r\n                .on(\"touchmove\", this.onPointerMove);\r\n\r\n            this.app.ticker.add((): void => {\r\n\r\n                this.count += 0.05;\r\n\r\n                for (let i = 0; i < this.maggots.length; i++) {\r\n\r\n                    let maggot = this.maggots[i];\r\n\r\n                    maggot.direction += maggot.turnSpeed * 0.01;\r\n                    maggot.x += Math.sin(maggot.direction) * maggot.speed;\r\n                    maggot.y += Math.cos(maggot.direction) * maggot.speed;\r\n\r\n                    maggot.rotation = -maggot.direction - Math.PI / 2;\r\n                    maggot.scale.x = maggot.original.x + Math.sin(this.count) * 0.2;\r\n\r\n                    if (maggot.x < bounds.x) {\r\n                        maggot.x += bounds.width;\r\n                    }\r\n                    else if (maggot.x > bounds.x + bounds.width) {\r\n                        maggot.x -= bounds.width;\r\n                    }\r\n\r\n                    if (maggot.y < bounds.y) {\r\n                        maggot.y += bounds.height;\r\n                    }\r\n                    else if (maggot.y > bounds.y + bounds.height) {\r\n                        maggot.y -= bounds.height;\r\n                    }\r\n                }\r\n\r\n            });\r\n\r\n        }\r\n\r\n        private onPointerMove = (eventData: PIXI.interaction.InteractionEvent): void => {\r\n\r\n            this.ring.visible = true;\r\n            this.displacementSprite.x = eventData.data.global.x - 100;\r\n            this.displacementSprite.y = eventData.data.global.y - this.displacementSprite.height / 2;\r\n            this.ring.x = eventData.data.global.x - 25;\r\n            this.ring.y = eventData.data.global.y;\r\n\r\n        }\r\n\r\n    }\r\n    export class DisplacementMapDude extends PIXI.Sprite {\r\n\r\n        direction: number = 0;\r\n        speed: number = 0;\r\n        turnSpeed: number = 0;\r\n        original: PIXI.Point = new PIXI.Point();\r\n\r\n        constructor() {\r\n\r\n            super(PIXI.Texture.fromImage(\"../../_assets/maggot.png\"));\r\n\r\n        }\r\n\r\n    }\r\n\r\n    export class Filter {\r\n\r\n        private app: PIXI.Application;\r\n        private bg: PIXI.Sprite;\r\n        private filter: PIXI.filters.ColorMatrixFilter;\r\n        private container: PIXI.Container;\r\n        private bgFront: PIXI.Sprite;\r\n        private light2: PIXI.Sprite;\r\n        private light1: PIXI.Sprite;\r\n        private panda: PIXI.Sprite;\r\n        private count: number;\r\n        private enabled: boolean;\r\n        private help: PIXI.Text;\r\n\r\n        constructor() {\r\n\r\n            this.app = new PIXI.Application();\r\n            this.app.stage.interactive = true;\r\n            document.body.appendChild(this.app.view);\r\n\r\n            this.bg = PIXI.Sprite.fromImage(\"required/assets/BGrotate.jpg\");\r\n            this.bg.anchor.set(0.5);\r\n            this.bg.x = this.app.renderer.width / 2;\r\n            this.bg.y = this.app.renderer.height / 2;\r\n\r\n            this.filter = new PIXI.filters.ColorMatrixFilter();\r\n\r\n            this.container = new PIXI.Container();\r\n            this.container.position.x = this.app.renderer.width / 2;\r\n            this.container.position.y = this.app.renderer.height / 2;\r\n            this.app.stage.addChild(this.container);\r\n\r\n            this.bgFront = PIXI.Sprite.fromImage(\"required/assets/SceneRotate.jpg\");\r\n            this.bgFront.anchor.set(0.5);\r\n            this.container.addChild(this.bgFront);\r\n\r\n            this.light2 = PIXI.Sprite.fromImage(\"required/assets/LightRotate2.png\");\r\n            this.light2.anchor.set(0.5);\r\n            this.container.addChild(this.light2);\r\n\r\n            this.light1 = PIXI.Sprite.fromImage(\"../../_assets/LightRotate1.png\");\r\n            this.light1.anchor.set(0.5);\r\n            this.container.addChild(this.light1);\r\n\r\n            this.panda = PIXI.Sprite.fromImage(\"required/assets/panda.png\");\r\n            this.panda.anchor.set(0.5);\r\n            this.container.addChild(this.panda);\r\n\r\n            this.app.stage.filters = [this.filter];\r\n\r\n            this.count = 0;\r\n            this.enabled = true;\r\n\r\n            this.app.stage.on(\"pointertap\", (): void => {\r\n                this.enabled = !this.enabled;\r\n                this.app.stage.filters = this.enabled ? [this.filter] : null;\r\n            });\r\n\r\n            this.help = new PIXI.Text(\"Click or tap to turn filters on / off.\", {\r\n                fontFamily: \"Arial\",\r\n                fontSize: 12,\r\n                fontWeight: \"bold\",\r\n                fill: \"white\"\r\n            });\r\n            this.help.y = this.app.renderer.height - 25;\r\n            this.help.x = 10;\r\n            this.app.stage.addChild(this.help);\r\n\r\n            this.app.ticker.add((delta: number): void => {\r\n\r\n                this.bg.rotation += 0.01;\r\n                this.bgFront.rotation -= 0.01;\r\n                this.light1.rotation += 0.02;\r\n                this.light2.rotation += 0.01;\r\n\r\n                this.panda.scale.x = 1 + Math.sin(this.count) * 0.04;\r\n                this.panda.scale.y = 1 + Math.cos(this.count) * 0.04;\r\n\r\n                this.count += 0.1;\r\n\r\n                let matrix = this.filter.matrix;\r\n\r\n                matrix[1] = Math.sin(this.count) * 3;\r\n                matrix[2] = Math.cos(this.count);\r\n                matrix[3] = Math.cos(this.count) * 1.5;\r\n                matrix[4] = Math.sin(this.count / 3) * 2;\r\n                matrix[5] = Math.sin(this.count / 2);\r\n                matrix[6] = Math.sin(this.count / 4);\r\n\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n}","module Animyst {\r\n    export class SpriteSheetAnimation {\r\n\r\n    \tpublic id:string ;\r\n\t\tpublic idle:string;\r\n\t\tpublic currentAnim:string;\r\n\t\tpublic animations:any;\r\n\t\tpublic spritesheets:any;\r\n\t\tpublic framerate:number;\r\n\t\tpublic playing:boolean;\r\n\t\tpublic time:number = 0;\r\n\t\tpublic playTime:number = 0;\r\n\t\tpublic currentFrame:number = 0;\r\n    \t\r\n    \tconstructor(id:string, framerate:number = 60){\r\n    \t\tthis.id = id;\r\n\t\t\tthis.animations = {};\r\n\t\t\tthis.spritesheets = {};\r\n\t\t\tthis.framerate = framerate;\r\n    \t}\r\n\r\n    \tpublic addSheet(sheetData:SpriteSheetData):void{\r\n\t\t\tthis.spritesheets[sheetData.name] = sheetData;\r\n\t\t}\r\n\r\n\t\tpublic getSheet(sheetID):SpriteSheetData{\r\n\t\t\t return this.spritesheets[sheetID]; \r\n\t\t};\r\n\r\n\t\tpublic addAnimation(name:string, prefix:string, sheetID:string, params:any = {}){\r\n\t\t\tvar anim:any = {};\r\n\t\t\tvar spritesheet = this.getSheet(sheetID);\r\n\r\n\t\t\tanim.name = name;\r\n\t\t\tanim.prefix = prefix;\r\n\t\t\tanim.sheetID = sheetID;\r\n\t\t\tanim.useFrames = params.useFrames || false;\r\n\t\t\tanim.frames = spritesheet.getFrames(anim.prefix);\r\n\t\t\tanim.currentFrameIndex = 0;\r\n\t\t\tanim.totalFrames = anim.frames.length;\r\n\t\t\tanim.duration = params.duration || anim.useFrames ? anim.totalFrames * (this.framerate / 60) : 1000 / this.framerate * anim.totalFrames;\r\n\t\t\tanim.loop = params.loop || false;\r\n\t\t\tanim.repeat = params.repeat || 0;\r\n\t\t\tanim.elapsed = 0;\r\n\t\t\tanim.framecount = 0;\r\n\r\n\r\n\t\t\tthis.animations[anim.name] = anim;\r\n\t\t}\r\n\r\n\t\tpublic getAnimation(name:string):any{\r\n\t\t\t return this.animations[name]; \r\n\t\t};\r\n\r\n\t\tpublic play(name:string):void{\r\n\t\t\tif(this.currentAnim == name) return;\r\n\r\n\t\t\tvar anim = this.getAnimation(name);\r\n\t\t\tthis.currentAnim = name;\r\n\t\t\tthis.playing = true;\r\n\t\t};\r\n\r\n\t\tpublic stop():void{\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tpublic pause():void{\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tpublic resume():void{\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tpublic setIdle(name:string):void{\r\n\t\t\t // body...  \r\n\t\t};\r\n\r\n\t\tpublic animate(delta:number = 0):void{\r\n\t\t\tif(this.playing){\r\n\t\t\t\t//console.log(delta, time, this.time, this.playTime, this.currentFrame, this.sourceFile)\r\n\t\t\t\tvar anim = this.getAnimation(this.currentAnim)\r\n\r\n\t\t\t\tif(anim.useFrames){\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//TODO: Finish...\r\n\t\t\t\t\r\n\r\n\t\t\t\t/*if(this.time >= this.playTime){\r\n\r\n\t\t\t\t\tif(this.loop){\r\n\t\t\t\t\t\tthis.time = 0;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.playing = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis.time += delta;\r\n\t\t\t\t\tthis.currentFrame = Math.round((this.time / this.playTime) * (this.frames.length - 1))\r\n\t\t\t\t\tif(this.currentFrame >= this.frames.length) this.currentFrame = this.frames.length - 1;\r\n\t\t\t\t}*/\r\n\t\t\t}\r\n\t\t};\r\n    }\r\n}","module Animyst {\r\n    export class SpriteSheetData extends Database {\r\n    \t\r\n    \tpublic name:string;\r\n    \tpublic data:any;\r\n\r\n    \tconstructor(name:string, data:any) {\r\n    \t\tsuper();\r\n\r\n    \t\tthis.name  = name;\r\n    \t\tthis.data = data;\r\n    \t\tthis.parse();\r\n    \t}\r\n\r\n    \tpublic parse():void{\r\n\t\t\tfor(var k in this.data.frames){\r\n\t\t\t\tthis.addFrame(k, this.data.frames[k]);\t\r\n\t\t\t} \r\n\t\t}\r\n\r\n\t\tpublic addFrame(frameID, data):void{\r\n\t\t\tvar frame = new FrameData(frameID, data);\r\n\t\t\tthis.create(frame, frameID, data); \r\n\t\t}\r\n\r\n\t\tpublic getFrame(frameID):void{\r\n\t\t\treturn this.getItem(frameID);\r\n\t\t}\r\n\r\n\t\tpublic getFrames(framePrefix):void{\r\n\t\t\tif(!this.hasCategory(framePrefix)){\r\n\t\t\t\tlet ctx:any = {}\r\n\t\t\t\tctx.framePrefix = framePrefix;\r\n\t\t\t\tthis.addCategory(framePrefix, function(frame){\r\n\t\t\t\t\treturn frame.id.indexOf(this.framePrefix) == 0;\r\n\t\t\t\t}, FrameData, ctx);\r\n\t\t\t} \r\n\r\n\t\t\tlet frames = this.getItemsInCategory(framePrefix);\r\n\t\t\tframes.sort(this._sortCaseInsensitive);\r\n\t\t\treturn frames;\r\n\t\t}\r\n\r\n\t\tprivate _sortCaseInsensitive(a,b):number{\r\n\t\t\tif (a.toLowerCase() < b.toLowerCase()) return -1;\r\n\t\t\tif (a.toLowerCase() > b.toLowerCase()) return 1;\r\n\r\n\t\t\treturn 0;\r\n\t\t}\r\n    }\r\n\r\n    export class FrameData extends Item {\r\n\r\n    \tpublic frame:any;\r\n    \tpublic rotated:boolean;\r\n    \tpublic trimmed:boolean;\r\n    \tpublic spriteSourceSize:any;\r\n    \tpublic sourceSize:any;\r\n    \tpublic pivot:any;\r\n\r\n    \tconstructor(id:string, params:any) {\r\n    \t\tsuper(id, params);\r\n    \t}\r\n\r\n    \tpublic setup(params:any):void{\r\n\t\t\tthis.frame = params.frame;\r\n\t\t\tthis.rotated = params.rotated;\r\n\t\t\tthis.trimmed = params.trimmed;\r\n\t\t\tthis.spriteSourceSize = params.spriteSourceSize;\r\n\t\t\tthis.sourceSize = params.sourceSize;\r\n\t\t\tthis.pivot = params.pivot;\r\n\r\n\t\t\tsuper.setup(params);\r\n\t\t};\r\n    }\r\n}","module Animyst {\r\n    export class CoreProcess extends AppState {\r\n    \t\r\n    \tstatic ID:string      = \"core\";\r\n\t\tstatic INPUT:string   = \"input\";\r\n\r\n    \tprivate _inputData:InputData;\r\n    \t\r\n\r\n    \tconstructor(id:string) {\r\n    \t\tsuper(id);\r\n\r\n    \t}\r\n\r\n    \tpublic setup():void{\r\n\t\t\tLog.output(\"[CoreProcess] Core Process Initialize\");\r\n\t\t\tsuper.setup.call(this);\r\n\r\n\t\t\tthis._inputData = new InputData();\r\n\r\n\t\t\tvar config = this.appScope.config;\r\n\t\t\tvar input  = new Input(this._inputData);\r\n\r\n\r\n\t\t\tinput.startup({element: document.body, keyboardSettings:config.settings.keyboard});\r\n\r\n\t\t\tthis.addSystem(\"input\", input);\r\n\r\n\r\n\t\t\tthis.appScope.addDatabase(CoreProcess.INPUT, this._inputData);\r\n\r\n\t\t}\r\n\r\n\t\tpublic start():void{\r\n\t\t\tLog.output(\"[CoreProcess] Start\");\r\n\t\t\tsuper.start();\r\n\t\t}\r\n\r\n\t\tpublic update(delta, time):void{\r\n\t\t\t//console.log(\"[Game] Updating...\")\r\n\t\t\tsuper.update(delta, time);\r\n\t\t}\r\n\r\n\t\tpublic pause():void{\r\n\t\t\tsuper.pause();\r\n\t\t}\r\n\r\n\t\tpublic resume():void{\r\n\t\t\tsuper.resume();\r\n\t\t}\r\n\r\n\t\tpublic kill():void{\r\n\t\t\tsuper.kill();\r\n\t\t}\r\n\r\n\t\tpublic restart():void{\r\n\t\t\tsuper.restart();\r\n\t\t}\r\n    }\r\n}","module Animyst {\r\n    export class ArrayUtil {\r\n\r\n    \t/**\r\n\t\t* Searches through any array for an element with a specific property\r\n\t\t* @param  {any} property Property to check\r\n\t\t* @param  {any} value    Value of the property\r\n\t\t* @param  {any} array    Array of elements\r\n\t\t* @return {any}          First element found with given property value. Returns null if nothing is found\r\n\t\t*/\r\n\t\tstatic search (property, value, array){\r\n\t\t\tfor (var i = 0; i < array.length; i++) {\r\n\t\t\t\tvar obj = array[i];\r\n\t\t\t\tif (obj[property] && obj[property] === value) {\r\n\t\t\t\t\treturn obj;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Searches through any array for all elements with a specific property\r\n\t\t* @param  {any} property Property to check\r\n\t\t* @param  {any} value    Value of the property\r\n\t\t* @param  {any} array    Array of elements\r\n\t\t* @return {any}          First element found with given property value. Returns null if nothing is found\r\n\t\t*/\r\n\t\tstatic searchAll (property, value, array, output = []) {\r\n\t\t\tfor (var i = 0; i < array.length; i++) {\r\n\t\t\t\tvar obj = array[i];\r\n\t\t\t\tif (obj[property] && obj[property] === value) {\r\n\t\t\t\t\toutput.push(obj);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn output;\r\n\t\t}\r\n\r\n\r\n\t\t/**\r\n\t\t* Pushes an element to an array as long as it is not already included in the array\r\n\t\t* @param {any}   element [description]\r\n\t\t* @param {any[]} array   [description]\r\n\t\t*/\r\n\t\tstatic include (element, array){\r\n\t\t\tif (array.indexOf(element) == -1) array.push(element);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Splices an element out of an array\r\n\t\t* @param {any}   element [description]\r\n\t\t* @param {any[]} array   [description]\r\n\t\t*/\r\n\t\tstatic remove (element, array){\r\n\t\t\tvar index = array.indexOf(element);\r\n\t\t\tif (index >= 0) array.splice(index, 1);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Traverses array and executes a call on each element\r\n\t\t* @param {any[]}     array   [description]\r\n\t\t* @param {any}       command [description]\r\n\t\t* @param {number =       0}           startIndex [description]\r\n\t\t* @param {number =       1}           inc        [description]\r\n\t\t* @param {any}       ctx     [description]\r\n\t\t*/\r\n\t\tstatic traverse (array, command, startIndex = 0, inc = 1, ctx = null){\r\n\t\t\tfor (var i = startIndex; i < array.length; i+= inc){\r\n\t\t\t\tcommand.call(ctx, array[i]);\r\n\t\t\t}\r\n\t\t}\r\n    \t\r\n    \tconstructor(argument) {\r\n    \t\t// code...\r\n    \t}\r\n    }\r\n}","module Animyst {\r\n    export class MathUtil {\r\n\r\n\t\tstatic loopSum(v:number, inc:number, max:number, min:number = 0):number {\r\n\t\t\tvar result = (v + inc) % (max + 1) + min;\r\n\t\t\tif(result < min) result = (max + 1) - Math.abs(result - min);\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tstatic constrain(v:number, min:number, max:number):number {\r\n\t\t\treturn Math.max(min, Math.min(v, max));\r\n\t\t}\r\n\r\n\t\tstatic findClosestDivisable(value, divisor):number {\r\n\t\t\tif (value <= divisor) return divisor;\r\n\r\n\t\t\tif (value % divisor > divisor / 2) {\r\n\t\t\t\treturn value + (divisor - (value % divisor));\r\n\t\t\t} else {\r\n\t\t\t\treturn value - (value % divisor);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tstatic findNextDivisable(value, divisor):number {\r\n\t\t\tif (value <= divisor) return divisor;\r\n\t\t\treturn value + (divisor - (value % divisor));\r\n\t\t}\r\n\r\n\t\tstatic interpolate(a, b, percent):number{\r\n\t\t\treturn a + (b - a) * percent\r\n\t\t}\r\n\r\n    }\r\n}\t","module Animyst {\r\n    export class ObjectUtil {\r\n\r\n    \t/**\r\n    \t * Inverts the properties and keys of an object\r\n    \t * @param  {any} object Object to invert\r\n    \t * @return {any}        Inverted copy of object\r\n    \t */\r\n\t\tstatic invert (object:any):any{\r\n\t\t\tvar obj = {};\r\n\r\n\t\t\tfor(var k in object){\r\n\t\t\t\tobj[object[k]] = k;\r\n\t\t\t}\r\n\r\n\t\t\treturn obj\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Returns copy of an object\r\n\t\t * @param  {any} obj    Object to copy\r\n\t\t * @param  {any} target Target object to copy to\r\n\t\t * @return {any}        [description]\r\n\t\t */\r\n\t\tstatic copy(obj:any, target?:any):any{\r\n\t\t\ttarget = target || {};\r\n\t\t\tfor(var k in obj){\r\n\t\t\t\tif(obj[k] instanceof Object){\r\n\t\t\t\t\tif(Array.isArray(obj[k])){\r\n\t\t\t\t\t\ttarget[k] = obj[k].concat()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttarget[k] = ObjectUtil.copy(obj[k]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget[k] = obj[k];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn target;\r\n\t\t}\r\n    \r\n    }\r\n}\t"],"sourceRoot":"./src"}