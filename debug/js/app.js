"use strict";!function t(i,e,a){function s(o,p){if(!e[o]){if(!i[o]){var r="function"==typeof require&&require;if(!p&&r)return r(o,!0);if(n)return n(o,!0);var m=new Error("Cannot find module '"+o+"'");throw m.code="MODULE_NOT_FOUND",m}var h=e[o]={exports:{}};i[o][0].call(h.exports,function(t){var e=i[o][1][t];return s(e?e:t)},h,h.exports,t,i,e,a)}return e[o].exports}for(var n="function"==typeof require&&require,o=0;o<a.length;o++)s(a[o]);return s}({1:[function(t,i,e){Game=function(t){Animyst.AppState.call(this,t),this.inputData=null,this.gameData=null,this.viewport=null},i.exports=Game,Game.prototype=Object.create(Animyst.AppState.prototype),Game.prototype.setup=function(){console.log("[Game] Setting Up..."),Animyst.AppState.prototype.setup.call(this),this.inputData=this.appScope.getDatabase(Animyst.CoreProcess.INPUT);var t=new THREE.Scene;this.viewport=new Animyst.View3D(t,Animyst.Window.width,Animyst.Window.height),this.viewport.initDisplay({resize:!0,debugControls:!0,addAxis:!0}),this.viewport.append()},Game.prototype.start=function(){console.log("[Game] Start"),Animyst.AppState.prototype.start.call(this)},Game.prototype.update=function(t,i){Animyst.AppState.prototype.update.call(this,t,i),this.viewport.render()},Game.prototype.pause=function(){Animyst.AppState.prototype.pause.call(this)},Game.prototype.resume=function(){Animyst.AppState.prototype.resume.call(this)},Game.prototype.kill=function(){Animyst.AppState.prototype.kill.call(this)},Game.prototype.restart=function(){Animyst.AppState.prototype.restart.call(this)}},{}],2:[function(t,i,e){GameData=function(){Animyst.Database.call(this),this.entities={},this.entities._total=0,this.entityCreationCount=0,this.addedSignal=new signals.Signal,this.removedSignal=new signals.Signal,this.updateSignal=new signals.Signal},i.exports=GameData,GameData.PLAYER=0,GameData.ENTITY_ADDED=0,GameData.ENTITY_REMOVED=1,GameData.ENTITY_UPDATED=2,GameData.prototype=Object.create(Animyst.Database.prototype),GameData.prototype.clear=function(){Animyst.Database.prototype.clear.call(this)},GameData.prototype.destroy=function(){this.entities=null,Animyst.Database.prototype.destroy.call(this)},GameData.prototype.addEntity=function(t,i,e){this.entities[t]||(this.entities[t]={},this.entities[t].count=0);var a={};if(a.id=i||t+"_"+this.entities[t].count,a.type=t,e)for(var s in e)a[s]=e[s];return this.entities[t][a.id]=a,this.entities[t].count++,this.entities._total++,this.signal.dispatch(GameData.ENTITY_ADDED,a),this.addedSignal.dispatch(a),a},GameData.prototype.getEntity=function(t,i){if(!i)for(var e in this.entities){var a=this.entities[e];for(var s in a)if(t==s){i=e;break}if(i)break}if(i&&this.entities[i][t])return this.entities[i][t]},GameData.prototype.removeEntity=function(t,i){if(!i)for(var e in this.entities){var a=this.entities[e];for(var s in a)if(t==s){i=e;break}if(i)break}if(i&&this.entities[i][t]){this.entities[i][t]=null,this.entities[i].count--,this.entities._total--,delete this.entities[i][t];var n={id:t,type:i};this.signal.dispatch(GameData.ENTITY_REMOVED,n),this.removedSignal.dispatch(n)}},GameData.prototype.notifyUpdate=function(t,i){var e=this.getEntity(t,i);e&&(this.signal.dispatch(GameData.ENTITY_UPDATED,e),this.updateSignal.dispatch(e))}},{}],3:[function(t,i,e){GameDisplay=function(t){function i(i){return t.apply(this,arguments)}return i.toString=function(){return t.toString()},i}(function(t){Animyst.System.call(this),this.gameData=t,this.layer=null,this.graphics={},this.graphicProperties={},this.graphicProperties[GameDisplay.PLAYER]={},this.graphicProperties[GameDisplay.ENEMY]={}}),i.exports=GameDisplay,GameDisplay.PLAYER=0,GameDisplay.ENEMY01=1,GameDisplay.prototype=Object.create(Animyst.System.prototype),GameDisplay.prototype.startup=function(t){this.gameData.signal.add(this.entityHandler,this),this.layer=t.layer||new Layer({position:new Point}),Animyst.System.prototype.startup.call(this,t)},GameDisplay.prototype.shutdown=function(){Animyst.System.prototype.shutdown.call(this)},GameDisplay.prototype.update=function(t,i){Animyst.System.prototype.update.call(this)},GameDisplay.prototype.entityHandler=function(t,i){switch(t){case GameData.ENTITY_ADDED:var e=this.createGraphic(this.graphicProperties[i.graphic]);e.position=i.position.clone(),this.layer.addChild(e),this.graphics[i.id]=e;break;case GameData.ENTITY_UPDATED:var e=this.getGraphicByID(i.id);e.position.x=i.position.x,e.position.y=i.position.y;break;case GameData.ENTITY_REMOVED:var e=this.getGraphicByID(i.id);e.remove(),this.graphics[i.id]=null,delete this.graphics[i.id]}},GameDisplay.prototype.createGraphic=function(t){return new Shape.Circle({radius:20,fillColor:"#00FFFF"})},GameDisplay.prototype.getGraphicByID=function(t){return this.graphics[t]}},{}],4:[function(t,i,e){GameLogic=function(t,i){Animyst.System.call(this),this.gameData=t,this.inputData=i,this.screenDimensions=new Point,this.commands={up:!1,down:!1,left:!1,right:!1,fire:!1,bomb:!1,focus:!1}},i.exports=GameLogic,GameLogic.prototype=Object.create(Animyst.System.prototype),GameLogic.prototype.startup=function(t){Animyst.System.prototype.startup.call(this),this.screenDimensions.x=Animyst.Window.width,this.screenDimensions.y=Animyst.Window.height;var i=this.gameData.addEntity(GameData.PLAYER,"player",{vector:new Point,position:new Point,neutralSpeed:new Point(10,10),focusSpeed:new Point(5,5),focus:!1,graphic:GameDisplay.PLAYER});i.position.x=this.screenDimensions.x/2,i.position.y=this.screenDimensions.y/2,console.log(this.screenDimensions),this.gameData.notifyUpdate("player",GameData.PLAYER),Animyst.System.prototype.startup.call(this,t)},GameLogic.prototype.shutdown=function(){Animyst.System.prototype.shutdown.call(this)},GameLogic.prototype.update=function(t,i){this.updateCommands(),this.updatePlayer(),Animyst.System.prototype.update.call(this)},GameLogic.prototype.updateCommands=function(){this.commands.up=this.inputData.isKeyDown("up"),this.commands.down=this.inputData.isKeyDown("down"),this.commands.left=this.inputData.isKeyDown("left"),this.commands.right=this.inputData.isKeyDown("right"),this.commands.fire=this.inputData.isKeyDown("z"),this.commands.focus=this.inputData.isKeyDown("shift")},GameLogic.prototype.updatePlayer=function(){var t=this.gameData.getEntity("player",GameData.PLAYER);t.focus=this.commands.focus;var i=t.focus?t.focusSpeed:t.neutralSpeed;t.vector.x=this.commands.left||this.commands.right?this.commands.left?-i.x:i.x:0,t.vector.y=this.commands.up||this.commands.down?this.commands.up?-i.y:i.y:0,t.position=t.position.add(t.vector),this.gameData.notifyUpdate("player",GameData.PLAYER)}},{}],5:[function(t,i,e){Main=t("./main.js"),Game=t("./game.js"),GameLogic=t("./gamelogic.js"),GameData=t("./gamedata.js"),GameDisplay=t("./gamedisplay.js")},{"./game.js":1,"./gamedata.js":2,"./gamedisplay.js":3,"./gamelogic.js":4,"./main.js":6}],6:[function(t,i,e){Main=function(){this.game=null,this.app=null},i.exports=Main,Main.prototype={start:function(){console.log("====== MAIN ======"),this.app=new Animyst.Application,this.app.initSignal.addOnce(this.onAppInit,this),this.app.startup({})},onAppInit:function(){var t=new Game("game1");this.app.run(t)}}},{}]},{},[5]);
//# sourceMappingURL=app.js.map
